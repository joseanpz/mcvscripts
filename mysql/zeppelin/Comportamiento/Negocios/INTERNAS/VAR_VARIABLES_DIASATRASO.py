---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------ SELECCIÓN DE UNIVERSO ----------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

%hive

DROP TABLE IF EXISTS dbriskdatamart.MZM_MCV_UNIVERSO_MODELADO__${FECHA_CALIFICACION};
CREATE TABLE dbriskdatamart.MZM_MCV_UNIVERSO_MODELADO__${FECHA_CALIFICACION}
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/MZM/MCV/MCV_MZM_UNIVERSO/MZM_MCV_UNIVERSO_MODELADO__${FECHA_CALIFICACION}' AS 

SELECT

T1.FECHA,
T1.RFC,
MAX_DIAS_ATRASO,
SUM_CARTERA_VENCIDA,
CASE
    WHEN T2.LINEA IS NOT NULL THEN T2.FOLIOCONSULTABC
    WHEN T3.RFC IS NOT NULL THEN T3.FOLIOCONSULTABC
    ELSE T4.FOLIOCONSULTABC
END AS FOLIOCONSULTABC,
CASE
    WHEN T2.LINEA IS NOT NULL THEN T2.FOLIORESPUESTABC
    WHEN T3.RFC IS NOT NULL THEN T3.FOLIORESPUESTABC
    ELSE T4.FOLIORESPUESTABC
END AS FOLIORESPUESTABC,
CASE
    WHEN T2.LINEA IS NOT NULL THEN T2.FECHABC
    WHEN T3.RFC IS NOT NULL THEN T3.FECHABC
    ELSE T4.FECHABC
END AS FECHABC

FROM
    (SELECT FECHA,RFC,MAX(CASE WHEN DIAS_ATRASO IS NULL THEN 0 ELSE DIAS_ATRASO END) AS MAX_DIAS_ATRASO,SUM(CASE WHEN CARTERA_VENCIDA IS NULL THEN 0 ELSE CARTERA_VENCIDA END) AS SUM_CARTERA_VENCIDA, MAX(LINEA) AS LINEA_MUESTRA 
        FROM dbriskdatamart.Tbl_carteracrediticia
            WHERE MIS <> 0
            AND FECHA <= ${FECHA_CALIFICACION}
                GROUP BY FECHA, RFC) T1
                
LEFT JOIN 
   (SELECT DISTINCT FOLIOCONSULTABC, FOLIORESPUESTABC, FECHABC, LINEA, CONCAT(SUBSTR(ANIOMES,1,4),SUBSTR(ANIOMES,6,2)) AS ANIOMES  
        FROM dbriskdatamart.Tbl_Rep_Reservas_SegPer_CV WHERE TIPOINTERVINIENTE = 'ACREDITADO') T2
ON T1.LINEA_MUESTRA=T2.LINEA
AND T1.FECHA=T2.ANIOMES
    
LEFT JOIN 
   (SELECT DISTINCT FOLIOCONSULTABC, FOLIORESPUESTABC, FECHABC, RFC, CONCAT(SUBSTR(ANIOMES,1,4),SUBSTR(ANIOMES,6,2)) AS ANIOMES  
        FROM dbriskdatamart.Tbl_Rep_Reservas_SegPer_CV WHERE TIPOINTERVINIENTE = 'ACREDITADO') T3
ON T1.RFC=T3.RFC
AND T1.FECHA=T3.ANIOMES

LEFT JOIN 
   (SELECT DISTINCT FOLIOCONSULTABC, FOLIORESPUESTABC, FECHABC, CLIENTERFC, CONCAT(SUBSTR(ANIOMES,1,4),SUBSTR(ANIOMES,6,2)) AS ANIOMES  
        FROM dbriskdatamart.Tbl_Rep_Reservas_SegPer_CV WHERE TIPOINTERVINIENTE = 'ACREDITADO') T4
ON T1.RFC=T4.CLIENTERFC
AND T1.FECHA=T4.ANIOMES
;

SELECT * FROM dbriskdatamart.MZM_MCV_UNIVERSO_MODELADO__${FECHA_CALIFICACION} LIMIT 100;

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------------ VAR DIAS ATRASO ----------------------------------------------------------------------------------------------------------
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

DROP TABLE IF EXISTS dbriskdatamart.MZM_MCV_VAR_VARIABLES_DIASATRASO__${FECHA_CALIFICACION};
CREATE TABLE dbriskdatamart.MZM_MCV_VAR_VARIABLES_DIASATRASO__${FECHA_CALIFICACION}
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/MZM/MCV/MZM_MCV_VAR_VARIABLES_DIASATRASO__${FECHA_CALIFICACION}' AS 

SELECT
	T1.RFC,
	T1.FECHA,
    MAX(CASE
		WHEN DIAS_ATRASO IS NULL THEN 0
		ELSE DIAS_ATRASO
	END) AS DIAS_ATRASO,
	MIN(CASE
		WHEN TIPO_DE_CREDITO IN ('3F','3K','ACSSGR PE NAFIN','DEUDOR FACTOR PLAN DISTRIBUIDOR','DFPD') THEN 90 - IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)
		WHEN TIPO_DE_CREDITO IN ('FFCR.','FFPCEOP') THEN 30 - IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)
		ELSE (MAX_TIP_DICAVE) - IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)
	END) AS DPCV_CAP,
	MIN(CASE
		WHEN TIPO_DE_CREDITO IN ('3F','3K','ACSSGR PE NAFIN','DEUDOR FACTOR PLAN DISTRIBUIDOR','DFPD') THEN 90 - IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)
		WHEN TIPO_DE_CREDITO IN ('FFCR.','FFPCEOP') THEN 30 - IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)
		ELSE (MAX_TIP_DIINVE) - IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)
	END) AS DPCV_INT,
	MIN(CASE
		WHEN TIPO_DE_CREDITO IN ('3F','3K','ACSSGR PE NAFIN','DEUDOR FACTOR PLAN DISTRIBUIDOR','DFPD') THEN 90 - IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)
		WHEN TIPO_DE_CREDITO IN ('FFCR.','FFPCEOP') THEN 30 - IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)
		ELSE (MAX_TIP_DICAVE_DIINVE) - IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)
	END) AS DPCV_MIN
FROM
	MZM_MCV_UNIVERSO_MODELADO__${FECHA_CALIFICACION} T1
LEFT JOIN
    	(SELECT 
    T1.RFC,
    T1.FECHA,
    T1.TIPO_DE_CREDITO,
    MAX(IF(DIAS_ATRASO IS NULL,0, DIAS_ATRASO)) AS DIAS_ATRASO, 
    GREATEST(MAX(IF(T2.TIP_DICAVE IS NULL,0,T2.TIP_DICAVE)), MAX(IF(T3.TIP_DICAVE IS NULL,0,T3.TIP_DICAVE))) AS MAX_TIP_DICAVE,
    GREATEST(MAX(IF(T2.TIP_DIINVE IS NULL,0,T2.TIP_DIINVE)), MAX(IF(T3.TIP_DIINVE IS NULL,0,T3.TIP_DIINVE))) AS MAX_TIP_DIINVE,
    GREATEST(MAX(LEAST(IF(T2.TIP_DICAVE IS NULL,0,T2.TIP_DICAVE),IF(T2.TIP_DIINVE IS NULL,0,T2.TIP_DIINVE))), MAX(LEAST(IF(T3.TIP_DICAVE IS NULL,0,T3.TIP_DICAVE),IF(T3.TIP_DIINVE IS NULL,0,T3.TIP_DIINVE)))) AS MAX_TIP_DICAVE_DIINVE
    -- MAX(TIP_DIINVE) AS MAX_TIP_DIINVE, MAX(LEAST(TIP_DICAVE,TIP_DIINVE)) AS MAX_TIP_DICAVE_DIINVE 
    
    FROM dbriskdatamart.Tbl_CarteraCrediticia T1
    LEFT JOIN dbriskdatamart.Tbl_CatalogoLinea T2
    	  ON T1.TIPO_DE_CREDITO = T2.DESCRIPCION_DEL_TIPO_DE_CREDITO
    	    LEFT JOIN Tbl_CatalogoLinea T3
    	    ON T1.TIPO_DE_CREDITO = T3.ABREVIACION
    	    WHERE MIS <>0
    	    GROUP BY T1.RFC,T1.FECHA, T1.TIPO_DE_CREDITO) T2
ON
	T1.RFC = T2.RFC AND
	T1.FECHA= T2.FECHA
GROUP BY
    T1.RFC, T1.FECHA;

SELECT * FROM dbriskdatamart.MZM_MCV_VAR_VARIABLES_DIASATRASO__${FECHA_CALIFICACION} LIMIT 1000;

DROP TABLE IF EXISTS dbriskdatamart.MZM_MCV_DA_PASO1__${FECHA_CALIFICACION};

CREATE TABLE dbriskdatamart.MZM_MCV_DA_PASO1__${FECHA_CALIFICACION}
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/MZM/MCV/MZM_MCV_DA_PASO1__${FECHA_CALIFICACION}' AS

SELECT
    T1.RFC,
    T1.FECHA,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 0 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T00,

    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 1 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T01,

    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 2 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T02,

    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 3 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T03,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 4 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T04,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 5 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T05,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 6 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T06,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 7 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T07,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 8 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T08,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 9 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T09,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 10 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T10,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 11 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T11,
    
    MAX(CASE
        WHEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2) = 12 THEN 
            CASE
                WHEN T2.DIAS_ATRASO IS NULL THEN 0
                ELSE T2.DIAS_ATRASO
            END
        ELSE NULL
    END) AS DA_T12,
    
    MIN(CASE
        WHEN T2.FECHA <= T1.FECHA AND T2.DIAS_ATRASO >= 01 THEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2)
        ELSE NULL
    END) AS MS_DESDE_ATR01M,
    
    MIN(CASE
        WHEN T2.FECHA <= T1.FECHA AND T2.DIAS_ATRASO >= 30 THEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2)
        ELSE NULL
    END) AS MS_DESDE_ATR30M,
    
    MIN(CASE
        WHEN T2.FECHA <= T1.FECHA AND T2.DIAS_ATRASO >= 60 THEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2)
        ELSE NULL
    END) AS MS_DESDE_ATR60M,
    
    MIN(CASE
        WHEN T2.FECHA <= T1.FECHA AND T2.DIAS_ATRASO >= 90 THEN (SUBSTR(T1.FECHA,1,4)-SUBSTR(T2.FECHA,1,4))*12+SUBSTR(T1.FECHA,5,2)-SUBSTR(T2.FECHA,5,2)
        ELSE NULL
    END) AS MS_DESDE_ATR90M
    

FROM
    dbriskdatamart.TBL_CARTERACREDITICIA T1
LEFT JOIN
    dbriskdatamart.TBL_CARTERACREDITICIA T2
ON
    T1.RFC = T2.RFC
WHERE
    T1.MIS <> 0
    AND T2.MIS <> 0
    AND T1.FECHA <= ${FECHA_CALIFICACION}
GROUP BY
    T1.RFC,
    T1.FECHA
;

SELECT * FROM dbriskdatamart.MZM_MCV_DA_PASO1__${FECHA_CALIFICACION} LIMIT 100;

DROP TABLE IF EXISTS dbriskdatamart.MZM_MCV_VAR_VARIABLES_DIASATRASO2__${FECHA_CALIFICACION};

CREATE TABLE dbriskdatamart.MZM_MCV_VAR_VARIABLES_DIASATRASO2__${FECHA_CALIFICACION}
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/MZM/MCV/MZM_MCV_VAR_VARIABLES_DIASATRASO2__${FECHA_CALIFICACION}' AS

SELECT
    RFC,
    FECHA,
    DA_T00,
    DA_T01,
    DA_T02,
    DA_T03,
    DA_T04,
    DA_T05,
    DA_T06,
    DA_T07,
    DA_T08,
    DA_T09,
    DA_T10,
    DA_T11,
    DA_T12,
    
    -- LA REFERENCIA DE 54 MESES CORRESPONDE A LA DIFERENCIA ENTRE LA FECHA INICIAL DE CARTERA CREDITICIA (201201) Y LA FECHA INICIAL DE REPORTE DE RESERVAS (201607)
    LEAST(IF(MS_DESDE_ATR01M IS NULL, 54, MS_DESDE_ATR01M), 54) AS MS_DESDE_ATR01M,
    LEAST(IF(MS_DESDE_ATR30M IS NULL, 54, MS_DESDE_ATR30M), 54) AS MS_DESDE_ATR30M,
    LEAST(IF(MS_DESDE_ATR60M IS NULL, 54, MS_DESDE_ATR60M), 54) AS MS_DESDE_ATR60M,
    LEAST(IF(MS_DESDE_ATR90M IS NULL, 54, MS_DESDE_ATR90M), 54) AS MS_DESDE_ATR90M,
    
    IF(DA_T01 IS NULL,0,DA_T01) AS MAX_ATR_U01M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02)) AS MAX_ATR_U02M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03)) AS MAX_ATR_U03M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03),IF(DA_T04 IS NULL,0,DA_T04)) AS MAX_ATR_U04M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03),IF(DA_T04 IS NULL,0,DA_T04),IF(DA_T05 IS NULL,0,DA_T05)) AS MAX_ATR_U05M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03),IF(DA_T04 IS NULL,0,DA_T04),IF(DA_T05 IS NULL,0,DA_T05),IF(DA_T06 IS NULL,0,DA_T06)) AS MAX_ATR_U06M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03),IF(DA_T04 IS NULL,0,DA_T04),IF(DA_T05 IS NULL,0,DA_T05),IF(DA_T06 IS NULL,0,DA_T06),IF(DA_T07 IS NULL,0,DA_T07)) AS MAX_ATR_U07M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03),IF(DA_T04 IS NULL,0,DA_T04),IF(DA_T05 IS NULL,0,DA_T05),IF(DA_T06 IS NULL,0,DA_T06),IF(DA_T07 IS NULL,0,DA_T07),IF(DA_T08 IS NULL,0,DA_T08)) AS MAX_ATR_U08M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03),IF(DA_T04 IS NULL,0,DA_T04),IF(DA_T05 IS NULL,0,DA_T05),IF(DA_T06 IS NULL,0,DA_T06),IF(DA_T07 IS NULL,0,DA_T07),IF(DA_T08 IS NULL,0,DA_T08),IF(DA_T09 IS NULL,0,DA_T09)) AS MAX_ATR_U09M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03),IF(DA_T04 IS NULL,0,DA_T04),IF(DA_T05 IS NULL,0,DA_T05),IF(DA_T06 IS NULL,0,DA_T06),IF(DA_T07 IS NULL,0,DA_T07),IF(DA_T08 IS NULL,0,DA_T08),IF(DA_T09 IS NULL,0,DA_T09),IF(DA_T10 IS NULL,0,DA_T10)) AS MAX_ATR_U10M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03),IF(DA_T04 IS NULL,0,DA_T04),IF(DA_T05 IS NULL,0,DA_T05),IF(DA_T06 IS NULL,0,DA_T06),IF(DA_T07 IS NULL,0,DA_T07),IF(DA_T08 IS NULL,0,DA_T08),IF(DA_T09 IS NULL,0,DA_T09),IF(DA_T10 IS NULL,0,DA_T10),IF(DA_T11 IS NULL,0,DA_T11)) AS MAX_ATR_U11M,
    GREATEST(IF(DA_T01 IS NULL,0,DA_T01),IF(DA_T02 IS NULL,0,DA_T02),IF(DA_T03 IS NULL,0,DA_T03),IF(DA_T04 IS NULL,0,DA_T04),IF(DA_T05 IS NULL,0,DA_T05),IF(DA_T06 IS NULL,0,DA_T06),IF(DA_T07 IS NULL,0,DA_T07),IF(DA_T08 IS NULL,0,DA_T08),IF(DA_T09 IS NULL,0,DA_T09),IF(DA_T10 IS NULL,0,DA_T10),IF(DA_T11 IS NULL,0,DA_T11),IF(DA_T12 IS NULL,0,DA_T12)) AS MAX_ATR_U12M,
    
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0) AS CNT_CURR_U01M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0) AS CNT_CURR_U02M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0) AS CNT_CURR_U03M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0)+IF(IF(DA_T04 IS NULL,0,DA_T04)=0,1,0) AS CNT_CURR_U04M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0)+IF(IF(DA_T04 IS NULL,0,DA_T04)=0,1,0)+IF(IF(DA_T05 IS NULL,0,DA_T05)=0,1,0) AS CNT_CURR_U05M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0)+IF(IF(DA_T04 IS NULL,0,DA_T04)=0,1,0)+IF(IF(DA_T05 IS NULL,0,DA_T05)=0,1,0)+IF(IF(DA_T06 IS NULL,0,DA_T06)=0,1,0) AS CNT_CURR_U06M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0)+IF(IF(DA_T04 IS NULL,0,DA_T04)=0,1,0)+IF(IF(DA_T05 IS NULL,0,DA_T05)=0,1,0)+IF(IF(DA_T06 IS NULL,0,DA_T06)=0,1,0)+IF(IF(DA_T07 IS NULL,0,DA_T07)=0,1,0) AS CNT_CURR_U07M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0)+IF(IF(DA_T04 IS NULL,0,DA_T04)=0,1,0)+IF(IF(DA_T05 IS NULL,0,DA_T05)=0,1,0)+IF(IF(DA_T06 IS NULL,0,DA_T06)=0,1,0)+IF(IF(DA_T07 IS NULL,0,DA_T07)=0,1,0)+IF(IF(DA_T08 IS NULL,0,DA_T08)=0,1,0) AS CNT_CURR_U08M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0)+IF(IF(DA_T04 IS NULL,0,DA_T04)=0,1,0)+IF(IF(DA_T05 IS NULL,0,DA_T05)=0,1,0)+IF(IF(DA_T06 IS NULL,0,DA_T06)=0,1,0)+IF(IF(DA_T07 IS NULL,0,DA_T07)=0,1,0)+IF(IF(DA_T08 IS NULL,0,DA_T08)=0,1,0)+IF(IF(DA_T09 IS NULL,0,DA_T09)=0,1,0) AS CNT_CURR_U09M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0)+IF(IF(DA_T04 IS NULL,0,DA_T04)=0,1,0)+IF(IF(DA_T05 IS NULL,0,DA_T05)=0,1,0)+IF(IF(DA_T06 IS NULL,0,DA_T06)=0,1,0)+IF(IF(DA_T07 IS NULL,0,DA_T07)=0,1,0)+IF(IF(DA_T08 IS NULL,0,DA_T08)=0,1,0)+IF(IF(DA_T09 IS NULL,0,DA_T09)=0,1,0)+IF(IF(DA_T10 IS NULL,0,DA_T10)=0,1,0) AS CNT_CURR_U10M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0)+IF(IF(DA_T04 IS NULL,0,DA_T04)=0,1,0)+IF(IF(DA_T05 IS NULL,0,DA_T05)=0,1,0)+IF(IF(DA_T06 IS NULL,0,DA_T06)=0,1,0)+IF(IF(DA_T07 IS NULL,0,DA_T07)=0,1,0)+IF(IF(DA_T08 IS NULL,0,DA_T08)=0,1,0)+IF(IF(DA_T09 IS NULL,0,DA_T09)=0,1,0)+IF(IF(DA_T10 IS NULL,0,DA_T10)=0,1,0)+IF(IF(DA_T11 IS NULL,0,DA_T11)=0,1,0) AS CNT_CURR_U11M,
    IF(IF(DA_T01 IS NULL,0,DA_T01)=0,1,0)+IF(IF(DA_T02 IS NULL,0,DA_T02)=0,1,0)+IF(IF(DA_T03 IS NULL,0,DA_T03)=0,1,0)+IF(IF(DA_T04 IS NULL,0,DA_T04)=0,1,0)+IF(IF(DA_T05 IS NULL,0,DA_T05)=0,1,0)+IF(IF(DA_T06 IS NULL,0,DA_T06)=0,1,0)+IF(IF(DA_T07 IS NULL,0,DA_T07)=0,1,0)+IF(IF(DA_T08 IS NULL,0,DA_T08)=0,1,0)+IF(IF(DA_T09 IS NULL,0,DA_T09)=0,1,0)+IF(IF(DA_T10 IS NULL,0,DA_T10)=0,1,0)+IF(IF(DA_T11 IS NULL,0,DA_T11)=0,1,0)+IF(IF(DA_T12 IS NULL,0,DA_T12)=0,1,0) AS CNT_CURR_U12M,
    
    IF(DA_T01>=1,1,0) AS CNT_01_U01M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0) AS CNT_01_U02M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0) AS CNT_01_U03M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0)+IF(DA_T04>=1,1,0) AS CNT_01_U04M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0)+IF(DA_T04>=1,1,0)+IF(DA_T05>=1,1,0) AS CNT_01_U05M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0)+IF(DA_T04>=1,1,0)+IF(DA_T05>=1,1,0)+IF(DA_T06>=1,1,0) AS CNT_01_U06M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0)+IF(DA_T04>=1,1,0)+IF(DA_T05>=1,1,0)+IF(DA_T06>=1,1,0)+IF(DA_T07>=1,1,0) AS CNT_01_U07M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0)+IF(DA_T04>=1,1,0)+IF(DA_T05>=1,1,0)+IF(DA_T06>=1,1,0)+IF(DA_T07>=1,1,0)+IF(DA_T08>=1,1,0) AS CNT_01_U08M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0)+IF(DA_T04>=1,1,0)+IF(DA_T05>=1,1,0)+IF(DA_T06>=1,1,0)+IF(DA_T07>=1,1,0)+IF(DA_T08>=1,1,0)+IF(DA_T09>=1,1,0) AS CNT_01_U09M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0)+IF(DA_T04>=1,1,0)+IF(DA_T05>=1,1,0)+IF(DA_T06>=1,1,0)+IF(DA_T07>=1,1,0)+IF(DA_T08>=1,1,0)+IF(DA_T09>=1,1,0)+IF(DA_T10>=1,1,0) AS CNT_01_U10M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0)+IF(DA_T04>=1,1,0)+IF(DA_T05>=1,1,0)+IF(DA_T06>=1,1,0)+IF(DA_T07>=1,1,0)+IF(DA_T08>=1,1,0)+IF(DA_T09>=1,1,0)+IF(DA_T10>=1,1,0)+IF(DA_T11>=1,1,0) AS CNT_01_U11M,
    IF(DA_T01>=1,1,0)+IF(DA_T02>=1,1,0)+IF(DA_T03>=1,1,0)+IF(DA_T04>=1,1,0)+IF(DA_T05>=1,1,0)+IF(DA_T06>=1,1,0)+IF(DA_T07>=1,1,0)+IF(DA_T08>=1,1,0)+IF(DA_T09>=1,1,0)+IF(DA_T10>=1,1,0)+IF(DA_T11>=1,1,0)+IF(DA_T12>=1,1,0) AS CNT_01_U12M,
    
    IF(DA_T01>=30,1,0) AS CNT_30_U01M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0) AS CNT_30_U02M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0) AS CNT_30_U03M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0)+IF(DA_T04>=30,1,0) AS CNT_30_U04M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0)+IF(DA_T04>=30,1,0)+IF(DA_T05>=30,1,0) AS CNT_30_U05M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0)+IF(DA_T04>=30,1,0)+IF(DA_T05>=30,1,0)+IF(DA_T06>=30,1,0) AS CNT_30_U06M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0)+IF(DA_T04>=30,1,0)+IF(DA_T05>=30,1,0)+IF(DA_T06>=30,1,0)+IF(DA_T07>=30,1,0) AS CNT_30_U07M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0)+IF(DA_T04>=30,1,0)+IF(DA_T05>=30,1,0)+IF(DA_T06>=30,1,0)+IF(DA_T07>=30,1,0)+IF(DA_T08>=30,1,0) AS CNT_30_U08M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0)+IF(DA_T04>=30,1,0)+IF(DA_T05>=30,1,0)+IF(DA_T06>=30,1,0)+IF(DA_T07>=30,1,0)+IF(DA_T08>=30,1,0)+IF(DA_T09>=30,1,0) AS CNT_30_U09M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0)+IF(DA_T04>=30,1,0)+IF(DA_T05>=30,1,0)+IF(DA_T06>=30,1,0)+IF(DA_T07>=30,1,0)+IF(DA_T08>=30,1,0)+IF(DA_T09>=30,1,0)+IF(DA_T10>=30,1,0) AS CNT_30_U10M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0)+IF(DA_T04>=30,1,0)+IF(DA_T05>=30,1,0)+IF(DA_T06>=30,1,0)+IF(DA_T07>=30,1,0)+IF(DA_T08>=30,1,0)+IF(DA_T09>=30,1,0)+IF(DA_T10>=30,1,0)+IF(DA_T11>=30,1,0) AS CNT_30_U11M,
    IF(DA_T01>=30,1,0)+IF(DA_T02>=30,1,0)+IF(DA_T03>=30,1,0)+IF(DA_T04>=30,1,0)+IF(DA_T05>=30,1,0)+IF(DA_T06>=30,1,0)+IF(DA_T07>=30,1,0)+IF(DA_T08>=30,1,0)+IF(DA_T09>=30,1,0)+IF(DA_T10>=30,1,0)+IF(DA_T11>=30,1,0)+IF(DA_T12>=30,1,0) AS CNT_30_U12M,
    
    IF(DA_T01>=60,1,0) AS CNT_60_U01M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0) AS CNT_60_U02M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0) AS CNT_60_U03M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0)+IF(DA_T04>=60,1,0) AS CNT_60_U04M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0)+IF(DA_T04>=60,1,0)+IF(DA_T05>=60,1,0) AS CNT_60_U05M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0)+IF(DA_T04>=60,1,0)+IF(DA_T05>=60,1,0)+IF(DA_T06>=60,1,0) AS CNT_60_U06M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0)+IF(DA_T04>=60,1,0)+IF(DA_T05>=60,1,0)+IF(DA_T06>=60,1,0)+IF(DA_T07>=60,1,0) AS CNT_60_U07M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0)+IF(DA_T04>=60,1,0)+IF(DA_T05>=60,1,0)+IF(DA_T06>=60,1,0)+IF(DA_T07>=60,1,0)+IF(DA_T08>=60,1,0) AS CNT_60_U08M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0)+IF(DA_T04>=60,1,0)+IF(DA_T05>=60,1,0)+IF(DA_T06>=60,1,0)+IF(DA_T07>=60,1,0)+IF(DA_T08>=60,1,0)+IF(DA_T09>=60,1,0) AS CNT_60_U09M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0)+IF(DA_T04>=60,1,0)+IF(DA_T05>=60,1,0)+IF(DA_T06>=60,1,0)+IF(DA_T07>=60,1,0)+IF(DA_T08>=60,1,0)+IF(DA_T09>=60,1,0)+IF(DA_T10>=60,1,0) AS CNT_60_U10M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0)+IF(DA_T04>=60,1,0)+IF(DA_T05>=60,1,0)+IF(DA_T06>=60,1,0)+IF(DA_T07>=60,1,0)+IF(DA_T08>=60,1,0)+IF(DA_T09>=60,1,0)+IF(DA_T10>=60,1,0)+IF(DA_T11>=60,1,0) AS CNT_60_U11M,
    IF(DA_T01>=60,1,0)+IF(DA_T02>=60,1,0)+IF(DA_T03>=60,1,0)+IF(DA_T04>=60,1,0)+IF(DA_T05>=60,1,0)+IF(DA_T06>=60,1,0)+IF(DA_T07>=60,1,0)+IF(DA_T08>=60,1,0)+IF(DA_T09>=60,1,0)+IF(DA_T10>=60,1,0)+IF(DA_T11>=60,1,0)+IF(DA_T12>=60,1,0) AS CNT_60_U12M,
    
    IF(DA_T01>=90,1,0) AS CNT_90_U01M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0) AS CNT_90_U02M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0) AS CNT_90_U03M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0)+IF(DA_T04>=90,1,0) AS CNT_90_U04M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0)+IF(DA_T04>=90,1,0)+IF(DA_T05>=90,1,0) AS CNT_90_U05M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0)+IF(DA_T04>=90,1,0)+IF(DA_T05>=90,1,0)+IF(DA_T06>=90,1,0) AS CNT_90_U06M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0)+IF(DA_T04>=90,1,0)+IF(DA_T05>=90,1,0)+IF(DA_T06>=90,1,0)+IF(DA_T07>=90,1,0) AS CNT_90_U07M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0)+IF(DA_T04>=90,1,0)+IF(DA_T05>=90,1,0)+IF(DA_T06>=90,1,0)+IF(DA_T07>=90,1,0)+IF(DA_T08>=90,1,0) AS CNT_90_U08M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0)+IF(DA_T04>=90,1,0)+IF(DA_T05>=90,1,0)+IF(DA_T06>=90,1,0)+IF(DA_T07>=90,1,0)+IF(DA_T08>=90,1,0)+IF(DA_T09>=90,1,0) AS CNT_90_U09M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0)+IF(DA_T04>=90,1,0)+IF(DA_T05>=90,1,0)+IF(DA_T06>=90,1,0)+IF(DA_T07>=90,1,0)+IF(DA_T08>=90,1,0)+IF(DA_T09>=90,1,0)+IF(DA_T10>=90,1,0) AS CNT_90_U10M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0)+IF(DA_T04>=90,1,0)+IF(DA_T05>=90,1,0)+IF(DA_T06>=90,1,0)+IF(DA_T07>=90,1,0)+IF(DA_T08>=90,1,0)+IF(DA_T09>=90,1,0)+IF(DA_T10>=90,1,0)+IF(DA_T11>=90,1,0) AS CNT_90_U11M,
    IF(DA_T01>=90,1,0)+IF(DA_T02>=90,1,0)+IF(DA_T03>=90,1,0)+IF(DA_T04>=90,1,0)+IF(DA_T05>=90,1,0)+IF(DA_T06>=90,1,0)+IF(DA_T07>=90,1,0)+IF(DA_T08>=90,1,0)+IF(DA_T09>=90,1,0)+IF(DA_T10>=90,1,0)+IF(DA_T11>=90,1,0)+IF(DA_T12>=90,1,0) AS CNT_90_U12M,
    
    IF(DA_T01<DA_T00,1,0) AS CNT_INC_U01M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0) AS CNT_INC_U02M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0) AS CNT_INC_U03M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0)+IF(DA_T04<DA_T03,1,0) AS CNT_INC_U04M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0)+IF(DA_T04<DA_T03,1,0)+IF(DA_T05<DA_T04,1,0) AS CNT_INC_U05M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0)+IF(DA_T04<DA_T03,1,0)+IF(DA_T05<DA_T04,1,0)+IF(DA_T06<DA_T05,1,0) AS CNT_INC_U06M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0)+IF(DA_T04<DA_T03,1,0)+IF(DA_T05<DA_T04,1,0)+IF(DA_T06<DA_T05,1,0)+IF(DA_T07<DA_T06,1,0) AS CNT_INC_U07M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0)+IF(DA_T04<DA_T03,1,0)+IF(DA_T05<DA_T04,1,0)+IF(DA_T06<DA_T05,1,0)+IF(DA_T07<DA_T06,1,0)+IF(DA_T08<DA_T07,1,0) AS CNT_INC_U08M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0)+IF(DA_T04<DA_T03,1,0)+IF(DA_T05<DA_T04,1,0)+IF(DA_T06<DA_T05,1,0)+IF(DA_T07<DA_T06,1,0)+IF(DA_T08<DA_T07,1,0)+IF(DA_T09<DA_T08,1,0) AS CNT_INC_U09M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0)+IF(DA_T04<DA_T03,1,0)+IF(DA_T05<DA_T04,1,0)+IF(DA_T06<DA_T05,1,0)+IF(DA_T07<DA_T06,1,0)+IF(DA_T08<DA_T07,1,0)+IF(DA_T09<DA_T08,1,0)+IF(DA_T10<DA_T09,1,0) AS CNT_INC_U10M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0)+IF(DA_T04<DA_T03,1,0)+IF(DA_T05<DA_T04,1,0)+IF(DA_T06<DA_T05,1,0)+IF(DA_T07<DA_T06,1,0)+IF(DA_T08<DA_T07,1,0)+IF(DA_T09<DA_T08,1,0)+IF(DA_T10<DA_T09,1,0)+IF(DA_T11<DA_T10,1,0) AS CNT_INC_U11M,
    IF(DA_T01<DA_T00,1,0)+IF(DA_T02<DA_T01,1,0)+IF(DA_T03<DA_T02,1,0)+IF(DA_T04<DA_T03,1,0)+IF(DA_T05<DA_T04,1,0)+IF(DA_T06<DA_T05,1,0)+IF(DA_T07<DA_T06,1,0)+IF(DA_T08<DA_T07,1,0)+IF(DA_T09<DA_T08,1,0)+IF(DA_T10<DA_T09,1,0)+IF(DA_T11<DA_T10,1,0)+IF(DA_T12<DA_T11,1,0) AS CNT_INC_U12M,
    
    IF(DA_T01>DA_T00,1,0) AS CNT_DEC_U01M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0) AS CNT_DEC_U02M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0) AS CNT_DEC_U03M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0)+IF(DA_T04>DA_T03,1,0) AS CNT_DEC_U04M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0)+IF(DA_T04>DA_T03,1,0)+IF(DA_T05>DA_T04,1,0) AS CNT_DEC_U05M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0)+IF(DA_T04>DA_T03,1,0)+IF(DA_T05>DA_T04,1,0)+IF(DA_T06>DA_T05,1,0) AS CNT_DEC_U06M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0)+IF(DA_T04>DA_T03,1,0)+IF(DA_T05>DA_T04,1,0)+IF(DA_T06>DA_T05,1,0)+IF(DA_T07>DA_T06,1,0) AS CNT_DEC_U07M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0)+IF(DA_T04>DA_T03,1,0)+IF(DA_T05>DA_T04,1,0)+IF(DA_T06>DA_T05,1,0)+IF(DA_T07>DA_T06,1,0)+IF(DA_T08>DA_T07,1,0) AS CNT_DEC_U08M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0)+IF(DA_T04>DA_T03,1,0)+IF(DA_T05>DA_T04,1,0)+IF(DA_T06>DA_T05,1,0)+IF(DA_T07>DA_T06,1,0)+IF(DA_T08>DA_T07,1,0)+IF(DA_T09>DA_T08,1,0) AS CNT_DEC_U09M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0)+IF(DA_T04>DA_T03,1,0)+IF(DA_T05>DA_T04,1,0)+IF(DA_T06>DA_T05,1,0)+IF(DA_T07>DA_T06,1,0)+IF(DA_T08>DA_T07,1,0)+IF(DA_T09>DA_T08,1,0)+IF(DA_T10>DA_T09,1,0) AS CNT_DEC_U10M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0)+IF(DA_T04>DA_T03,1,0)+IF(DA_T05>DA_T04,1,0)+IF(DA_T06>DA_T05,1,0)+IF(DA_T07>DA_T06,1,0)+IF(DA_T08>DA_T07,1,0)+IF(DA_T09>DA_T08,1,0)+IF(DA_T10>DA_T09,1,0)+IF(DA_T11>DA_T10,1,0) AS CNT_DEC_U11M,
    IF(DA_T01>DA_T00,1,0)+IF(DA_T02>DA_T01,1,0)+IF(DA_T03>DA_T02,1,0)+IF(DA_T04>DA_T03,1,0)+IF(DA_T05>DA_T04,1,0)+IF(DA_T06>DA_T05,1,0)+IF(DA_T07>DA_T06,1,0)+IF(DA_T08>DA_T07,1,0)+IF(DA_T09>DA_T08,1,0)+IF(DA_T10>DA_T09,1,0)+IF(DA_T11>DA_T10,1,0)+IF(DA_T12>DA_T11,1,0) AS CNT_DEC_U12M
FROM
    dbriskdatamart.MZM_MCV_DA_PASO1__${FECHA_CALIFICACION}
;

SELECT * FROM dbriskdatamart.MZM_MCV_VAR_VARIABLES_DIASATRASO2__${FECHA_CALIFICACION} LIMIT 1000;