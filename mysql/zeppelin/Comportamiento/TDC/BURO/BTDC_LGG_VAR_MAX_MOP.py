%hive

DROP TABLE IF EXISTS dbmymwork.BTDC_LGG_VAR_MAX_MOP;
CREATE TABLE dbmymwork.BTDC_LGG_VAR_MAX_MOP
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/BTDC/VARIABLES/BTDC_LGG_VAR_MAX_MOP' AS

SELECT
CUENTADEREFERENCIA,
FECHA_CARTERA,

COUNT(MAX_MOP_BK_AU_CL_ACC)  AS NUM_MAX_MOP_BK_AU_CL_ACC,
MAX(MAX_MOP_BK_AU_CL_ACC)    AS MAX_MAX_MOP_BK_AU_CL_ACC,
SUM(MAX_MOP_BK_AU_CL_ACC)    AS SUM_MAX_MOP_BK_AU_CL_ACC,
AVG(MAX_MOP_BK_AU_CL_ACC)    AS AVG_MAX_MOP_BK_AU_CL_ACC,
COUNT(MAX_MOP_BK_AU_OP_ACC)  AS NUM_MAX_MOP_BK_AU_OP_ACC,
MAX(MAX_MOP_BK_AU_OP_ACC)    AS MAX_MAX_MOP_BK_AU_OP_ACC,
SUM(MAX_MOP_BK_AU_OP_ACC)    AS SUM_MAX_MOP_BK_AU_OP_ACC,
AVG(MAX_MOP_BK_AU_OP_ACC)    AS AVG_MAX_MOP_BK_AU_OP_ACC,
COUNT(MAX_MOP_BK_AU)         AS NUM_MAX_MOP_BK_AU,
MAX(MAX_MOP_BK_AU)           AS MAX_MAX_MOP_BK_AU,
SUM(MAX_MOP_BK_AU)           AS SUM_MAX_MOP_BK_AU,
AVG(MAX_MOP_BK_AU)           AS AVG_MAX_MOP_BK_AU,
COUNT(MAX_MOP_BK_M_CL_ACC)   AS NUM_MAX_MOP_BK_M_CL_ACC,
MAX(MAX_MOP_BK_M_CL_ACC)     AS MAX_MAX_MOP_BK_M_CL_ACC,
SUM(MAX_MOP_BK_M_CL_ACC)     AS SUM_MAX_MOP_BK_M_CL_ACC,
AVG(MAX_MOP_BK_M_CL_ACC)     AS AVG_MAX_MOP_BK_M_CL_ACC,
COUNT(MAX_MOP_BK_M_OP_ACC)   AS NUM_MAX_MOP_BK_M_OP_ACC,
MAX(MAX_MOP_BK_M_OP_ACC)     AS MAX_MAX_MOP_BK_M_OP_ACC,
SUM(MAX_MOP_BK_M_OP_ACC)     AS SUM_MAX_MOP_BK_M_OP_ACC,
AVG(MAX_MOP_BK_M_OP_ACC)     AS AVG_MAX_MOP_BK_M_OP_ACC,
COUNT(MAX_MOP_BK_M)          AS NUM_MAX_MOP_BK_M,
MAX(MAX_MOP_BK_M)            AS MAX_MAX_MOP_BK_M,
SUM(MAX_MOP_BK_M)            AS SUM_MAX_MOP_BK_M,
AVG(MAX_MOP_BK_M)            AS AVG_MAX_MOP_BK_M,
COUNT(MAX_MOP_BK_PL_CL_ACC)  AS NUM_MAX_MOP_BK_PL_CL_ACC,
MAX(MAX_MOP_BK_PL_CL_ACC)    AS MAX_MAX_MOP_BK_PL_CL_ACC,
SUM(MAX_MOP_BK_PL_CL_ACC)    AS SUM_MAX_MOP_BK_PL_CL_ACC,
AVG(MAX_MOP_BK_PL_CL_ACC)    AS AVG_MAX_MOP_BK_PL_CL_ACC,
COUNT(MAX_MOP_BK_PL_OP_ACC)  AS NUM_MAX_MOP_BK_PL_OP_ACC,
MAX(MAX_MOP_BK_PL_OP_ACC)    AS MAX_MAX_MOP_BK_PL_OP_ACC,
SUM(MAX_MOP_BK_PL_OP_ACC)    AS SUM_MAX_MOP_BK_PL_OP_ACC,
AVG(MAX_MOP_BK_PL_OP_ACC)    AS AVG_MAX_MOP_BK_PL_OP_ACC,
COUNT(MAX_MOP_BK_PL)         AS NUM_MAX_MOP_BK_PL,
MAX(MAX_MOP_BK_PL)           AS MAX_MAX_MOP_BK_PL,
SUM(MAX_MOP_BK_PL)           AS SUM_MAX_MOP_BK_PL,
AVG(MAX_MOP_BK_PL)           AS AVG_MAX_MOP_BK_PL,
COUNT(MAX_MOP_BK_R_CL_ACC)   AS NUM_MAX_MOP_BK_R_CL_ACC,
MAX(MAX_MOP_BK_R_CL_ACC)     AS MAX_MAX_MOP_BK_R_CL_ACC,
SUM(MAX_MOP_BK_R_CL_ACC)     AS SUM_MAX_MOP_BK_R_CL_ACC,
AVG(MAX_MOP_BK_R_CL_ACC)     AS AVG_MAX_MOP_BK_R_CL_ACC,
COUNT(MAX_MOP_BK_R_OP_ACC)   AS NUM_MAX_MOP_BK_R_OP_ACC,
MAX(MAX_MOP_BK_R_OP_ACC)     AS MAX_MAX_MOP_BK_R_OP_ACC,
SUM(MAX_MOP_BK_R_OP_ACC)     AS SUM_MAX_MOP_BK_R_OP_ACC,
AVG(MAX_MOP_BK_R_OP_ACC)     AS AVG_MAX_MOP_BK_R_OP_ACC,
COUNT(MAX_MOP_BK_R)          AS NUM_MAX_MOP_BK_R,
MAX(MAX_MOP_BK_R)            AS MAX_MAX_MOP_BK_R,
SUM(MAX_MOP_BK_R)            AS SUM_MAX_MOP_BK_R,
AVG(MAX_MOP_BK_R)            AS AVG_MAX_MOP_BK_R,
COUNT(MAX_MOP_BK_CL_ACC)     AS NUM_MAX_MOP_BK_CL_ACC,
MAX(MAX_MOP_BK_CL_ACC)       AS MAX_MAX_MOP_BK_CL_ACC,
SUM(MAX_MOP_BK_CL_ACC)       AS SUM_MAX_MOP_BK_CL_ACC,
AVG(MAX_MOP_BK_CL_ACC)       AS AVG_MAX_MOP_BK_CL_ACC,
COUNT(MAX_MOP_BK_OP_ACC)     AS NUM_MAX_MOP_BK_OP_ACC,
MAX(MAX_MOP_BK_OP_ACC)       AS MAX_MAX_MOP_BK_OP_ACC,
SUM(MAX_MOP_BK_OP_ACC)       AS SUM_MAX_MOP_BK_OP_ACC,
AVG(MAX_MOP_BK_OP_ACC)       AS AVG_MAX_MOP_BK_OP_ACC,
COUNT(MAX_MOP_BK)            AS NUM_MAX_MOP_BK,
MAX(MAX_MOP_BK)              AS MAX_MAX_MOP_BK,
SUM(MAX_MOP_BK)              AS SUM_MAX_MOP_BK,
AVG(MAX_MOP_BK)              AS AVG_MAX_MOP_BK,
COUNT(MAX_MOP_NBK_AU_CL_ACC) AS NUM_MAX_MOP_NBK_AU_CL_ACC,
MAX(MAX_MOP_NBK_AU_CL_ACC)   AS MAX_MAX_MOP_NBK_AU_CL_ACC,
SUM(MAX_MOP_NBK_AU_CL_ACC)   AS SUM_MAX_MOP_NBK_AU_CL_ACC,
AVG(MAX_MOP_NBK_AU_CL_ACC)   AS AVG_MAX_MOP_NBK_AU_CL_ACC,
COUNT(MAX_MOP_NBK_AU_OP_ACC) AS NUM_MAX_MOP_NBK_AU_OP_ACC,
MAX(MAX_MOP_NBK_AU_OP_ACC)   AS MAX_MAX_MOP_NBK_AU_OP_ACC,
SUM(MAX_MOP_NBK_AU_OP_ACC)   AS SUM_MAX_MOP_NBK_AU_OP_ACC,
AVG(MAX_MOP_NBK_AU_OP_ACC)   AS AVG_MAX_MOP_NBK_AU_OP_ACC,
COUNT(MAX_MOP_NBK_AU)        AS NUM_MAX_MOP_NBK_AU,
MAX(MAX_MOP_NBK_AU)          AS MAX_MAX_MOP_NBK_AU,
SUM(MAX_MOP_NBK_AU)          AS SUM_MAX_MOP_NBK_AU,
AVG(MAX_MOP_NBK_AU)          AS AVG_MAX_MOP_NBK_AU,
COUNT(MAX_MOP_NBK_M_CL_ACC)  AS NUM_MAX_MOP_NBK_M_CL_ACC,
MAX(MAX_MOP_NBK_M_CL_ACC)    AS MAX_MAX_MOP_NBK_M_CL_ACC,
SUM(MAX_MOP_NBK_M_CL_ACC)    AS SUM_MAX_MOP_NBK_M_CL_ACC,
AVG(MAX_MOP_NBK_M_CL_ACC)    AS AVG_MAX_MOP_NBK_M_CL_ACC,
COUNT(MAX_MOP_NBK_M_OP_ACC)  AS NUM_MAX_MOP_NBK_M_OP_ACC,
MAX(MAX_MOP_NBK_M_OP_ACC)    AS MAX_MAX_MOP_NBK_M_OP_ACC,
SUM(MAX_MOP_NBK_M_OP_ACC)    AS SUM_MAX_MOP_NBK_M_OP_ACC,
AVG(MAX_MOP_NBK_M_OP_ACC)    AS AVG_MAX_MOP_NBK_M_OP_ACC,
COUNT(MAX_MOP_NBK_M)         AS NUM_MAX_MOP_NBK_M,
MAX(MAX_MOP_NBK_M)           AS MAX_MAX_MOP_NBK_M,
SUM(MAX_MOP_NBK_M)           AS SUM_MAX_MOP_NBK_M,
AVG(MAX_MOP_NBK_M)           AS AVG_MAX_MOP_NBK_M,
COUNT(MAX_MOP_NBK_PL_CL_ACC) AS NUM_MAX_MOP_NBK_PL_CL_ACC,
MAX(MAX_MOP_NBK_PL_CL_ACC)   AS MAX_MAX_MOP_NBK_PL_CL_ACC,
SUM(MAX_MOP_NBK_PL_CL_ACC)   AS SUM_MAX_MOP_NBK_PL_CL_ACC,
AVG(MAX_MOP_NBK_PL_CL_ACC)   AS AVG_MAX_MOP_NBK_PL_CL_ACC,
COUNT(MAX_MOP_NBK_PL_OP_ACC) AS NUM_MAX_MOP_NBK_PL_OP_ACC,
MAX(MAX_MOP_NBK_PL_OP_ACC)   AS MAX_MAX_MOP_NBK_PL_OP_ACC,
SUM(MAX_MOP_NBK_PL_OP_ACC)   AS SUM_MAX_MOP_NBK_PL_OP_ACC,
AVG(MAX_MOP_NBK_PL_OP_ACC)   AS AVG_MAX_MOP_NBK_PL_OP_ACC,
COUNT(MAX_MOP_NBK_PL)        AS NUM_MAX_MOP_NBK_PL,
MAX(MAX_MOP_NBK_PL)          AS MAX_MAX_MOP_NBK_PL,
SUM(MAX_MOP_NBK_PL)          AS SUM_MAX_MOP_NBK_PL,
AVG(MAX_MOP_NBK_PL)          AS AVG_MAX_MOP_NBK_PL,
COUNT(MAX_MOP_NBK_R_CL_ACC)  AS NUM_MAX_MOP_NBK_R_CL_ACC,
MAX(MAX_MOP_NBK_R_CL_ACC)    AS MAX_MAX_MOP_NBK_R_CL_ACC,
SUM(MAX_MOP_NBK_R_CL_ACC)    AS SUM_MAX_MOP_NBK_R_CL_ACC,
AVG(MAX_MOP_NBK_R_CL_ACC)    AS AVG_MAX_MOP_NBK_R_CL_ACC,
COUNT(MAX_MOP_NBK_R_OP_ACC)  AS NUM_MAX_MOP_NBK_R_OP_ACC,
MAX(MAX_MOP_NBK_R_OP_ACC)    AS MAX_MAX_MOP_NBK_R_OP_ACC,
SUM(MAX_MOP_NBK_R_OP_ACC)    AS SUM_MAX_MOP_NBK_R_OP_ACC,
AVG(MAX_MOP_NBK_R_OP_ACC)    AS AVG_MAX_MOP_NBK_R_OP_ACC,
COUNT(MAX_MOP_NBK_R)         AS NUM_MAX_MOP_NBK_R,
MAX(MAX_MOP_NBK_R)           AS MAX_MAX_MOP_NBK_R,
SUM(MAX_MOP_NBK_R)           AS SUM_MAX_MOP_NBK_R,
AVG(MAX_MOP_NBK_R)           AS AVG_MAX_MOP_NBK_R,
COUNT(MAX_MOP_NBK_CL_ACC)    AS NUM_MAX_MOP_NBK_CL_ACC,
MAX(MAX_MOP_NBK_CL_ACC)      AS MAX_MAX_MOP_NBK_CL_ACC,
SUM(MAX_MOP_NBK_CL_ACC)      AS SUM_MAX_MOP_NBK_CL_ACC,
AVG(MAX_MOP_NBK_CL_ACC)      AS AVG_MAX_MOP_NBK_CL_ACC,
COUNT(MAX_MOP_NBK_OP_ACC)    AS NUM_MAX_MOP_NBK_OP_ACC,
MAX(MAX_MOP_NBK_OP_ACC)      AS MAX_MAX_MOP_NBK_OP_ACC,
SUM(MAX_MOP_NBK_OP_ACC)      AS SUM_MAX_MOP_NBK_OP_ACC,
AVG(MAX_MOP_NBK_OP_ACC)      AS AVG_MAX_MOP_NBK_OP_ACC,
COUNT(MAX_MOP_NBK)           AS NUM_MAX_MOP_NBK,
MAX(MAX_MOP_NBK)             AS MAX_MAX_MOP_NBK,
SUM(MAX_MOP_NBK)             AS SUM_MAX_MOP_NBK,
AVG(MAX_MOP_NBK)             AS AVG_MAX_MOP_NBK,
COUNT(MAX_MOP_AMX_CL_ACC)    AS NUM_MAX_MOP_AMX_CL_ACC,
MAX(MAX_MOP_AMX_CL_ACC)      AS MAX_MAX_MOP_AMX_CL_ACC,
SUM(MAX_MOP_AMX_CL_ACC)      AS SUM_MAX_MOP_AMX_CL_ACC,
AVG(MAX_MOP_AMX_CL_ACC)      AS AVG_MAX_MOP_AMX_CL_ACC,
COUNT(MAX_MOP_AMX_OP_ACC)    AS NUM_MAX_MOP_AMX_OP_ACC,
MAX(MAX_MOP_AMX_OP_ACC)      AS MAX_MAX_MOP_AMX_OP_ACC,
SUM(MAX_MOP_AMX_OP_ACC)      AS SUM_MAX_MOP_AMX_OP_ACC,
AVG(MAX_MOP_AMX_OP_ACC)      AS AVG_MAX_MOP_AMX_OP_ACC,
COUNT(MAX_MOP_AMX)           AS NUM_MAX_MOP_AMX,
MAX(MAX_MOP_AMX)             AS MAX_MAX_MOP_AMX,
SUM(MAX_MOP_AMX)             AS SUM_MAX_MOP_AMX,
AVG(MAX_MOP_AMX)             AS AVG_MAX_MOP_AMX,
COUNT(MAX_MOP_AU_CL_ACC)     AS NUM_MAX_MOP_AU_CL_ACC,
MAX(MAX_MOP_AU_CL_ACC)       AS MAX_MAX_MOP_AU_CL_ACC,
SUM(MAX_MOP_AU_CL_ACC)       AS SUM_MAX_MOP_AU_CL_ACC,
AVG(MAX_MOP_AU_CL_ACC)       AS AVG_MAX_MOP_AU_CL_ACC,
COUNT(MAX_MOP_AU_OP_ACC)     AS NUM_MAX_MOP_AU_OP_ACC,
MAX(MAX_MOP_AU_OP_ACC)       AS MAX_MAX_MOP_AU_OP_ACC,
SUM(MAX_MOP_AU_OP_ACC)       AS SUM_MAX_MOP_AU_OP_ACC,
AVG(MAX_MOP_AU_OP_ACC)       AS AVG_MAX_MOP_AU_OP_ACC,
COUNT(MAX_MOP_AU)            AS NUM_MAX_MOP_AU,
MAX(MAX_MOP_AU)              AS MAX_MAX_MOP_AU,
SUM(MAX_MOP_AU)              AS SUM_MAX_MOP_AU,
AVG(MAX_MOP_AU)              AS AVG_MAX_MOP_AU,
COUNT(MAX_MOP_M_CL_ACC)      AS NUM_MAX_MOP_M_CL_ACC,
MAX(MAX_MOP_M_CL_ACC)        AS MAX_MAX_MOP_M_CL_ACC,
SUM(MAX_MOP_M_CL_ACC)        AS SUM_MAX_MOP_M_CL_ACC,
AVG(MAX_MOP_M_CL_ACC)        AS AVG_MAX_MOP_M_CL_ACC,
COUNT(MAX_MOP_M_OP_ACC)      AS NUM_MAX_MOP_M_OP_ACC,
MAX(MAX_MOP_M_OP_ACC)        AS MAX_MAX_MOP_M_OP_ACC,
SUM(MAX_MOP_M_OP_ACC)        AS SUM_MAX_MOP_M_OP_ACC,
AVG(MAX_MOP_M_OP_ACC)        AS AVG_MAX_MOP_M_OP_ACC,
COUNT(MAX_MOP_M)             AS NUM_MAX_MOP_M,
MAX(MAX_MOP_M)               AS MAX_MAX_MOP_M,
SUM(MAX_MOP_M)               AS SUM_MAX_MOP_M,
AVG(MAX_MOP_M)               AS AVG_MAX_MOP_M,
COUNT(MAX_MOP_PL_CL_ACC)     AS NUM_MAX_MOP_PL_CL_ACC,
MAX(MAX_MOP_PL_CL_ACC)       AS MAX_MAX_MOP_PL_CL_ACC,
SUM(MAX_MOP_PL_CL_ACC)       AS SUM_MAX_MOP_PL_CL_ACC,
AVG(MAX_MOP_PL_CL_ACC)       AS AVG_MAX_MOP_PL_CL_ACC,
COUNT(MAX_MOP_PL_OP_ACC)     AS NUM_MAX_MOP_PL_OP_ACC,
MAX(MAX_MOP_PL_OP_ACC)       AS MAX_MAX_MOP_PL_OP_ACC,
SUM(MAX_MOP_PL_OP_ACC)       AS SUM_MAX_MOP_PL_OP_ACC,
AVG(MAX_MOP_PL_OP_ACC)       AS AVG_MAX_MOP_PL_OP_ACC,
COUNT(MAX_MOP_PL)            AS NUM_MAX_MOP_PL,
MAX(MAX_MOP_PL)              AS MAX_MAX_MOP_PL,
SUM(MAX_MOP_PL)              AS SUM_MAX_MOP_PL,
AVG(MAX_MOP_PL)              AS AVG_MAX_MOP_PL,
COUNT(MAX_MOP_R_CL_ACC)      AS NUM_MAX_MOP_R_CL_ACC,
MAX(MAX_MOP_R_CL_ACC)        AS MAX_MAX_MOP_R_CL_ACC,
SUM(MAX_MOP_R_CL_ACC)        AS SUM_MAX_MOP_R_CL_ACC,
AVG(MAX_MOP_R_CL_ACC)        AS AVG_MAX_MOP_R_CL_ACC,
COUNT(MAX_MOP_R_OP_ACC)      AS NUM_MAX_MOP_R_OP_ACC,
MAX(MAX_MOP_R_OP_ACC)        AS MAX_MAX_MOP_R_OP_ACC,
SUM(MAX_MOP_R_OP_ACC)        AS SUM_MAX_MOP_R_OP_ACC,
AVG(MAX_MOP_R_OP_ACC)        AS AVG_MAX_MOP_R_OP_ACC,
COUNT(MAX_MOP_R)             AS NUM_MAX_MOP_R,
MAX(MAX_MOP_R)               AS MAX_MAX_MOP_R,
SUM(MAX_MOP_R)               AS SUM_MAX_MOP_R,
AVG(MAX_MOP_R)               AS AVG_MAX_MOP_R,
COUNT(MAX_MOP_CL_ACC)        AS NUM_MAX_MOP_CL_ACC,
MAX(MAX_MOP_CL_ACC)          AS MAX_MAX_MOP_CL_ACC,
SUM(MAX_MOP_CL_ACC)          AS SUM_MAX_MOP_CL_ACC,
AVG(MAX_MOP_CL_ACC)          AS AVG_MAX_MOP_CL_ACC,
COUNT(MAX_MOP_OP_ACC)        AS NUM_MAX_MOP_OP_ACC,
MAX(MAX_MOP_OP_ACC)          AS MAX_MAX_MOP_OP_ACC,
SUM(MAX_MOP_OP_ACC)          AS SUM_MAX_MOP_OP_ACC,
AVG(MAX_MOP_OP_ACC)          AS AVG_MAX_MOP_OP_ACC,
COUNT(MAX_MOP)               AS NUM_MAX_MOP,
MAX(MAX_MOP)                 AS MAX_MAX_MOP,
SUM(MAX_MOP)                 AS SUM_MAX_MOP,
AVG(MAX_MOP)                 AS AVG_MAX_MOP,

-- COMUNICACIONES Y SERVICIOS 

COUNT(MAX_MOP_TU_ALL ) AS NUM_MAX_MOP_TU_ALL, 
MAX(MAX_MOP_TU_ALL   ) AS MAX_MAX_MOP_TU_ALL,
SUM(MAX_MOP_TU_ALL   ) AS SUM_MAX_MOP_TU_ALL,
AVG(MAX_MOP_TU_ALL)    AS AVG_MAX_MOP_TU_ALL,
                            
COUNT(MAX_MOP_TU) AS NUM_MAX_MOP_TU,
MAX(MAX_MOP_TU  ) AS MAX_MAX_MOP_TU,
SUM(MAX_MOP_TU  ) AS SUM_MAX_MOP_TU,
AVG(MAX_MOP_TU)   AS AVG_MAX_MOP_TU,
    
COUNT(MAX_MOP_TU_ALL_OP_ACC ) AS NUM_MAX_MOP_TU_ALL_OP_ACC,
MAX(MAX_MOP_TU_ALL_OP_ACC   ) AS MAX_MAX_MOP_TU_ALL_OP_ACC,
SUM(MAX_MOP_TU_ALL_OP_ACC   ) AS SUM_MAX_MOP_TU_ALL_OP_ACC,
AVG(MAX_MOP_TU_ALL_OP_ACC)    AS AVG_MAX_MOP_TU_ALL_OP_ACC,
    
COUNT(MAX_MOP_TU_OP_ACC ) AS NUM_MAX_MOP_TU_OP_ACC,
MAX(MAX_MOP_TU_OP_ACC   ) AS MAX_MAX_MOP_TU_OP_ACC,
SUM(MAX_MOP_TU_OP_ACC   ) AS SUM_MAX_MOP_TU_OP_ACC,
AVG(MAX_MOP_TU_OP_ACC)    AS AVG_MAX_MOP_TU_OP_ACC,
    
COUNT(MAX_MOP_TU_ALL_CL_ACC ) AS NUM_MAX_MOP_TU_ALL_CL_ACC,
MAX(MAX_MOP_TU_ALL_CL_ACC   ) AS MAX_MAX_MOP_TU_ALL_CL_ACC,
SUM(MAX_MOP_TU_ALL_CL_ACC   ) AS SUM_MAX_MOP_TU_ALL_CL_ACC,
AVG(MAX_MOP_TU_ALL_CL_ACC)    AS AVG_MAX_MOP_TU_ALL_CL_ACC,
    
COUNT(MAX_MOP_TU_CL_ACC  ) AS NUM_MAX_MOP_TU_CL_ACC,
MAX(MAX_MOP_TU_CL_ACC    ) AS MAX_MAX_MOP_TU_CL_ACC,
SUM(MAX_MOP_TU_CL_ACC    ) AS SUM_MAX_MOP_TU_CL_ACC,
AVG(MAX_MOP_TU_CL_ACC)     AS AVG_MAX_MOP_TU_CL_ACC,
    
COUNT(MAX_MOP_NBK_TU  ) AS NUM_MAX_MOP_NBK_TU,
MAX(MAX_MOP_NBK_TU    ) AS MAX_MAX_MOP_NBK_TU,
SUM(MAX_MOP_NBK_TU    ) AS SUM_MAX_MOP_NBK_TU,
AVG(MAX_MOP_NBK_TU)     AS AVG_MAX_MOP_NBK_TU,
    
COUNT(MAX_MOP_NBK_TU_OP_ACC  ) AS NUM_MAX_MOP_NBK_TU_OP_ACC,
MAX(MAX_MOP_NBK_TU_OP_ACC    ) AS MAX_MAX_MOP_NBK_TU_OP_ACC,
SUM(MAX_MOP_NBK_TU_OP_ACC    ) AS SUM_MAX_MOP_NBK_TU_OP_ACC,
AVG(MAX_MOP_NBK_TU_OP_ACC)     AS AVG_MAX_MOP_NBK_TU_OP_ACC,
    
COUNT(MAX_MOP_NBK_TU_CL_ACC ) AS NUM_MAX_MOP_NBK_TU_CL_ACC,
MAX(MAX_MOP_NBK_TU_CL_ACC   ) AS MAX_MAX_MOP_NBK_TU_CL_ACC,
SUM(MAX_MOP_NBK_TU_CL_ACC   ) AS SUM_MAX_MOP_NBK_TU_CL_ACC,
AVG(MAX_MOP_NBK_TU_CL_ACC)    AS AVG_MAX_MOP_NBK_TU_CL_ACC

FROM dbmymwork.BTDC_LGG_VAR_SEGMENTADAS_2
GROUP BY CUENTADEREFERENCIA,
FECHA_CARTERA
;

SELECT * FROM dbmymwork.BTDC_LGG_VAR_MAX_MOP LIMIT 100;