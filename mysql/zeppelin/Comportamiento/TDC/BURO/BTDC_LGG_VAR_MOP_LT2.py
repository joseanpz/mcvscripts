%hive

DROP TABLE IF EXISTS dbmymwork.BTDC_LGG_VAR_MOP_LT2;
CREATE TABLE dbmymwork.BTDC_LGG_VAR_MOP_LT2
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION  's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/BTDC/VARIABLES/BTDC_LGG_VAR_MOP_LT2' AS

SELECT
CUENTADEREFERENCIA,
FECHA_CARTERA,

AVG(MOP_LT2_BK_AU_CL_ACC    ) AS AVG_MOP_LT2_BK_AU_CL_ACC    ,
AVG(MOP_LT2_BK_AU_OP_ACC    ) AS AVG_MOP_LT2_BK_AU_OP_ACC    ,
AVG(MOP_LT2_BK_AU           ) AS AVG_MOP_LT2_BK_AU           ,
AVG(MOP_LT2_BK_M_CL_ACC     ) AS AVG_MOP_LT2_BK_M_CL_ACC     ,
AVG(MOP_LT2_BK_M_OP_ACC     ) AS AVG_MOP_LT2_BK_M_OP_ACC     ,
AVG(MOP_LT2_BK_M            ) AS AVG_MOP_LT2_BK_M            ,
AVG(MOP_LT2_BK_PL_CL_ACC    ) AS AVG_MOP_LT2_BK_PL_CL_ACC    ,
AVG(MOP_LT2_BK_PL_OP_ACC    ) AS AVG_MOP_LT2_BK_PL_OP_ACC    ,
AVG(MOP_LT2_BK_PL           ) AS AVG_MOP_LT2_BK_PL           ,
AVG(MOP_LT2_BK_R_CL_ACC     ) AS AVG_MOP_LT2_BK_R_CL_ACC     ,
AVG(MOP_LT2_BK_R_OP_ACC     ) AS AVG_MOP_LT2_BK_R_OP_ACC     ,
AVG(MOP_LT2_BK_R            ) AS AVG_MOP_LT2_BK_R            ,
AVG(MOP_LT2_BK_CL_ACC       ) AS AVG_MOP_LT2_BK_CL_ACC       ,
AVG(MOP_LT2_BK_OP_ACC       ) AS AVG_MOP_LT2_BK_OP_ACC       ,
AVG(MOP_LT2_BK              ) AS AVG_MOP_LT2_BK              ,
AVG(MOP_LT2_NBK_AU_CL_ACC   ) AS AVG_MOP_LT2_NBK_AU_CL_ACC   ,
AVG(MOP_LT2_NBK_AU_OP_ACC   ) AS AVG_MOP_LT2_NBK_AU_OP_ACC   ,
AVG(MOP_LT2_NBK_AU          ) AS AVG_MOP_LT2_NBK_AU          ,
AVG(MOP_LT2_NBK_M_CL_ACC    ) AS AVG_MOP_LT2_NBK_M_CL_ACC    ,
AVG(MOP_LT2_NBK_M_OP_ACC    ) AS AVG_MOP_LT2_NBK_M_OP_ACC    ,
AVG(MOP_LT2_NBK_M           ) AS AVG_MOP_LT2_NBK_M           ,
AVG(MOP_LT2_NBK_PL_CL_ACC   ) AS AVG_MOP_LT2_NBK_PL_CL_ACC   ,
AVG(MOP_LT2_NBK_PL_OP_ACC   ) AS AVG_MOP_LT2_NBK_PL_OP_ACC   ,
AVG(MOP_LT2_NBK_PL          ) AS AVG_MOP_LT2_NBK_PL          ,
AVG(MOP_LT2_NBK_R_CL_ACC    ) AS AVG_MOP_LT2_NBK_R_CL_ACC    ,
AVG(MOP_LT2_NBK_R_OP_ACC    ) AS AVG_MOP_LT2_NBK_R_OP_ACC    ,
AVG(MOP_LT2_NBK_R           ) AS AVG_MOP_LT2_NBK_R           ,
AVG(MOP_LT2_NBK_CL_ACC      ) AS AVG_MOP_LT2_NBK_CL_ACC      ,
AVG(MOP_LT2_NBK_OP_ACC      ) AS AVG_MOP_LT2_NBK_OP_ACC      ,
AVG(MOP_LT2_NBK             ) AS AVG_MOP_LT2_NBK             ,
AVG(MOP_LT2_AMX_CL_ACC      ) AS AVG_MOP_LT2_AMX_CL_ACC      ,
AVG(MOP_LT2_AMX_OP_ACC      ) AS AVG_MOP_LT2_AMX_OP_ACC      ,
AVG(MOP_LT2_AMX             ) AS AVG_MOP_LT2_AMX             ,
AVG(MOP_LT2_AU_CL_ACC       ) AS AVG_MOP_LT2_AU_CL_ACC       ,
AVG(MOP_LT2_AU_OP_ACC       ) AS AVG_MOP_LT2_AU_OP_ACC       ,
AVG(MOP_LT2_AU              ) AS AVG_MOP_LT2_AU              ,
AVG(MOP_LT2_M_CL_ACC        ) AS AVG_MOP_LT2_M_CL_ACC        ,
AVG(MOP_LT2_M_OP_ACC        ) AS AVG_MOP_LT2_M_OP_ACC        ,
AVG(MOP_LT2_M               ) AS AVG_MOP_LT2_M               ,
AVG(MOP_LT2_PL_CL_ACC       ) AS AVG_MOP_LT2_PL_CL_ACC       ,
AVG(MOP_LT2_PL_OP_ACC       ) AS AVG_MOP_LT2_PL_OP_ACC       ,
AVG(MOP_LT2_PL              ) AS AVG_MOP_LT2_PL              ,
AVG(MOP_LT2_R_CL_ACC        ) AS AVG_MOP_LT2_R_CL_ACC        ,
AVG(MOP_LT2_R_OP_ACC        ) AS AVG_MOP_LT2_R_OP_ACC        ,
AVG(MOP_LT2_R               ) AS AVG_MOP_LT2_R               ,
AVG(MOP_LT2_CL_ACC          ) AS AVG_MOP_LT2_CL_ACC          ,
AVG(MOP_LT2_OP_ACC          ) AS AVG_MOP_LT2_OP_ACC          ,

COUNT(MOP_LT2_BK_AU_CL_ACC  ) AS NUM_MOP_LT2_BK_AU_CL_ACC  ,
COUNT(MOP_LT2_BK_AU_OP_ACC  ) AS NUM_MOP_LT2_BK_AU_OP_ACC  ,
COUNT(MOP_LT2_BK_AU         ) AS NUM_MOP_LT2_BK_AU         ,
COUNT(MOP_LT2_BK_M_CL_ACC   ) AS NUM_MOP_LT2_BK_M_CL_ACC   ,
COUNT(MOP_LT2_BK_M_OP_ACC   ) AS NUM_MOP_LT2_BK_M_OP_ACC   ,
COUNT(MOP_LT2_BK_M          ) AS NUM_MOP_LT2_BK_M          ,
COUNT(MOP_LT2_BK_PL_CL_ACC  ) AS NUM_MOP_LT2_BK_PL_CL_ACC  ,
COUNT(MOP_LT2_BK_PL_OP_ACC  ) AS NUM_MOP_LT2_BK_PL_OP_ACC  ,
COUNT(MOP_LT2_BK_PL         ) AS NUM_MOP_LT2_BK_PL         ,
COUNT(MOP_LT2_BK_R_CL_ACC   ) AS NUM_MOP_LT2_BK_R_CL_ACC   ,
COUNT(MOP_LT2_BK_R_OP_ACC   ) AS NUM_MOP_LT2_BK_R_OP_ACC   ,
COUNT(MOP_LT2_BK_R          ) AS NUM_MOP_LT2_BK_R          ,
COUNT(MOP_LT2_BK_CL_ACC     ) AS NUM_MOP_LT2_BK_CL_ACC     ,
COUNT(MOP_LT2_BK_OP_ACC     ) AS NUM_MOP_LT2_BK_OP_ACC     ,
COUNT(MOP_LT2_BK            ) AS NUM_MOP_LT2_BK            ,
COUNT(MOP_LT2_NBK_AU_CL_ACC ) AS NUM_MOP_LT2_NBK_AU_CL_ACC ,
COUNT(MOP_LT2_NBK_AU_OP_ACC ) AS NUM_MOP_LT2_NBK_AU_OP_ACC ,
COUNT(MOP_LT2_NBK_AU        ) AS NUM_MOP_LT2_NBK_AU        ,
COUNT(MOP_LT2_NBK_M_CL_ACC  ) AS NUM_MOP_LT2_NBK_M_CL_ACC  ,
COUNT(MOP_LT2_NBK_M_OP_ACC  ) AS NUM_MOP_LT2_NBK_M_OP_ACC  ,
COUNT(MOP_LT2_NBK_M         ) AS NUM_MOP_LT2_NBK_M         ,
COUNT(MOP_LT2_NBK_PL_CL_ACC ) AS NUM_MOP_LT2_NBK_PL_CL_ACC ,
COUNT(MOP_LT2_NBK_PL_OP_ACC ) AS NUM_MOP_LT2_NBK_PL_OP_ACC ,
COUNT(MOP_LT2_NBK_PL        ) AS NUM_MOP_LT2_NBK_PL        ,
COUNT(MOP_LT2_NBK_R_CL_ACC  ) AS NUM_MOP_LT2_NBK_R_CL_ACC  ,
COUNT(MOP_LT2_NBK_R_OP_ACC  ) AS NUM_MOP_LT2_NBK_R_OP_ACC  ,
COUNT(MOP_LT2_NBK_R         ) AS NUM_MOP_LT2_NBK_R         ,
COUNT(MOP_LT2_NBK_CL_ACC    ) AS NUM_MOP_LT2_NBK_CL_ACC    ,
COUNT(MOP_LT2_NBK_OP_ACC    ) AS NUM_MOP_LT2_NBK_OP_ACC    ,
COUNT(MOP_LT2_NBK           ) AS NUM_MOP_LT2_NBK           ,
COUNT(MOP_LT2_AMX_CL_ACC    ) AS NUM_MOP_LT2_AMX_CL_ACC    ,
COUNT(MOP_LT2_AMX_OP_ACC    ) AS NUM_MOP_LT2_AMX_OP_ACC    ,
COUNT(MOP_LT2_AMX           ) AS NUM_MOP_LT2_AMX           ,
COUNT(MOP_LT2_AU_CL_ACC     ) AS NUM_MOP_LT2_AU_CL_ACC     ,
COUNT(MOP_LT2_AU_OP_ACC     ) AS NUM_MOP_LT2_AU_OP_ACC     ,
COUNT(MOP_LT2_AU            ) AS NUM_MOP_LT2_AU            ,
COUNT(MOP_LT2_M_CL_ACC      ) AS NUM_MOP_LT2_M_CL_ACC      ,
COUNT(MOP_LT2_M_OP_ACC      ) AS NUM_MOP_LT2_M_OP_ACC      ,
COUNT(MOP_LT2_M             ) AS NUM_MOP_LT2_M             ,
COUNT(MOP_LT2_PL_CL_ACC     ) AS NUM_MOP_LT2_PL_CL_ACC     ,
COUNT(MOP_LT2_PL_OP_ACC     ) AS NUM_MOP_LT2_PL_OP_ACC     ,
COUNT(MOP_LT2_PL            ) AS NUM_MOP_LT2_PL            ,
COUNT(MOP_LT2_R_CL_ACC      ) AS NUM_MOP_LT2_R_CL_ACC      ,
COUNT(MOP_LT2_R_OP_ACC      ) AS NUM_MOP_LT2_R_OP_ACC      ,
COUNT(MOP_LT2_R             ) AS NUM_MOP_LT2_R             ,
COUNT(MOP_LT2_CL_ACC        ) AS NUM_MOP_LT2_CL_ACC        ,
COUNT(MOP_LT2_OP_ACC        ) AS NUM_MOP_LT2_OP_ACC        ,
                                                  
MAX(MOP_LT2_BK_AU_CL_ACC    ) AS MAX_MOP_LT2_BK_AU_CL_ACC  ,
MAX(MOP_LT2_BK_AU_OP_ACC    ) AS MAX_MOP_LT2_BK_AU_OP_ACC  ,
MAX(MOP_LT2_BK_AU           ) AS MAX_MOP_LT2_BK_AU         ,
MAX(MOP_LT2_BK_M_CL_ACC     ) AS MAX_MOP_LT2_BK_M_CL_ACC   ,
MAX(MOP_LT2_BK_M_OP_ACC     ) AS MAX_MOP_LT2_BK_M_OP_ACC   ,
MAX(MOP_LT2_BK_M            ) AS MAX_MOP_LT2_BK_M          ,
MAX(MOP_LT2_BK_PL_CL_ACC    ) AS MAX_MOP_LT2_BK_PL_CL_ACC  ,
MAX(MOP_LT2_BK_PL_OP_ACC    ) AS MAX_MOP_LT2_BK_PL_OP_ACC  ,
MAX(MOP_LT2_BK_PL           ) AS MAX_MOP_LT2_BK_PL         ,
MAX(MOP_LT2_BK_R_CL_ACC     ) AS MAX_MOP_LT2_BK_R_CL_ACC   ,
MAX(MOP_LT2_BK_R_OP_ACC     ) AS MAX_MOP_LT2_BK_R_OP_ACC   ,
MAX(MOP_LT2_BK_R            ) AS MAX_MOP_LT2_BK_R          ,
MAX(MOP_LT2_BK_CL_ACC       ) AS MAX_MOP_LT2_BK_CL_ACC     ,
MAX(MOP_LT2_BK_OP_ACC       ) AS MAX_MOP_LT2_BK_OP_ACC     ,
MAX(MOP_LT2_BK              ) AS MAX_MOP_LT2_BK            ,
MAX(MOP_LT2_NBK_AU_CL_ACC   ) AS MAX_MOP_LT2_NBK_AU_CL_ACC ,
MAX(MOP_LT2_NBK_AU_OP_ACC   ) AS MAX_MOP_LT2_NBK_AU_OP_ACC ,
MAX(MOP_LT2_NBK_AU          ) AS MAX_MOP_LT2_NBK_AU        ,
MAX(MOP_LT2_NBK_M_CL_ACC    ) AS MAX_MOP_LT2_NBK_M_CL_ACC  ,
MAX(MOP_LT2_NBK_M_OP_ACC    ) AS MAX_MOP_LT2_NBK_M_OP_ACC  ,
MAX(MOP_LT2_NBK_M           ) AS MAX_MOP_LT2_NBK_M         ,
MAX(MOP_LT2_NBK_PL_CL_ACC   ) AS MAX_MOP_LT2_NBK_PL_CL_ACC ,
MAX(MOP_LT2_NBK_PL_OP_ACC   ) AS MAX_MOP_LT2_NBK_PL_OP_ACC ,
MAX(MOP_LT2_NBK_PL          ) AS MAX_MOP_LT2_NBK_PL        ,
MAX(MOP_LT2_NBK_R_CL_ACC    ) AS MAX_MOP_LT2_NBK_R_CL_ACC  ,
MAX(MOP_LT2_NBK_R_OP_ACC    ) AS MAX_MOP_LT2_NBK_R_OP_ACC  ,
MAX(MOP_LT2_NBK_R           ) AS MAX_MOP_LT2_NBK_R         ,
MAX(MOP_LT2_NBK_CL_ACC      ) AS MAX_MOP_LT2_NBK_CL_ACC    ,
MAX(MOP_LT2_NBK_OP_ACC      ) AS MAX_MOP_LT2_NBK_OP_ACC    ,
MAX(MOP_LT2_NBK             ) AS MAX_MOP_LT2_NBK           ,
MAX(MOP_LT2_AMX_CL_ACC      ) AS MAX_MOP_LT2_AMX_CL_ACC    ,
MAX(MOP_LT2_AMX_OP_ACC      ) AS MAX_MOP_LT2_AMX_OP_ACC    ,
MAX(MOP_LT2_AMX             ) AS MAX_MOP_LT2_AMX           ,
MAX(MOP_LT2_AU_CL_ACC       ) AS MAX_MOP_LT2_AU_CL_ACC     ,
MAX(MOP_LT2_AU_OP_ACC       ) AS MAX_MOP_LT2_AU_OP_ACC     ,
MAX(MOP_LT2_AU              ) AS MAX_MOP_LT2_AU            ,
MAX(MOP_LT2_M_CL_ACC        ) AS MAX_MOP_LT2_M_CL_ACC      ,
MAX(MOP_LT2_M_OP_ACC        ) AS MAX_MOP_LT2_M_OP_ACC      ,
MAX(MOP_LT2_M               ) AS MAX_MOP_LT2_M             ,
MAX(MOP_LT2_PL_CL_ACC       ) AS MAX_MOP_LT2_PL_CL_ACC     ,
MAX(MOP_LT2_PL_OP_ACC       ) AS MAX_MOP_LT2_PL_OP_ACC     ,
MAX(MOP_LT2_PL              ) AS MAX_MOP_LT2_PL            ,
MAX(MOP_LT2_R_CL_ACC        ) AS MAX_MOP_LT2_R_CL_ACC      ,
MAX(MOP_LT2_R_OP_ACC        ) AS MAX_MOP_LT2_R_OP_ACC      ,
MAX(MOP_LT2_R               ) AS MAX_MOP_LT2_R             ,
MAX(MOP_LT2_CL_ACC          ) AS MAX_MOP_LT2_CL_ACC        ,
MAX(MOP_LT2_OP_ACC          ) AS MAX_MOP_LT2_OP_ACC        ,

MIN(MOP_LT2_BK_AU_CL_ACC    ) AS MIN_MOP_LT2_BK_AU_CL_ACC  ,
MIN(MOP_LT2_BK_AU_OP_ACC    ) AS MIN_MOP_LT2_BK_AU_OP_ACC  ,
MIN(MOP_LT2_BK_AU           ) AS MIN_MOP_LT2_BK_AU         ,
MIN(MOP_LT2_BK_M_CL_ACC     ) AS MIN_MOP_LT2_BK_M_CL_ACC   ,
MIN(MOP_LT2_BK_M_OP_ACC     ) AS MIN_MOP_LT2_BK_M_OP_ACC   ,
MIN(MOP_LT2_BK_M            ) AS MIN_MOP_LT2_BK_M          ,
MIN(MOP_LT2_BK_PL_CL_ACC    ) AS MIN_MOP_LT2_BK_PL_CL_ACC  ,
MIN(MOP_LT2_BK_PL_OP_ACC    ) AS MIN_MOP_LT2_BK_PL_OP_ACC  ,
MIN(MOP_LT2_BK_PL           ) AS MIN_MOP_LT2_BK_PL         ,
MIN(MOP_LT2_BK_R_CL_ACC     ) AS MIN_MOP_LT2_BK_R_CL_ACC   ,
MIN(MOP_LT2_BK_R_OP_ACC     ) AS MIN_MOP_LT2_BK_R_OP_ACC   ,
MIN(MOP_LT2_BK_R            ) AS MIN_MOP_LT2_BK_R          ,
MIN(MOP_LT2_BK_CL_ACC       ) AS MIN_MOP_LT2_BK_CL_ACC     ,
MIN(MOP_LT2_BK_OP_ACC       ) AS MIN_MOP_LT2_BK_OP_ACC     ,
MIN(MOP_LT2_BK              ) AS MIN_MOP_LT2_BK            ,
MIN(MOP_LT2_NBK_AU_CL_ACC   ) AS MIN_MOP_LT2_NBK_AU_CL_ACC ,
MIN(MOP_LT2_NBK_AU_OP_ACC   ) AS MIN_MOP_LT2_NBK_AU_OP_ACC ,
MIN(MOP_LT2_NBK_AU          ) AS MIN_MOP_LT2_NBK_AU        ,
MIN(MOP_LT2_NBK_M_CL_ACC    ) AS MIN_MOP_LT2_NBK_M_CL_ACC  ,
MIN(MOP_LT2_NBK_M_OP_ACC    ) AS MIN_MOP_LT2_NBK_M_OP_ACC  ,
MIN(MOP_LT2_NBK_M           ) AS MIN_MOP_LT2_NBK_M         ,
MIN(MOP_LT2_NBK_PL_CL_ACC   ) AS MIN_MOP_LT2_NBK_PL_CL_ACC ,
MIN(MOP_LT2_NBK_PL_OP_ACC   ) AS MIN_MOP_LT2_NBK_PL_OP_ACC ,
MIN(MOP_LT2_NBK_PL          ) AS MIN_MOP_LT2_NBK_PL        ,
MIN(MOP_LT2_NBK_R_CL_ACC    ) AS MIN_MOP_LT2_NBK_R_CL_ACC  ,
MIN(MOP_LT2_NBK_R_OP_ACC    ) AS MIN_MOP_LT2_NBK_R_OP_ACC  ,
MIN(MOP_LT2_NBK_R           ) AS MIN_MOP_LT2_NBK_R         ,
MIN(MOP_LT2_NBK_CL_ACC      ) AS MIN_MOP_LT2_NBK_CL_ACC    ,
MIN(MOP_LT2_NBK_OP_ACC      ) AS MIN_MOP_LT2_NBK_OP_ACC    ,
MIN(MOP_LT2_NBK             ) AS MIN_MOP_LT2_NBK           ,
MIN(MOP_LT2_AMX_CL_ACC      ) AS MIN_MOP_LT2_AMX_CL_ACC    ,
MIN(MOP_LT2_AMX_OP_ACC      ) AS MIN_MOP_LT2_AMX_OP_ACC    ,
MIN(MOP_LT2_AMX             ) AS MIN_MOP_LT2_AMX           ,
MIN(MOP_LT2_AU_CL_ACC       ) AS MIN_MOP_LT2_AU_CL_ACC     ,
MIN(MOP_LT2_AU_OP_ACC       ) AS MIN_MOP_LT2_AU_OP_ACC     ,
MIN(MOP_LT2_AU              ) AS MIN_MOP_LT2_AU            ,
MIN(MOP_LT2_M_CL_ACC        ) AS MIN_MOP_LT2_M_CL_ACC      ,
MIN(MOP_LT2_M_OP_ACC        ) AS MIN_MOP_LT2_M_OP_ACC      ,
MIN(MOP_LT2_M               ) AS MIN_MOP_LT2_M             ,
MIN(MOP_LT2_PL_CL_ACC       ) AS MIN_MOP_LT2_PL_CL_ACC     ,
MIN(MOP_LT2_PL_OP_ACC       ) AS MIN_MOP_LT2_PL_OP_ACC     ,
MIN(MOP_LT2_PL              ) AS MIN_MOP_LT2_PL            ,
MIN(MOP_LT2_R_CL_ACC        ) AS MIN_MOP_LT2_R_CL_ACC      ,
MIN(MOP_LT2_R_OP_ACC        ) AS MIN_MOP_LT2_R_OP_ACC      ,
MIN(MOP_LT2_R               ) AS MIN_MOP_LT2_R             ,
MIN(MOP_LT2_CL_ACC          ) AS MIN_MOP_LT2_CL_ACC        ,
MIN(MOP_LT2_OP_ACC          ) AS MIN_MOP_LT2_OP_ACC        ,

MAX(MOP_LT2_BK_AU_CL_ACC ) - MIN(MOP_LT2_BK_AU_CL_ACC  )  AS DIF_MOP_LT2_BK_AU_CL_ACC  ,
MAX(MOP_LT2_BK_AU_OP_ACC ) - MIN(MOP_LT2_BK_AU_OP_ACC  )  AS DIF_MOP_LT2_BK_AU_OP_ACC  ,
MAX(MOP_LT2_BK_AU        ) - MIN(MOP_LT2_BK_AU         )  AS DIF_MOP_LT2_BK_AU         ,
MAX(MOP_LT2_BK_M_CL_ACC  ) - MIN(MOP_LT2_BK_M_CL_ACC   )  AS DIF_MOP_LT2_BK_M_CL_ACC   ,
MAX(MOP_LT2_BK_M_OP_ACC  ) - MIN(MOP_LT2_BK_M_OP_ACC   )  AS DIF_MOP_LT2_BK_M_OP_ACC   ,
MAX(MOP_LT2_BK_M         ) - MIN(MOP_LT2_BK_M          )  AS DIF_MOP_LT2_BK_M          ,
MAX(MOP_LT2_BK_PL_CL_ACC ) - MIN(MOP_LT2_BK_PL_CL_ACC  )  AS DIF_MOP_LT2_BK_PL_CL_ACC  ,
MAX(MOP_LT2_BK_PL_OP_ACC ) - MIN(MOP_LT2_BK_PL_OP_ACC  )  AS DIF_MOP_LT2_BK_PL_OP_ACC  ,
MAX(MOP_LT2_BK_PL        ) - MIN(MOP_LT2_BK_PL         )  AS DIF_MOP_LT2_BK_PL         ,
MAX(MOP_LT2_BK_R_CL_ACC  ) - MIN(MOP_LT2_BK_R_CL_ACC   )  AS DIF_MOP_LT2_BK_R_CL_ACC   ,
MAX(MOP_LT2_BK_R_OP_ACC  ) - MIN(MOP_LT2_BK_R_OP_ACC   )  AS DIF_MOP_LT2_BK_R_OP_ACC   ,
MAX(MOP_LT2_BK_R         ) - MIN(MOP_LT2_BK_R          )  AS DIF_MOP_LT2_BK_R          ,
MAX(MOP_LT2_BK_CL_ACC    ) - MIN(MOP_LT2_BK_CL_ACC     )  AS DIF_MOP_LT2_BK_CL_ACC     ,
MAX(MOP_LT2_BK_OP_ACC    ) - MIN(MOP_LT2_BK_OP_ACC     )  AS DIF_MOP_LT2_BK_OP_ACC     ,
MAX(MOP_LT2_BK           ) - MIN(MOP_LT2_BK            )  AS DIF_MOP_LT2_BK            ,
MAX(MOP_LT2_NBK_AU_CL_ACC) - MIN(MOP_LT2_NBK_AU_CL_ACC )  AS DIF_MOP_LT2_NBK_AU_CL_ACC ,
MAX(MOP_LT2_NBK_AU_OP_ACC) - MIN(MOP_LT2_NBK_AU_OP_ACC )  AS DIF_MOP_LT2_NBK_AU_OP_ACC ,
MAX(MOP_LT2_NBK_AU       ) - MIN(MOP_LT2_NBK_AU        )  AS DIF_MOP_LT2_NBK_AU        ,
MAX(MOP_LT2_NBK_M_CL_ACC ) - MIN(MOP_LT2_NBK_M_CL_ACC  )  AS DIF_MOP_LT2_NBK_M_CL_ACC  ,
MAX(MOP_LT2_NBK_M_OP_ACC ) - MIN(MOP_LT2_NBK_M_OP_ACC  )  AS DIF_MOP_LT2_NBK_M_OP_ACC  ,
MAX(MOP_LT2_NBK_M        ) - MIN(MOP_LT2_NBK_M         )  AS DIF_MOP_LT2_NBK_M         ,
MAX(MOP_LT2_NBK_PL_CL_ACC) - MIN(MOP_LT2_NBK_PL_CL_ACC )  AS DIF_MOP_LT2_NBK_PL_CL_ACC ,
MAX(MOP_LT2_NBK_PL_OP_ACC) - MIN(MOP_LT2_NBK_PL_OP_ACC )  AS DIF_MOP_LT2_NBK_PL_OP_ACC ,
MAX(MOP_LT2_NBK_PL       ) - MIN(MOP_LT2_NBK_PL        )  AS DIF_MOP_LT2_NBK_PL        ,
MAX(MOP_LT2_NBK_R_CL_ACC ) - MIN(MOP_LT2_NBK_R_CL_ACC  )  AS DIF_MOP_LT2_NBK_R_CL_ACC  ,
MAX(MOP_LT2_NBK_R_OP_ACC ) - MIN(MOP_LT2_NBK_R_OP_ACC  )  AS DIF_MOP_LT2_NBK_R_OP_ACC  ,
MAX(MOP_LT2_NBK_R        ) - MIN(MOP_LT2_NBK_R         )  AS DIF_MOP_LT2_NBK_R         ,
MAX(MOP_LT2_NBK_CL_ACC   ) - MIN(MOP_LT2_NBK_CL_ACC    )  AS DIF_MOP_LT2_NBK_CL_ACC    ,
MAX(MOP_LT2_NBK_OP_ACC   ) - MIN(MOP_LT2_NBK_OP_ACC    )  AS DIF_MOP_LT2_NBK_OP_ACC    ,
MAX(MOP_LT2_NBK          ) - MIN(MOP_LT2_NBK           )  AS DIF_MOP_LT2_NBK           ,
MAX(MOP_LT2_AMX_CL_ACC   ) - MIN(MOP_LT2_AMX_CL_ACC    )  AS DIF_MOP_LT2_AMX_CL_ACC    ,
MAX(MOP_LT2_AMX_OP_ACC   ) - MIN(MOP_LT2_AMX_OP_ACC    )  AS DIF_MOP_LT2_AMX_OP_ACC    ,
MAX(MOP_LT2_AMX          ) - MIN(MOP_LT2_AMX           )  AS DIF_MOP_LT2_AMX           ,
MAX(MOP_LT2_AU_CL_ACC    ) - MIN(MOP_LT2_AU_CL_ACC     )  AS DIF_MOP_LT2_AU_CL_ACC     ,
MAX(MOP_LT2_AU_OP_ACC    ) - MIN(MOP_LT2_AU_OP_ACC     )  AS DIF_MOP_LT2_AU_OP_ACC     ,
MAX(MOP_LT2_AU           ) - MIN(MOP_LT2_AU            )  AS DIF_MOP_LT2_AU            ,
MAX(MOP_LT2_M_CL_ACC     ) - MIN(MOP_LT2_M_CL_ACC      )  AS DIF_MOP_LT2_M_CL_ACC      ,
MAX(MOP_LT2_M_OP_ACC     ) - MIN(MOP_LT2_M_OP_ACC      )  AS DIF_MOP_LT2_M_OP_ACC      ,
MAX(MOP_LT2_M            ) - MIN(MOP_LT2_M             )  AS DIF_MOP_LT2_M             ,
MAX(MOP_LT2_PL_CL_ACC    ) - MIN(MOP_LT2_PL_CL_ACC     )  AS DIF_MOP_LT2_PL_CL_ACC     ,
MAX(MOP_LT2_PL_OP_ACC    ) - MIN(MOP_LT2_PL_OP_ACC     )  AS DIF_MOP_LT2_PL_OP_ACC     ,
MAX(MOP_LT2_PL           ) - MIN(MOP_LT2_PL            )  AS DIF_MOP_LT2_PL            ,
MAX(MOP_LT2_R_CL_ACC     ) - MIN(MOP_LT2_R_CL_ACC      )  AS DIF_MOP_LT2_R_CL_ACC      ,
MAX(MOP_LT2_R_OP_ACC     ) - MIN(MOP_LT2_R_OP_ACC      )  AS DIF_MOP_LT2_R_OP_ACC      ,
MAX(MOP_LT2_R            ) - MIN(MOP_LT2_R             )  AS DIF_MOP_LT2_R             ,
MAX(MOP_LT2_CL_ACC       ) - MIN(MOP_LT2_CL_ACC        )  AS DIF_MOP_LT2_CL_ACC        ,
MAX(MOP_LT2_OP_ACC       ) - MIN(MOP_LT2_OP_ACC        )  AS DIF_MOP_LT2_OP_ACC        ,

SUM(MOP_LT2_BK_AU_CL_ACC ) AS SUM_MOP_LT2_BK_AU_CL_ACC    ,
SUM(MOP_LT2_BK_AU_OP_ACC ) AS SUM_MOP_LT2_BK_AU_OP_ACC    ,
SUM(MOP_LT2_BK_AU        ) AS SUM_MOP_LT2_BK_AU           ,
SUM(MOP_LT2_BK_M_CL_ACC  ) AS SUM_MOP_LT2_BK_M_CL_ACC     ,
SUM(MOP_LT2_BK_M_OP_ACC  ) AS SUM_MOP_LT2_BK_M_OP_ACC     ,
SUM(MOP_LT2_BK_M         ) AS SUM_MOP_LT2_BK_M            ,
SUM(MOP_LT2_BK_PL_CL_ACC ) AS SUM_MOP_LT2_BK_PL_CL_ACC    ,
SUM(MOP_LT2_BK_PL_OP_ACC ) AS SUM_MOP_LT2_BK_PL_OP_ACC    ,
SUM(MOP_LT2_BK_PL        ) AS SUM_MOP_LT2_BK_PL           ,
SUM(MOP_LT2_BK_R_CL_ACC  ) AS SUM_MOP_LT2_BK_R_CL_ACC     ,
SUM(MOP_LT2_BK_R_OP_ACC  ) AS SUM_MOP_LT2_BK_R_OP_ACC     ,
SUM(MOP_LT2_BK_R         ) AS SUM_MOP_LT2_BK_R            ,
SUM(MOP_LT2_BK_CL_ACC    ) AS SUM_MOP_LT2_BK_CL_ACC       ,
SUM(MOP_LT2_BK_OP_ACC    ) AS SUM_MOP_LT2_BK_OP_ACC       ,
SUM(MOP_LT2_BK           ) AS SUM_MOP_LT2_BK              ,
SUM(MOP_LT2_NBK_AU_CL_ACC) AS SUM_MOP_LT2_NBK_AU_CL_ACC   ,
SUM(MOP_LT2_NBK_AU_OP_ACC) AS SUM_MOP_LT2_NBK_AU_OP_ACC   ,
SUM(MOP_LT2_NBK_AU       ) AS SUM_MOP_LT2_NBK_AU          ,
SUM(MOP_LT2_NBK_M_CL_ACC ) AS SUM_MOP_LT2_NBK_M_CL_ACC    ,
SUM(MOP_LT2_NBK_M_OP_ACC ) AS SUM_MOP_LT2_NBK_M_OP_ACC    ,
SUM(MOP_LT2_NBK_M        ) AS SUM_MOP_LT2_NBK_M           ,
SUM(MOP_LT2_NBK_PL_CL_ACC) AS SUM_MOP_LT2_NBK_PL_CL_ACC   ,
SUM(MOP_LT2_NBK_PL_OP_ACC) AS SUM_MOP_LT2_NBK_PL_OP_ACC   ,
SUM(MOP_LT2_NBK_PL       ) AS SUM_MOP_LT2_NBK_PL          ,
SUM(MOP_LT2_NBK_R_CL_ACC ) AS SUM_MOP_LT2_NBK_R_CL_ACC    ,
SUM(MOP_LT2_NBK_R_OP_ACC ) AS SUM_MOP_LT2_NBK_R_OP_ACC    ,
SUM(MOP_LT2_NBK_R        ) AS SUM_MOP_LT2_NBK_R           ,
SUM(MOP_LT2_NBK_CL_ACC   ) AS SUM_MOP_LT2_NBK_CL_ACC      ,
SUM(MOP_LT2_NBK_OP_ACC   ) AS SUM_MOP_LT2_NBK_OP_ACC      ,
SUM(MOP_LT2_NBK          ) AS SUM_MOP_LT2_NBK             ,
SUM(MOP_LT2_AMX_CL_ACC   ) AS SUM_MOP_LT2_AMX_CL_ACC      ,
SUM(MOP_LT2_AMX_OP_ACC   ) AS SUM_MOP_LT2_AMX_OP_ACC      ,
SUM(MOP_LT2_AMX          ) AS SUM_MOP_LT2_AMX             ,
SUM(MOP_LT2_AU_CL_ACC    ) AS SUM_MOP_LT2_AU_CL_ACC       ,
SUM(MOP_LT2_AU_OP_ACC    ) AS SUM_MOP_LT2_AU_OP_ACC       ,
SUM(MOP_LT2_AU           ) AS SUM_MOP_LT2_AU              ,
SUM(MOP_LT2_M_CL_ACC     ) AS SUM_MOP_LT2_M_CL_ACC        ,
SUM(MOP_LT2_M_OP_ACC     ) AS SUM_MOP_LT2_M_OP_ACC        ,
SUM(MOP_LT2_M            ) AS SUM_MOP_LT2_M               ,
SUM(MOP_LT2_PL_CL_ACC    ) AS SUM_MOP_LT2_PL_CL_ACC       ,
SUM(MOP_LT2_PL_OP_ACC    ) AS SUM_MOP_LT2_PL_OP_ACC       ,
SUM(MOP_LT2_PL           ) AS SUM_MOP_LT2_PL              ,
SUM(MOP_LT2_R_CL_ACC     ) AS SUM_MOP_LT2_R_CL_ACC        ,
SUM(MOP_LT2_R_OP_ACC     ) AS SUM_MOP_LT2_R_OP_ACC        ,
SUM(MOP_LT2_R            ) AS SUM_MOP_LT2_R               ,
SUM(MOP_LT2_CL_ACC       ) AS SUM_MOP_LT2_CL_ACC          ,
SUM(MOP_LT2_OP_ACC       ) AS SUM_MOP_LT2_OP_ACC          ,

--  COMUNICACIONES Y SERVICIOS

COUNT(MOP_LT2_TU_ALL        ) AS NUM_MOP_LT2_TU_ALL        ,
COUNT(MOP_LT2_TU            ) AS NUM_MOP_LT2_TU            ,
COUNT(MOP_LT2_TU_ALL_OP_ACC ) AS NUM_MOP_LT2_TU_ALL_OP_ACC ,
COUNT(MOP_LT2_TU_OP_ACC     ) AS NUM_MOP_LT2_TU_OP_ACC     ,
COUNT(MOP_LT2_TU_ALL_CL_ACC ) AS NUM_MOP_LT2_TU_ALL_CL_ACC ,
COUNT(MOP_LT2_TU_CL_ACC     ) AS NUM_MOP_LT2_TU_CL_ACC     ,
COUNT(MOP_LT2_NBK_TU        ) AS NUM_MOP_LT2_NBK_TU        ,
COUNT(MOP_LT2_NBK_TU_OP_ACC ) AS NUM_MOP_LT2_NBK_TU_OP_ACC ,
COUNT(MOP_LT2_NBK_TU_CL_ACC ) AS NUM_MOP_LT2_NBK_TU_CL_ACC ,

MAX(MOP_LT2_TU_ALL        ) AS MAX_MOP_LT2_TU_ALL        ,
MAX(MOP_LT2_TU            ) AS MAX_MOP_LT2_TU            ,
MAX(MOP_LT2_TU_ALL_OP_ACC ) AS MAX_MOP_LT2_TU_ALL_OP_ACC ,
MAX(MOP_LT2_TU_OP_ACC     ) AS MAX_MOP_LT2_TU_OP_ACC     ,
MAX(MOP_LT2_TU_ALL_CL_ACC ) AS MAX_MOP_LT2_TU_ALL_CL_ACC ,
MAX(MOP_LT2_TU_CL_ACC     ) AS MAX_MOP_LT2_TU_CL_ACC     ,
MAX(MOP_LT2_NBK_TU        ) AS MAX_MOP_LT2_NBK_TU        ,
MAX(MOP_LT2_NBK_TU_OP_ACC ) AS MAX_MOP_LT2_NBK_TU_OP_ACC ,
MAX(MOP_LT2_NBK_TU_CL_ACC ) AS MAX_MOP_LT2_NBK_TU_CL_ACC ,

MIN(MOP_LT2_TU_ALL        ) AS MIN_MOP_LT2_TU_ALL        ,
MIN(MOP_LT2_TU            ) AS MIN_MOP_LT2_TU            ,
MIN(MOP_LT2_TU_ALL_OP_ACC ) AS MIN_MOP_LT2_TU_ALL_OP_ACC ,
MIN(MOP_LT2_TU_OP_ACC     ) AS MIN_MOP_LT2_TU_OP_ACC     ,
MIN(MOP_LT2_TU_ALL_CL_ACC ) AS MIN_MOP_LT2_TU_ALL_CL_ACC ,
MIN(MOP_LT2_TU_CL_ACC     ) AS MIN_MOP_LT2_TU_CL_ACC     ,
MIN(MOP_LT2_NBK_TU        ) AS MIN_MOP_LT2_NBK_TU        ,
MIN(MOP_LT2_NBK_TU_OP_ACC ) AS MIN_MOP_LT2_NBK_TU_OP_ACC ,
MIN(MOP_LT2_NBK_TU_CL_ACC ) AS MIN_MOP_LT2_NBK_TU_CL_ACC ,

MAX(MOP_LT2_TU_ALL        ) - MIN(MOP_LT2_TU_ALL       ) AS  DIF_MOP_LT2_TU_ALL        ,
MAX(MOP_LT2_TU            ) - MIN(MOP_LT2_TU           ) AS  DIF_MOP_LT2_TU            ,
MAX(MOP_LT2_TU_ALL_OP_ACC ) - MIN(MOP_LT2_TU_ALL_OP_ACC) AS  DIF_MOP_LT2_TU_ALL_OP_ACC ,
MAX(MOP_LT2_TU_OP_ACC     ) - MIN(MOP_LT2_TU_OP_ACC    ) AS  DIF_MOP_LT2_TU_OP_ACC     ,
MAX(MOP_LT2_TU_ALL_CL_ACC ) - MIN(MOP_LT2_TU_ALL_CL_ACC) AS  DIF_MOP_LT2_TU_ALL_CL_ACC ,
MAX(MOP_LT2_TU_CL_ACC     ) - MIN(MOP_LT2_TU_CL_ACC    ) AS  DIF_MOP_LT2_TU_CL_ACC     ,
MAX(MOP_LT2_NBK_TU        ) - MIN(MOP_LT2_NBK_TU       ) AS  DIF_MOP_LT2_NBK_TU        ,
MAX(MOP_LT2_NBK_TU_OP_ACC ) - MIN(MOP_LT2_NBK_TU_OP_ACC) AS  DIF_MOP_LT2_NBK_TU_OP_ACC ,
MAX(MOP_LT2_NBK_TU_CL_ACC ) - MIN(MOP_LT2_NBK_TU_CL_ACC) AS  DIF_MOP_LT2_NBK_TU_CL_ACC ,
	
SUM(MOP_LT2_TU_ALL        )  AS SUM_MOP_LT2_TU_ALL        ,
SUM(MOP_LT2_TU            )  AS SUM_MOP_LT2_TU            ,
SUM(MOP_LT2_TU_ALL_OP_ACC )  AS SUM_MOP_LT2_TU_ALL_OP_ACC ,
SUM(MOP_LT2_TU_OP_ACC     )  AS SUM_MOP_LT2_TU_OP_ACC     ,
SUM(MOP_LT2_TU_ALL_CL_ACC )  AS SUM_MOP_LT2_TU_ALL_CL_ACC ,
SUM(MOP_LT2_TU_CL_ACC     )  AS SUM_MOP_LT2_TU_CL_ACC     ,
SUM(MOP_LT2_NBK_TU        )  AS SUM_MOP_LT2_NBK_TU        ,-- MOP_LT2_BK_AU_CL_ACC
SUM(MOP_LT2_NBK_TU_CL_ACC )  AS SUM_MOP_LT2_NBK_TU_CL_ACC ,
SUM(MOP_LT2_NBK_TU_OP_ACC )  AS SUM_MOP_LT2_NBK_TU_OP_ACC ,

AVG(MOP_LT2_TU_ALL        ) AS AVG_MOP_LT2_TU_ALL        ,
AVG(MOP_LT2_TU            ) AS AVG_MOP_LT2_TU            ,
AVG(MOP_LT2_TU_ALL_OP_ACC ) AS AVG_MOP_LT2_TU_ALL_OP_ACC ,
AVG(MOP_LT2_TU_OP_ACC     ) AS AVG_MOP_LT2_TU_OP_ACC     ,
AVG(MOP_LT2_TU_ALL_CL_ACC ) AS AVG_MOP_LT2_TU_ALL_CL_ACC ,
AVG(MOP_LT2_TU_CL_ACC     ) AS AVG_MOP_LT2_TU_CL_ACC     ,
AVG(MOP_LT2_NBK_TU        ) AS AVG_MOP_LT2_NBK_TU        ,
AVG(MOP_LT2_NBK_TU_OP_ACC ) AS AVG_MOP_LT2_NBK_TU_OP_ACC ,
AVG(MOP_LT2_NBK_TU_CL_ACC ) AS AVG_MOP_LT2_NBK_TU_CL_ACC 

FROM dbmymwork.BTDC_LGG_VAR_SEGMENTADAS_3
GROUP BY CUENTADEREFERENCIA,
FECHA_CARTERA
;

SELECT * FROM dbmymwork.BTDC_LGG_VAR_MOP_LT2 LIMIT 100;