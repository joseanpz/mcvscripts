%hive

DROP TABLE IF EXISTS dbmymwork.BTDC_LGG_VAR_RESUMEN_IQ;
CREATE TABLE dbmymwork.BTDC_LGG_VAR_RESUMEN_IQ
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/BTDC/VARIABLES/BTDC_LGG_VAR_RESUMEN_IQ' AS

SELECT
CUENTADEREFERENCIA, FECHA_CARTERA,
	SUM(IQ_03M        ) AS  NUM_IQ_03M        ,	
	SUM(IQ_03M_FL     ) AS  NUM_IQ_03M_FL     ,  
	SUM(IQ_03M_BK     ) AS  NUM_IQ_03M_BK     ,  
	SUM(IQ_03M_BK_AU  ) AS  NUM_IQ_03M_BK_AU  ,  
	SUM(IQ_03M_BK_M   ) AS  NUM_IQ_03M_BK_M   ,  
	SUM(IQ_03M_BK_PL  ) AS  NUM_IQ_03M_BK_PL  ,  
	SUM(IQ_03M_BK_R   ) AS  NUM_IQ_03M_BK_R   ,  
	SUM(IQ_03M_NBK    ) AS  NUM_IQ_03M_NBK    ,  
	SUM(IQ_03M_NBK_AU ) AS  NUM_IQ_03M_NBK_AU ,  
	SUM(IQ_03M_NBK_M  ) AS  NUM_IQ_03M_NBK_M  ,  
	SUM(IQ_03M_NBK_PL ) AS  NUM_IQ_03M_NBK_PL ,  
	SUM(IQ_03M_NBK_R  ) AS  NUM_IQ_03M_NBK_R  ,  
	SUM(IQ_03M_AMX    ) AS  NUM_IQ_03M_AMX    ,  
	SUM(IQ_03M_AU     ) AS  NUM_IQ_03M_AU     ,  
	SUM(IQ_03M_M      ) AS  NUM_IQ_03M_M      ,  
	SUM(IQ_03M_PL     ) AS  NUM_IQ_03M_PL     ,  
	SUM(IQ_03M_R      ) AS  NUM_IQ_03M_R      ,  
	
	SUM(IQ_06M        ) AS  NUM_IQ_06M        ,
	SUM(IQ_06M_FL     ) AS  NUM_IQ_06M_FL     ,     
	SUM(IQ_06M_BK     ) AS  NUM_IQ_06M_BK     ,  
	SUM(IQ_06M_BK_AU  ) AS  NUM_IQ_06M_BK_AU  ,  
	SUM(IQ_06M_BK_M   ) AS  NUM_IQ_06M_BK_M   ,  
	SUM(IQ_06M_BK_PL  ) AS  NUM_IQ_06M_BK_PL  ,  
	SUM(IQ_06M_BK_R   ) AS  NUM_IQ_06M_BK_R   ,  
	SUM(IQ_06M_NBK    ) AS  NUM_IQ_06M_NBK    ,  
	SUM(IQ_06M_NBK_AU ) AS  NUM_IQ_06M_NBK_AU ,  
	SUM(IQ_06M_NBK_M  ) AS  NUM_IQ_06M_NBK_M  ,  
	SUM(IQ_06M_NBK_PL ) AS  NUM_IQ_06M_NBK_PL ,  
	SUM(IQ_06M_NBK_R  ) AS  NUM_IQ_06M_NBK_R  ,  
	SUM(IQ_06M_AMX    ) AS  NUM_IQ_06M_AMX    ,  
	SUM(IQ_06M_AU     ) AS  NUM_IQ_06M_AU     ,  
	SUM(IQ_06M_M      ) AS  NUM_IQ_06M_M      ,  
	SUM(IQ_06M_PL     ) AS  NUM_IQ_06M_PL     ,  
	SUM(IQ_06M_R      ) AS  NUM_IQ_06M_R      ,  
	
	SUM(IQ_12M        ) AS  NUM_IQ_12M        ,
	SUM(IQ_12M_FL     ) AS  NUM_IQ_12M_FL     ,     
	SUM(IQ_12M_BK     ) AS  NUM_IQ_12M_BK     ,  
	SUM(IQ_12M_BK_AU  ) AS  NUM_IQ_12M_BK_AU  ,  
	SUM(IQ_12M_BK_M   ) AS  NUM_IQ_12M_BK_M   ,  
	SUM(IQ_12M_BK_PL  ) AS  NUM_IQ_12M_BK_PL  ,  
	SUM(IQ_12M_BK_R   ) AS  NUM_IQ_12M_BK_R   ,  
	SUM(IQ_12M_NBK    ) AS  NUM_IQ_12M_NBK    ,  
	SUM(IQ_12M_NBK_AU ) AS  NUM_IQ_12M_NBK_AU ,  
	SUM(IQ_12M_NBK_M  ) AS  NUM_IQ_12M_NBK_M  ,  
	SUM(IQ_12M_NBK_PL ) AS  NUM_IQ_12M_NBK_PL ,  
	SUM(IQ_12M_NBK_R  ) AS  NUM_IQ_12M_NBK_R  ,  
	SUM(IQ_12M_AMX    ) AS  NUM_IQ_12M_AMX    ,  
	SUM(IQ_12M_AU     ) AS  NUM_IQ_12M_AU     ,  
	SUM(IQ_12M_M      ) AS  NUM_IQ_12M_M      ,  
	SUM(IQ_12M_PL     ) AS  NUM_IQ_12M_PL     ,  
	SUM(IQ_12M_R      ) AS  NUM_IQ_12M_R      ,  
	
	SUM(IQ_18M        ) AS  NUM_IQ_18M        ,
	SUM(IQ_18M_FL     ) AS  NUM_IQ_18M_FL     ,     
	SUM(IQ_18M_BK     ) AS  NUM_IQ_18M_BK     ,  
	SUM(IQ_18M_BK_AU  ) AS  NUM_IQ_18M_BK_AU  ,  
	SUM(IQ_18M_BK_M   ) AS  NUM_IQ_18M_BK_M   ,  
	SUM(IQ_18M_BK_PL  ) AS  NUM_IQ_18M_BK_PL  ,  
	SUM(IQ_18M_BK_R   ) AS  NUM_IQ_18M_BK_R   ,  
	SUM(IQ_18M_NBK    ) AS  NUM_IQ_18M_NBK    ,  
	SUM(IQ_18M_NBK_AU ) AS  NUM_IQ_18M_NBK_AU ,  
	SUM(IQ_18M_NBK_M  ) AS  NUM_IQ_18M_NBK_M  ,  
	SUM(IQ_18M_NBK_PL ) AS  NUM_IQ_18M_NBK_PL ,  
	SUM(IQ_18M_NBK_R  ) AS  NUM_IQ_18M_NBK_R  ,  
	SUM(IQ_18M_AMX    ) AS  NUM_IQ_18M_AMX    ,  
	SUM(IQ_18M_AU     ) AS  NUM_IQ_18M_AU     ,  
	SUM(IQ_18M_M      ) AS  NUM_IQ_18M_M      ,  
	SUM(IQ_18M_PL     ) AS  NUM_IQ_18M_PL     ,  
	SUM(IQ_18M_R      ) AS  NUM_IQ_18M_R      ,  
	
	SUM(IQ_24M        ) AS  NUM_IQ_24M        ,
	SUM(IQ_24M_FL     ) AS  NUM_IQ_24M_FL     ,   
	SUM(IQ_24M_BK     ) AS  NUM_IQ_24M_BK     ,  
	SUM(IQ_24M_BK_AU  ) AS  NUM_IQ_24M_BK_AU  ,  
	SUM(IQ_24M_BK_M   ) AS  NUM_IQ_24M_BK_M   ,  
	SUM(IQ_24M_BK_PL  ) AS  NUM_IQ_24M_BK_PL  ,  
	SUM(IQ_24M_BK_R   ) AS  NUM_IQ_24M_BK_R   ,  
	SUM(IQ_24M_NBK    ) AS  NUM_IQ_24M_NBK    ,  
	SUM(IQ_24M_NBK_AU ) AS  NUM_IQ_24M_NBK_AU ,  
	SUM(IQ_24M_NBK_M  ) AS  NUM_IQ_24M_NBK_M  ,  
	SUM(IQ_24M_NBK_PL ) AS  NUM_IQ_24M_NBK_PL ,  
	SUM(IQ_24M_NBK_R  ) AS  NUM_IQ_24M_NBK_R  ,  
	SUM(IQ_24M_AMX    ) AS  NUM_IQ_24M_AMX    ,  
	SUM(IQ_24M_AU     ) AS  NUM_IQ_24M_AU     ,  
	SUM(IQ_24M_M      ) AS  NUM_IQ_24M_M      ,  
	SUM(IQ_24M_PL     ) AS  NUM_IQ_24M_PL     ,  
	SUM(IQ_24M_R      ) AS  NUM_IQ_24M_R  
	
FROM dbmymwork.BTDC_LGG_VAR_IQ3 
GROUP BY CUENTADEREFERENCIA, FECHA_CARTERA
;

SELECT * FROM dbmymwork.BTDC_LGG_VAR_RESUMEN_IQ LIMIT 100;