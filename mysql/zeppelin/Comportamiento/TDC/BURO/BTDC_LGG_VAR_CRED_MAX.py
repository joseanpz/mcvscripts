%hive
DROP TABLE IF EXISTS dbmymwork.BTDC_LGG_VAR_CRED_MAX;
CREATE TABLE dbmymwork.BTDC_LGG_VAR_CRED_MAX
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/BTDC/VARIABLES/BTDC_LGG_VAR_CRED_MAX' AS
SELECT
CUENTADEREFERENCIA,
FECHA_CARTERA,

SUM(CRED_MAX_BK_AU_CL_ACC   ) AS  SUM_CRED_MAX_BK_AU_CL_ACC   , 
SUM(CRED_MAX_BK_AU_OP_ACC   ) AS  SUM_CRED_MAX_BK_AU_OP_ACC   ,
SUM(CRED_MAX_BK_AU          ) AS  SUM_CRED_MAX_BK_AU          ,
SUM(CRED_MAX_BK_M_CL_ACC    ) AS  SUM_CRED_MAX_BK_M_CL_ACC    ,
SUM(CRED_MAX_BK_M_OP_ACC    ) AS  SUM_CRED_MAX_BK_M_OP_ACC    ,
SUM(CRED_MAX_BK_M           ) AS  SUM_CRED_MAX_BK_M           ,
SUM(CRED_MAX_BK_PL_CL_ACC   ) AS  SUM_CRED_MAX_BK_PL_CL_ACC   ,
SUM(CRED_MAX_BK_PL_OP_ACC   ) AS  SUM_CRED_MAX_BK_PL_OP_ACC   ,
SUM(CRED_MAX_BK_PL          ) AS  SUM_CRED_MAX_BK_PL          ,
SUM(CRED_MAX_BK_R_CL_ACC    ) AS  SUM_CRED_MAX_BK_R_CL_ACC    ,
SUM(CRED_MAX_BK_R_OP_ACC    ) AS  SUM_CRED_MAX_BK_R_OP_ACC    ,
SUM(CRED_MAX_BK_R           ) AS  SUM_CRED_MAX_BK_R           ,
SUM(CRED_MAX_BK_CL_ACC      ) AS  SUM_CRED_MAX_BK_CL_ACC      ,
SUM(CRED_MAX_BK_OP_ACC      ) AS  SUM_CRED_MAX_BK_OP_ACC      ,
SUM(CRED_MAX_BK             ) AS  SUM_CRED_MAX_BK             ,
SUM(CRED_MAX_NBK_AU_CL_ACC  ) AS  SUM_CRED_MAX_NBK_AU_CL_ACC  ,
SUM(CRED_MAX_NBK_AU_OP_ACC  ) AS  SUM_CRED_MAX_NBK_AU_OP_ACC  ,
SUM(CRED_MAX_NBK_AU         ) AS  SUM_CRED_MAX_NBK_AU         ,
SUM(CRED_MAX_NBK_M_CL_ACC   ) AS  SUM_CRED_MAX_NBK_M_CL_ACC   ,
SUM(CRED_MAX_NBK_M_OP_ACC   ) AS  SUM_CRED_MAX_NBK_M_OP_ACC   ,
SUM(CRED_MAX_NBK_M          ) AS  SUM_CRED_MAX_NBK_M          ,
SUM(CRED_MAX_NBK_PL_CL_ACC  ) AS  SUM_CRED_MAX_NBK_PL_CL_ACC  ,
SUM(CRED_MAX_NBK_PL_OP_ACC  ) AS  SUM_CRED_MAX_NBK_PL_OP_ACC  ,
SUM(CRED_MAX_NBK_PL         ) AS  SUM_CRED_MAX_NBK_PL         ,
SUM(CRED_MAX_NBK_R_CL_ACC   ) AS  SUM_CRED_MAX_NBK_R_CL_ACC   ,
SUM(CRED_MAX_NBK_R_OP_ACC   ) AS  SUM_CRED_MAX_NBK_R_OP_ACC   ,
SUM(CRED_MAX_NBK_R          ) AS  SUM_CRED_MAX_NBK_R          ,
SUM(CRED_MAX_NBK_CL_ACC     ) AS  SUM_CRED_MAX_NBK_CL_ACC     ,
SUM(CRED_MAX_NBK_OP_ACC     ) AS  SUM_CRED_MAX_NBK_OP_ACC     ,
SUM(CRED_MAX_NBK            ) AS  SUM_CRED_MAX_NBK            ,
SUM(CRED_MAX_AMX_CL_ACC     ) AS  SUM_CRED_MAX_AMX_CL_ACC     ,
SUM(CRED_MAX_AMX_OP_ACC     ) AS  SUM_CRED_MAX_AMX_OP_ACC     ,
SUM(CRED_MAX_AMX            ) AS  SUM_CRED_MAX_AMX            ,
SUM(CRED_MAX_AU_CL_ACC      ) AS  SUM_CRED_MAX_AU_CL_ACC      ,
SUM(CRED_MAX_AU_OP_ACC      ) AS  SUM_CRED_MAX_AU_OP_ACC      ,
SUM(CRED_MAX_AU             ) AS  SUM_CRED_MAX_AU             ,
SUM(CRED_MAX_M_CL_ACC       ) AS  SUM_CRED_MAX_M_CL_ACC       ,
SUM(CRED_MAX_M_OP_ACC       ) AS  SUM_CRED_MAX_M_OP_ACC       ,
SUM(CRED_MAX_M              ) AS  SUM_CRED_MAX_M              ,
SUM(CRED_MAX_PL_CL_ACC      ) AS  SUM_CRED_MAX_PL_CL_ACC      ,
SUM(CRED_MAX_PL_OP_ACC      ) AS  SUM_CRED_MAX_PL_OP_ACC      ,
SUM(CRED_MAX_PL             ) AS  SUM_CRED_MAX_PL             ,
SUM(CRED_MAX_R_CL_ACC       ) AS  SUM_CRED_MAX_R_CL_ACC       ,
SUM(CRED_MAX_R_OP_ACC       ) AS  SUM_CRED_MAX_R_OP_ACC       ,
SUM(CRED_MAX_R              ) AS  SUM_CRED_MAX_R              ,
SUM(CRED_MAX_CL_ACC         ) AS  SUM_CRED_MAX_CL_ACC         ,
SUM(CRED_MAX_OP_ACC         ) AS  SUM_CRED_MAX_OP_ACC         ,
SUM(CRED_MAX                ) AS  SUM_CRED_MAX                ,
SUM(CRED_MAX_TU_ALL         ) AS  SUM_CRED_MAX_TU_ALL         ,
SUM(CRED_MAX_TU             ) AS  SUM_CRED_MAX_TU             ,
SUM(CRED_MAX_TU_ALL_OP_ACC  ) AS  SUM_CRED_MAX_TU_ALL_OP_ACC  ,
SUM(CRED_MAX_TU_OP_ACC      ) AS  SUM_CRED_MAX_TU_OP_ACC      ,
SUM(CRED_MAX_TU_ALL_CL_ACC  ) AS  SUM_CRED_MAX_TU_ALL_CL_ACC  ,
SUM(CRED_MAX_TU_CL_ACC      ) AS  SUM_CRED_MAX_TU_CL_ACC      ,
SUM(CRED_MAX_NBK_TU         ) AS  SUM_CRED_MAX_NBK_TU         ,
SUM(CRED_MAX_NBK_TU_OP_ACC  ) AS  SUM_CRED_MAX_NBK_TU_OP_ACC  ,
SUM(CRED_MAX_NBK_TU_CL_ACC  ) AS  SUM_CRED_MAX_NBK_TU_CL_ACC  ,

MAX(CRED_MAX_BK_AU_CL_ACC   ) AS  MAX_CRED_MAX_BK_AU_CL_ACC   , 
MAX(CRED_MAX_BK_AU_OP_ACC   ) AS  MAX_CRED_MAX_BK_AU_OP_ACC   ,
MAX(CRED_MAX_BK_AU          ) AS  MAX_CRED_MAX_BK_AU          ,
MAX(CRED_MAX_BK_M_CL_ACC    ) AS  MAX_CRED_MAX_BK_M_CL_ACC    ,
MAX(CRED_MAX_BK_M_OP_ACC    ) AS  MAX_CRED_MAX_BK_M_OP_ACC    ,
MAX(CRED_MAX_BK_M           ) AS  MAX_CRED_MAX_BK_M           ,
MAX(CRED_MAX_BK_PL_CL_ACC   ) AS  MAX_CRED_MAX_BK_PL_CL_ACC   ,
MAX(CRED_MAX_BK_PL_OP_ACC   ) AS  MAX_CRED_MAX_BK_PL_OP_ACC   ,
MAX(CRED_MAX_BK_PL          ) AS  MAX_CRED_MAX_BK_PL          ,
MAX(CRED_MAX_BK_R_CL_ACC    ) AS  MAX_CRED_MAX_BK_R_CL_ACC    ,
MAX(CRED_MAX_BK_R_OP_ACC    ) AS  MAX_CRED_MAX_BK_R_OP_ACC    ,
MAX(CRED_MAX_BK_R           ) AS  MAX_CRED_MAX_BK_R           ,
MAX(CRED_MAX_BK_CL_ACC      ) AS  MAX_CRED_MAX_BK_CL_ACC      ,
MAX(CRED_MAX_BK_OP_ACC      ) AS  MAX_CRED_MAX_BK_OP_ACC      ,
MAX(CRED_MAX_BK             ) AS  MAX_CRED_MAX_BK             ,
MAX(CRED_MAX_NBK_AU_CL_ACC  ) AS  MAX_CRED_MAX_NBK_AU_CL_ACC  ,
MAX(CRED_MAX_NBK_AU_OP_ACC  ) AS  MAX_CRED_MAX_NBK_AU_OP_ACC  ,
MAX(CRED_MAX_NBK_AU         ) AS  MAX_CRED_MAX_NBK_AU         ,
MAX(CRED_MAX_NBK_M_CL_ACC   ) AS  MAX_CRED_MAX_NBK_M_CL_ACC   ,
MAX(CRED_MAX_NBK_M_OP_ACC   ) AS  MAX_CRED_MAX_NBK_M_OP_ACC   ,
MAX(CRED_MAX_NBK_M          ) AS  MAX_CRED_MAX_NBK_M          ,
MAX(CRED_MAX_NBK_PL_CL_ACC  ) AS  MAX_CRED_MAX_NBK_PL_CL_ACC  ,
MAX(CRED_MAX_NBK_PL_OP_ACC  ) AS  MAX_CRED_MAX_NBK_PL_OP_ACC  ,
MAX(CRED_MAX_NBK_PL         ) AS  MAX_CRED_MAX_NBK_PL         ,
MAX(CRED_MAX_NBK_R_CL_ACC   ) AS  MAX_CRED_MAX_NBK_R_CL_ACC   ,
MAX(CRED_MAX_NBK_R_OP_ACC   ) AS  MAX_CRED_MAX_NBK_R_OP_ACC   ,
MAX(CRED_MAX_NBK_R          ) AS  MAX_CRED_MAX_NBK_R          ,
MAX(CRED_MAX_NBK_CL_ACC     ) AS  MAX_CRED_MAX_NBK_CL_ACC     ,
MAX(CRED_MAX_NBK_OP_ACC     ) AS  MAX_CRED_MAX_NBK_OP_ACC     ,
MAX(CRED_MAX_NBK            ) AS  MAX_CRED_MAX_NBK            ,
MAX(CRED_MAX_AMX_CL_ACC     ) AS  MAX_CRED_MAX_AMX_CL_ACC     ,
MAX(CRED_MAX_AMX_OP_ACC     ) AS  MAX_CRED_MAX_AMX_OP_ACC     ,
MAX(CRED_MAX_AMX            ) AS  MAX_CRED_MAX_AMX            ,
MAX(CRED_MAX_AU_CL_ACC      ) AS  MAX_CRED_MAX_AU_CL_ACC      ,
MAX(CRED_MAX_AU_OP_ACC      ) AS  MAX_CRED_MAX_AU_OP_ACC      ,
MAX(CRED_MAX_AU             ) AS  MAX_CRED_MAX_AU             ,
MAX(CRED_MAX_M_CL_ACC       ) AS  MAX_CRED_MAX_M_CL_ACC       ,
MAX(CRED_MAX_M_OP_ACC       ) AS  MAX_CRED_MAX_M_OP_ACC       ,
MAX(CRED_MAX_M              ) AS  MAX_CRED_MAX_M              ,
MAX(CRED_MAX_PL_CL_ACC      ) AS  MAX_CRED_MAX_PL_CL_ACC      ,
MAX(CRED_MAX_PL_OP_ACC      ) AS  MAX_CRED_MAX_PL_OP_ACC      ,
MAX(CRED_MAX_PL             ) AS  MAX_CRED_MAX_PL             ,
MAX(CRED_MAX_R_CL_ACC       ) AS  MAX_CRED_MAX_R_CL_ACC       ,
MAX(CRED_MAX_R_OP_ACC       ) AS  MAX_CRED_MAX_R_OP_ACC       ,
MAX(CRED_MAX_R              ) AS  MAX_CRED_MAX_R              ,
MAX(CRED_MAX_CL_ACC         ) AS  MAX_CRED_MAX_CL_ACC         ,
MAX(CRED_MAX_OP_ACC         ) AS  MAX_CRED_MAX_OP_ACC         ,
MAX(CRED_MAX                ) AS  MAX_CRED_MAX                ,
MAX(CRED_MAX_TU_ALL         ) AS  MAX_CRED_MAX_TU_ALL         ,
MAX(CRED_MAX_TU             ) AS  MAX_CRED_MAX_TU             ,
MAX(CRED_MAX_TU_ALL_OP_ACC  ) AS  MAX_CRED_MAX_TU_ALL_OP_ACC  ,
MAX(CRED_MAX_TU_OP_ACC      ) AS  MAX_CRED_MAX_TU_OP_ACC      ,
MAX(CRED_MAX_TU_ALL_CL_ACC  ) AS  MAX_CRED_MAX_TU_ALL_CL_ACC  ,
MAX(CRED_MAX_TU_CL_ACC      ) AS  MAX_CRED_MAX_TU_CL_ACC      ,
MAX(CRED_MAX_NBK_TU         ) AS  MAX_CRED_MAX_NBK_TU         ,
MAX(CRED_MAX_NBK_TU_OP_ACC  ) AS  MAX_CRED_MAX_NBK_TU_OP_ACC  ,
MAX(CRED_MAX_NBK_TU_CL_ACC  ) AS  MAX_CRED_MAX_NBK_TU_CL_ACC  ,

SUM(CRED_MAX_BK_AU_CL_ACC   ) / NULLIF(COUNT(CRED_MAX_BK_AU_CL_ACC   ),0)  AS  AVG_CRED_MAX_BK_AU_CL_ACC   , 
SUM(CRED_MAX_BK_AU_OP_ACC   ) / NULLIF(COUNT(CRED_MAX_BK_AU_OP_ACC   ),0)  AS  AVG_CRED_MAX_BK_AU_OP_ACC   ,
SUM(CRED_MAX_BK_AU          ) / NULLIF(COUNT(CRED_MAX_BK_AU          ),0)  AS  AVG_CRED_MAX_BK_AU          ,
SUM(CRED_MAX_BK_M_CL_ACC    ) / NULLIF(COUNT(CRED_MAX_BK_M_CL_ACC    ),0)  AS  AVG_CRED_MAX_BK_M_CL_ACC    ,
SUM(CRED_MAX_BK_M_OP_ACC    ) / NULLIF(COUNT(CRED_MAX_BK_M_OP_ACC    ),0)  AS  AVG_CRED_MAX_BK_M_OP_ACC    ,
SUM(CRED_MAX_BK_M           ) / NULLIF(COUNT(CRED_MAX_BK_M           ),0)  AS  AVG_CRED_MAX_BK_M           ,
SUM(CRED_MAX_BK_PL_CL_ACC   ) / NULLIF(COUNT(CRED_MAX_BK_PL_CL_ACC   ),0)  AS  AVG_CRED_MAX_BK_PL_CL_ACC   ,
SUM(CRED_MAX_BK_PL_OP_ACC   ) / NULLIF(COUNT(CRED_MAX_BK_PL_OP_ACC   ),0)  AS  AVG_CRED_MAX_BK_PL_OP_ACC   ,
SUM(CRED_MAX_BK_PL          ) / NULLIF(COUNT(CRED_MAX_BK_PL          ),0)  AS  AVG_CRED_MAX_BK_PL          ,
SUM(CRED_MAX_BK_R_CL_ACC    ) / NULLIF(COUNT(CRED_MAX_BK_R_CL_ACC    ),0)  AS  AVG_CRED_MAX_BK_R_CL_ACC    ,
SUM(CRED_MAX_BK_R_OP_ACC    ) / NULLIF(COUNT(CRED_MAX_BK_R_OP_ACC    ),0)  AS  AVG_CRED_MAX_BK_R_OP_ACC    ,
SUM(CRED_MAX_BK_R           ) / NULLIF(COUNT(CRED_MAX_BK_R           ),0)  AS  AVG_CRED_MAX_BK_R           ,
SUM(CRED_MAX_BK_CL_ACC      ) / NULLIF(COUNT(CRED_MAX_BK_CL_ACC      ),0)  AS  AVG_CRED_MAX_BK_CL_ACC      ,
SUM(CRED_MAX_BK_OP_ACC      ) / NULLIF(COUNT(CRED_MAX_BK_OP_ACC      ),0)  AS  AVG_CRED_MAX_BK_OP_ACC      ,
SUM(CRED_MAX_BK             ) / NULLIF(COUNT(CRED_MAX_BK             ),0)  AS  AVG_CRED_MAX_BK             ,
SUM(CRED_MAX_NBK_AU_CL_ACC  ) / NULLIF(COUNT(CRED_MAX_NBK_AU_CL_ACC  ),0)  AS  AVG_CRED_MAX_NBK_AU_CL_ACC  ,
SUM(CRED_MAX_NBK_AU_OP_ACC  ) / NULLIF(COUNT(CRED_MAX_NBK_AU_OP_ACC  ),0)  AS  AVG_CRED_MAX_NBK_AU_OP_ACC  ,
SUM(CRED_MAX_NBK_AU         ) / NULLIF(COUNT(CRED_MAX_NBK_AU         ),0)  AS  AVG_CRED_MAX_NBK_AU         ,
SUM(CRED_MAX_NBK_M_CL_ACC   ) / NULLIF(COUNT(CRED_MAX_NBK_M_CL_ACC   ),0)  AS  AVG_CRED_MAX_NBK_M_CL_ACC   ,
SUM(CRED_MAX_NBK_M_OP_ACC   ) / NULLIF(COUNT(CRED_MAX_NBK_M_OP_ACC   ),0)  AS  AVG_CRED_MAX_NBK_M_OP_ACC   ,
SUM(CRED_MAX_NBK_M          ) / NULLIF(COUNT(CRED_MAX_NBK_M          ),0)  AS  AVG_CRED_MAX_NBK_M          ,
SUM(CRED_MAX_NBK_PL_CL_ACC  ) / NULLIF(COUNT(CRED_MAX_NBK_PL_CL_ACC  ),0)  AS  AVG_CRED_MAX_NBK_PL_CL_ACC  ,
SUM(CRED_MAX_NBK_PL_OP_ACC  ) / NULLIF(COUNT(CRED_MAX_NBK_PL_OP_ACC  ),0)  AS  AVG_CRED_MAX_NBK_PL_OP_ACC  ,
SUM(CRED_MAX_NBK_PL         ) / NULLIF(COUNT(CRED_MAX_NBK_PL         ),0)  AS  AVG_CRED_MAX_NBK_PL         ,
SUM(CRED_MAX_NBK_R_CL_ACC   ) / NULLIF(COUNT(CRED_MAX_NBK_R_CL_ACC   ),0)  AS  AVG_CRED_MAX_NBK_R_CL_ACC   ,
SUM(CRED_MAX_NBK_R_OP_ACC   ) / NULLIF(COUNT(CRED_MAX_NBK_R_OP_ACC   ),0)  AS  AVG_CRED_MAX_NBK_R_OP_ACC   ,
SUM(CRED_MAX_NBK_R          ) / NULLIF(COUNT(CRED_MAX_NBK_R          ),0)  AS  AVG_CRED_MAX_NBK_R          ,
SUM(CRED_MAX_NBK_CL_ACC     ) / NULLIF(COUNT(CRED_MAX_NBK_CL_ACC     ),0)  AS  AVG_CRED_MAX_NBK_CL_ACC     ,
SUM(CRED_MAX_NBK_OP_ACC     ) / NULLIF(COUNT(CRED_MAX_NBK_OP_ACC     ),0)  AS  AVG_CRED_MAX_NBK_OP_ACC     ,
SUM(CRED_MAX_NBK            ) / NULLIF(COUNT(CRED_MAX_NBK            ),0)  AS  AVG_CRED_MAX_NBK            ,
SUM(CRED_MAX_AMX_CL_ACC     ) / NULLIF(COUNT(CRED_MAX_AMX_CL_ACC     ),0)  AS  AVG_CRED_MAX_AMX_CL_ACC     ,
SUM(CRED_MAX_AMX_OP_ACC     ) / NULLIF(COUNT(CRED_MAX_AMX_OP_ACC     ),0)  AS  AVG_CRED_MAX_AMX_OP_ACC     ,
SUM(CRED_MAX_AMX            ) / NULLIF(COUNT(CRED_MAX_AMX            ),0)  AS  AVG_CRED_MAX_AMX            ,
SUM(CRED_MAX_AU_CL_ACC      ) / NULLIF(COUNT(CRED_MAX_AU_CL_ACC      ),0)  AS  AVG_CRED_MAX_AU_CL_ACC      ,
SUM(CRED_MAX_AU_OP_ACC      ) / NULLIF(COUNT(CRED_MAX_AU_OP_ACC      ),0)  AS  AVG_CRED_MAX_AU_OP_ACC      ,
SUM(CRED_MAX_AU             ) / NULLIF(COUNT(CRED_MAX_AU             ),0)  AS  AVG_CRED_MAX_AU             ,
SUM(CRED_MAX_M_CL_ACC       ) / NULLIF(COUNT(CRED_MAX_M_CL_ACC       ),0)  AS  AVG_CRED_MAX_M_CL_ACC       ,
SUM(CRED_MAX_M_OP_ACC       ) / NULLIF(COUNT(CRED_MAX_M_OP_ACC       ),0)  AS  AVG_CRED_MAX_M_OP_ACC       ,
SUM(CRED_MAX_M              ) / NULLIF(COUNT(CRED_MAX_M              ),0)  AS  AVG_CRED_MAX_M              ,
SUM(CRED_MAX_PL_CL_ACC      ) / NULLIF(COUNT(CRED_MAX_PL_CL_ACC      ),0)  AS  AVG_CRED_MAX_PL_CL_ACC      ,
SUM(CRED_MAX_PL_OP_ACC      ) / NULLIF(COUNT(CRED_MAX_PL_OP_ACC      ),0)  AS  AVG_CRED_MAX_PL_OP_ACC      ,
SUM(CRED_MAX_PL             ) / NULLIF(COUNT(CRED_MAX_PL             ),0)  AS  AVG_CRED_MAX_PL             ,
SUM(CRED_MAX_R_CL_ACC       ) / NULLIF(COUNT(CRED_MAX_R_CL_ACC       ),0)  AS  AVG_CRED_MAX_R_CL_ACC       ,
SUM(CRED_MAX_R_OP_ACC       ) / NULLIF(COUNT(CRED_MAX_R_OP_ACC       ),0)  AS  AVG_CRED_MAX_R_OP_ACC       ,
SUM(CRED_MAX_R              ) / NULLIF(COUNT(CRED_MAX_R              ),0)  AS  AVG_CRED_MAX_R              ,
SUM(CRED_MAX_CL_ACC         ) / NULLIF(COUNT(CRED_MAX_CL_ACC         ),0)  AS  AVG_CRED_MAX_CL_ACC         ,
SUM(CRED_MAX_OP_ACC         ) / NULLIF(COUNT(CRED_MAX_OP_ACC         ),0)  AS  AVG_CRED_MAX_OP_ACC         ,
SUM(CRED_MAX                ) / NULLIF(COUNT(CRED_MAX                ),0)  AS  AVG_CRED_MAX                ,
SUM(CRED_MAX_TU_ALL         ) / NULLIF(COUNT(CRED_MAX_TU_ALL         ),0)  AS  AVG_CRED_MAX_TU_ALL         ,
SUM(CRED_MAX_TU             ) / NULLIF(COUNT(CRED_MAX_TU             ),0)  AS  AVG_CRED_MAX_TU             ,
SUM(CRED_MAX_TU_ALL_OP_ACC  ) / NULLIF(COUNT(CRED_MAX_TU_ALL_OP_ACC  ),0)  AS  AVG_CRED_MAX_TU_ALL_OP_ACC  ,
SUM(CRED_MAX_TU_OP_ACC      ) / NULLIF(COUNT(CRED_MAX_TU_OP_ACC      ),0)  AS  AVG_CRED_MAX_TU_OP_ACC      ,
SUM(CRED_MAX_TU_ALL_CL_ACC  ) / NULLIF(COUNT(CRED_MAX_TU_ALL_CL_ACC  ),0)  AS  AVG_CRED_MAX_TU_ALL_CL_ACC  ,
SUM(CRED_MAX_TU_CL_ACC      ) / NULLIF(COUNT(CRED_MAX_TU_CL_ACC      ),0)  AS  AVG_CRED_MAX_TU_CL_ACC      ,
SUM(CRED_MAX_NBK_TU         ) / NULLIF(COUNT(CRED_MAX_NBK_TU         ),0)  AS  AVG_CRED_MAX_NBK_TU         ,
SUM(CRED_MAX_NBK_TU_OP_ACC  ) / NULLIF(COUNT(CRED_MAX_NBK_TU_OP_ACC  ),0)  AS  AVG_CRED_MAX_NBK_TU_OP_ACC  ,
SUM(CRED_MAX_NBK_TU_CL_ACC  ) / NULLIF(COUNT(CRED_MAX_NBK_TU_CL_ACC  ),0)  AS  AVG_CRED_MAX_NBK_TU_CL_ACC  

FROM dbmymwork.BTDC_LGG_VAR_SEGMENTADAS_3
GROUP BY CUENTADEREFERENCIA,
FECHA_CARTERA;

SELECT * FROM dbmymwork.BTDC_LGG_VAR_CRED_MAX LIMIT 100;