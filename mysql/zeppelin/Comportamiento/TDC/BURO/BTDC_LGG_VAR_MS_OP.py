%hive

DROP TABLE IF EXISTS dbmymwork.BTDC_LGG_VAR_MS_OP;
CREATE TABLE dbmymwork.BTDC_LGG_VAR_MS_OP
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/BTDC/VARIABLES/BTDC_LGG_VAR_MS_OP' AS

SELECT
CUENTADEREFERENCIA,
FECHA_CARTERA,

COUNT(MS_OP_BK_AU_CL_ACC) AS NUM_MS_OP_BK_AU_CL_ACC,
MAX(MS_OP_BK_AU_CL_ACC)   AS MAX_MS_OP_BK_AU_CL_ACC,
SUM(MS_OP_BK_AU_CL_ACC)   AS SUM_MS_OP_BK_AU_CL_ACC,
MIN(MS_OP_BK_AU_CL_ACC)   AS MIN_MS_OP_BK_AU_CL_ACC,
MAX(MS_OP_BK_AU_CL_ACC) - MIN(MS_OP_BK_AU_CL_ACC) AS DIF_MS_OP_BK_AU_CL_ACC,
SUM(MS_OP_BK_AU_CL_ACC)/NULLIF(COUNT(MS_OP_BK_AU_CL_ACC),0) AS AVG_MS_OP_BK_AU_CL_ACC,

COUNT(MS_OP_BK_AU_OP_ACC) AS NUM_MS_OP_BK_AU_OP_ACC,
MAX(MS_OP_BK_AU_OP_ACC)   AS MAX_MS_OP_BK_AU_OP_ACC,
SUM(MS_OP_BK_AU_OP_ACC)   AS SUM_MS_OP_BK_AU_OP_ACC,
MIN(MS_OP_BK_AU_OP_ACC)   AS MIN_MS_OP_BK_AU_OP_ACC,
MAX(MS_OP_BK_AU_OP_ACC) - MIN(MS_OP_BK_AU_OP_ACC) AS DIF_MS_OP_BK_AU_OP_ACC,
SUM(MS_OP_BK_AU_OP_ACC)/NULLIF(COUNT(MS_OP_BK_AU_OP_ACC),0) AS AVG_MS_OP_BK_AU_OP_ACC,

COUNT(MS_OP_BK_AU) AS NUM_MS_OP_BK_AU,
MAX(MS_OP_BK_AU)   AS MAX_MS_OP_BK_AU,
SUM(MS_OP_BK_AU)   AS SUM_MS_OP_BK_AU,
MIN(MS_OP_BK_AU)   AS MIN_MS_OP_BK_AU,
MAX(MS_OP_BK_AU) - MIN(MS_OP_BK_AU) AS DIF_MS_OP_BK_AU,
SUM(MS_OP_BK_AU)/NULLIF(COUNT(MS_OP_BK_AU),0) AS AVG_MS_OP_BK_AU,

COUNT(MS_OP_BK_M_CL_ACC) AS NUM_MS_OP_BK_M_CL_ACC,
MAX(MS_OP_BK_M_CL_ACC)   AS MAX_MS_OP_BK_M_CL_ACC,
SUM(MS_OP_BK_M_CL_ACC)   AS SUM_MS_OP_BK_M_CL_ACC,
MIN(MS_OP_BK_M_CL_ACC)   AS MIN_MS_OP_BK_M_CL_ACC,
MAX(MS_OP_BK_M_CL_ACC) - MIN(MS_OP_BK_M_CL_ACC) AS DIF_MS_OP_BK_M_CL_ACC,
SUM(MS_OP_BK_M_CL_ACC)/NULLIF(COUNT(MS_OP_BK_M_CL_ACC),0) AS AVG_MS_OP_BK_M_CL_ACC,

COUNT(MS_OP_BK_M_OP_ACC) AS NUM_MS_OP_BK_M_OP_ACC,
MAX(MS_OP_BK_M_OP_ACC)   AS MAX_MS_OP_BK_M_OP_ACC,
SUM(MS_OP_BK_M_OP_ACC)   AS SUM_MS_OP_BK_M_OP_ACC,
MIN(MS_OP_BK_M_OP_ACC)   AS MIN_MS_OP_BK_M_OP_ACC,
MAX(MS_OP_BK_M_OP_ACC) - MIN(MS_OP_BK_M_OP_ACC) AS DIF_MS_OP_BK_M_OP_ACC,
SUM(MS_OP_BK_M_OP_ACC)/NULLIF(COUNT(MS_OP_BK_M_OP_ACC),0) AS AVG_MS_OP_BK_M_OP_ACC,

COUNT(MS_OP_BK_M) AS NUM_MS_OP_BK_M,
MAX(MS_OP_BK_M)   AS MAX_MS_OP_BK_M,
SUM(MS_OP_BK_M)   AS SUM_MS_OP_BK_M,
MIN(MS_OP_BK_M)   AS MIN_MS_OP_BK_M,
MAX(MS_OP_BK_M) - MIN(MS_OP_BK_M) AS DIF_MS_OP_BK_M,
SUM(MS_OP_BK_M)/NULLIF(COUNT(MS_OP_BK_M),0) AS AVG_MS_OP_BK_M,

COUNT(MS_OP_BK_PL_CL_ACC) AS NUM_MS_OP_BK_PL_CL_ACC,
MAX(MS_OP_BK_PL_CL_ACC)   AS MAX_MS_OP_BK_PL_CL_ACC,
SUM(MS_OP_BK_PL_CL_ACC)   AS SUM_MS_OP_BK_PL_CL_ACC,
MIN(MS_OP_BK_PL_CL_ACC)   AS MIN_MS_OP_BK_PL_CL_ACC,
MAX(MS_OP_BK_PL_CL_ACC) - MIN(MS_OP_BK_PL_CL_ACC) AS DIF_MS_OP_BK_PL_CL_ACC,
SUM(MS_OP_BK_PL_CL_ACC)/NULLIF(COUNT(MS_OP_BK_PL_CL_ACC),0) AS AVG_MS_OP_BK_PL_CL_ACC,

COUNT(MS_OP_BK_PL_OP_ACC) AS NUM_MS_OP_BK_PL_OP_ACC,
MAX(MS_OP_BK_PL_OP_ACC)   AS MAX_MS_OP_BK_PL_OP_ACC,
SUM(MS_OP_BK_PL_OP_ACC)   AS SUM_MS_OP_BK_PL_OP_ACC,
MIN(MS_OP_BK_PL_OP_ACC)   AS MIN_MS_OP_BK_PL_OP_ACC,
MAX(MS_OP_BK_PL_OP_ACC) - MIN(MS_OP_BK_PL_OP_ACC) AS DIF_MS_OP_BK_PL_OP_ACC,
SUM(MS_OP_BK_PL_OP_ACC)/NULLIF(COUNT(MS_OP_BK_PL_OP_ACC),0) AS AVG_MS_OP_BK_PL_OP_ACC,

COUNT(MS_OP_BK_PL) AS NUM_MS_OP_BK_PL,
MAX(MS_OP_BK_PL)   AS MAX_MS_OP_BK_PL,
SUM(MS_OP_BK_PL)   AS SUM_MS_OP_BK_PL,
MIN(MS_OP_BK_PL)   AS MIN_MS_OP_BK_PL,
MAX(MS_OP_BK_PL) - MIN(MS_OP_BK_PL) AS DIF_MS_OP_BK_PL,
SUM(MS_OP_BK_PL)/NULLIF(COUNT(MS_OP_BK_PL),0) AS AVG_MS_OP_BK_PL,

COUNT(MS_OP_BK_R_CL_ACC) AS NUM_MS_OP_BK_R_CL_ACC,
MAX(MS_OP_BK_R_CL_ACC)   AS MAX_MS_OP_BK_R_CL_ACC,
SUM(MS_OP_BK_R_CL_ACC)   AS SUM_MS_OP_BK_R_CL_ACC,
MIN(MS_OP_BK_R_CL_ACC)   AS MIN_MS_OP_BK_R_CL_ACC,
MAX(MS_OP_BK_R_CL_ACC) - MIN(MS_OP_BK_R_CL_ACC) AS DIF_MS_OP_BK_R_CL_ACC,
SUM(MS_OP_BK_R_CL_ACC)/NULLIF(COUNT(MS_OP_BK_R_CL_ACC),0) AS AVG_MS_OP_BK_R_CL_ACC,

COUNT(MS_OP_BK_R_OP_ACC) AS NUM_MS_OP_BK_R_OP_ACC,
MAX(MS_OP_BK_R_OP_ACC)   AS MAX_MS_OP_BK_R_OP_ACC,
SUM(MS_OP_BK_R_OP_ACC)   AS SUM_MS_OP_BK_R_OP_ACC,
MIN(MS_OP_BK_R_OP_ACC)   AS MIN_MS_OP_BK_R_OP_ACC,
MAX(MS_OP_BK_R_OP_ACC) - MIN(MS_OP_BK_R_OP_ACC) AS DIF_MS_OP_BK_R_OP_ACC,
SUM(MS_OP_BK_R_OP_ACC)/NULLIF(COUNT(MS_OP_BK_R_OP_ACC),0) AS AVG_MS_OP_BK_R_OP_ACC,

COUNT(MS_OP_BK_R) AS NUM_MS_OP_BK_R,
MAX(MS_OP_BK_R)   AS MAX_MS_OP_BK_R,
SUM(MS_OP_BK_R)   AS SUM_MS_OP_BK_R,
MIN(MS_OP_BK_R)   AS MIN_MS_OP_BK_R,
MAX(MS_OP_BK_R) - MIN(MS_OP_BK_R) AS DIF_MS_OP_BK_R,
SUM(MS_OP_BK_R)/NULLIF(COUNT(MS_OP_BK_R),0) AS AVG_MS_OP_BK_R,

COUNT(MS_OP_BK_CL_ACC) AS NUM_MS_OP_BK_CL_ACC,
MAX(MS_OP_BK_CL_ACC)   AS MAX_MS_OP_BK_CL_ACC,
SUM(MS_OP_BK_CL_ACC)   AS SUM_MS_OP_BK_CL_ACC,
MIN(MS_OP_BK_CL_ACC)   AS MIN_MS_OP_BK_CL_ACC,
MAX(MS_OP_BK_CL_ACC) - MIN(MS_OP_BK_CL_ACC) AS DIF_MS_OP_BK_CL_ACC,
SUM(MS_OP_BK_CL_ACC)/NULLIF(COUNT(MS_OP_BK_CL_ACC),0) AS AVG_MS_OP_BK_CL_ACC,

COUNT(MS_OP_BK_OP_ACC) AS NUM_MS_OP_BK_OP_ACC,
MAX(MS_OP_BK_OP_ACC)   AS MAX_MS_OP_BK_OP_ACC,
SUM(MS_OP_BK_OP_ACC)   AS SUM_MS_OP_BK_OP_ACC,
MIN(MS_OP_BK_OP_ACC)   AS MIN_MS_OP_BK_OP_ACC,
MAX(MS_OP_BK_OP_ACC) - MIN(MS_OP_BK_OP_ACC) AS DIF_MS_OP_BK_OP_ACC,
SUM(MS_OP_BK_OP_ACC)/NULLIF(COUNT(MS_OP_BK_OP_ACC),0) AS AVG_MS_OP_BK_OP_ACC,

COUNT(MS_OP_BK) AS NUM_MS_OP_BK,
MAX(MS_OP_BK)   AS MAX_MS_OP_BK,
SUM(MS_OP_BK)   AS SUM_MS_OP_BK,
MIN(MS_OP_BK)   AS MIN_MS_OP_BK,
MAX(MS_OP_BK) - MIN(MS_OP_BK) AS DIF_MS_OP_BK,
SUM(MS_OP_BK)/NULLIF(COUNT(MS_OP_BK),0) AS AVG_MS_OP_BK,

COUNT(MS_OP_NBK_AU_CL_ACC) AS NUM_MS_OP_NBK_AU_CL_ACC,
MAX(MS_OP_NBK_AU_CL_ACC)   AS MAX_MS_OP_NBK_AU_CL_ACC,
SUM(MS_OP_NBK_AU_CL_ACC)   AS SUM_MS_OP_NBK_AU_CL_ACC,
MIN(MS_OP_NBK_AU_CL_ACC)   AS MIN_MS_OP_NBK_AU_CL_ACC,
MAX(MS_OP_NBK_AU_CL_ACC) - MIN(MS_OP_NBK_AU_CL_ACC) AS DIF_MS_OP_NBK_AU_CL_ACC,
SUM(MS_OP_NBK_AU_CL_ACC)/NULLIF(COUNT(MS_OP_NBK_AU_CL_ACC),0) AS AVG_MS_OP_NBK_AU_CL_ACC,

COUNT(MS_OP_NBK_AU_OP_ACC) AS NUM_MS_OP_NBK_AU_OP_ACC,
MAX(MS_OP_NBK_AU_OP_ACC)   AS MAX_MS_OP_NBK_AU_OP_ACC,
SUM(MS_OP_NBK_AU_OP_ACC)   AS SUM_MS_OP_NBK_AU_OP_ACC,
MIN(MS_OP_NBK_AU_OP_ACC)   AS MIN_MS_OP_NBK_AU_OP_ACC,
MAX(MS_OP_NBK_AU_OP_ACC) - MIN(MS_OP_NBK_AU_OP_ACC) AS DIF_MS_OP_NBK_AU_OP_ACC,
SUM(MS_OP_NBK_AU_OP_ACC)/NULLIF(COUNT(MS_OP_NBK_AU_OP_ACC),0) AS AVG_MS_OP_NBK_AU_OP_ACC,

COUNT(MS_OP_NBK_AU) AS NUM_MS_OP_NBK_AU,
MAX(MS_OP_NBK_AU)   AS MAX_MS_OP_NBK_AU,
SUM(MS_OP_NBK_AU)   AS SUM_MS_OP_NBK_AU,
MIN(MS_OP_NBK_AU)   AS MIN_MS_OP_NBK_AU,
MAX(MS_OP_NBK_AU) - MIN(MS_OP_NBK_AU) AS DIF_MS_OP_NBK_AU,
SUM(MS_OP_NBK_AU)/NULLIF(COUNT(MS_OP_NBK_AU),0) AS AVG_MS_OP_NBK_AU,

COUNT(MS_OP_NBK_M_CL_ACC) AS NUM_MS_OP_NBK_M_CL_ACC,
MAX(MS_OP_NBK_M_CL_ACC)   AS MAX_MS_OP_NBK_M_CL_ACC,
SUM(MS_OP_NBK_M_CL_ACC)   AS SUM_MS_OP_NBK_M_CL_ACC,
MIN(MS_OP_NBK_M_CL_ACC)   AS MIN_MS_OP_NBK_M_CL_ACC,
MAX(MS_OP_NBK_M_CL_ACC) - MIN(MS_OP_NBK_M_CL_ACC) AS DIF_MS_OP_NBK_M_CL_ACC,
SUM(MS_OP_NBK_M_CL_ACC)/NULLIF(COUNT(MS_OP_NBK_M_CL_ACC),0) AS AVG_MS_OP_NBK_M_CL_ACC,

COUNT(MS_OP_NBK_M_OP_ACC) AS NUM_MS_OP_NBK_M_OP_ACC,
MAX(MS_OP_NBK_M_OP_ACC)   AS MAX_MS_OP_NBK_M_OP_ACC,
SUM(MS_OP_NBK_M_OP_ACC)   AS SUM_MS_OP_NBK_M_OP_ACC,
MIN(MS_OP_NBK_M_OP_ACC)   AS MIN_MS_OP_NBK_M_OP_ACC,
MAX(MS_OP_NBK_M_OP_ACC) - MIN(MS_OP_NBK_M_OP_ACC) AS DIF_MS_OP_NBK_M_OP_ACC,
SUM(MS_OP_NBK_M_OP_ACC)/NULLIF(COUNT(MS_OP_NBK_M_OP_ACC),0) AS AVG_MS_OP_NBK_M_OP_ACC,

COUNT(MS_OP_NBK_M) AS NUM_MS_OP_NBK_M,
MAX(MS_OP_NBK_M)   AS MAX_MS_OP_NBK_M,
SUM(MS_OP_NBK_M)   AS SUM_MS_OP_NBK_M,
MIN(MS_OP_NBK_M)   AS MIN_MS_OP_NBK_M,
MAX(MS_OP_NBK_M) - MIN(MS_OP_NBK_M) AS DIF_MS_OP_NBK_M,
SUM(MS_OP_NBK_M)/NULLIF(COUNT(MS_OP_NBK_M),0) AS AVG_MS_OP_NBK_M,

COUNT(MS_OP_NBK_PL_CL_ACC) AS NUM_MS_OP_NBK_PL_CL_ACC,
MAX(MS_OP_NBK_PL_CL_ACC)   AS MAX_MS_OP_NBK_PL_CL_ACC,
SUM(MS_OP_NBK_PL_CL_ACC)   AS SUM_MS_OP_NBK_PL_CL_ACC,
MIN(MS_OP_NBK_PL_CL_ACC)   AS MIN_MS_OP_NBK_PL_CL_ACC,
MAX(MS_OP_NBK_PL_CL_ACC) - MIN(MS_OP_NBK_PL_CL_ACC) AS DIF_MS_OP_NBK_PL_CL_ACC,
SUM(MS_OP_NBK_PL_CL_ACC)/NULLIF(COUNT(MS_OP_NBK_PL_CL_ACC),0) AS AVG_MS_OP_NBK_PL_CL_ACC,

COUNT(MS_OP_NBK_PL_OP_ACC) AS NUM_MS_OP_NBK_PL_OP_ACC,
MAX(MS_OP_NBK_PL_OP_ACC)   AS MAX_MS_OP_NBK_PL_OP_ACC,
SUM(MS_OP_NBK_PL_OP_ACC)   AS SUM_MS_OP_NBK_PL_OP_ACC,
MIN(MS_OP_NBK_PL_OP_ACC)   AS MIN_MS_OP_NBK_PL_OP_ACC,
MAX(MS_OP_NBK_PL_OP_ACC) - MIN(MS_OP_NBK_PL_OP_ACC) AS DIF_MS_OP_NBK_PL_OP_ACC,
SUM(MS_OP_NBK_PL_OP_ACC)/NULLIF(COUNT(MS_OP_NBK_PL_OP_ACC),0) AS AVG_MS_OP_NBK_PL_OP_ACC,

COUNT(MS_OP_NBK_PL) AS NUM_MS_OP_NBK_PL,
MAX(MS_OP_NBK_PL)   AS MAX_MS_OP_NBK_PL,
SUM(MS_OP_NBK_PL)   AS SUM_MS_OP_NBK_PL,
MIN(MS_OP_NBK_PL)   AS MIN_MS_OP_NBK_PL,
MAX(MS_OP_NBK_PL) - MIN(MS_OP_NBK_PL) AS DIF_MS_OP_NBK_PL,
SUM(MS_OP_NBK_PL)/NULLIF(COUNT(MS_OP_NBK_PL),0) AS AVG_MS_OP_NBK_PL,

COUNT(MS_OP_NBK_R_CL_ACC) AS NUM_MS_OP_NBK_R_CL_ACC,
MAX(MS_OP_NBK_R_CL_ACC)   AS MAX_MS_OP_NBK_R_CL_ACC,
SUM(MS_OP_NBK_R_CL_ACC)   AS SUM_MS_OP_NBK_R_CL_ACC,
MIN(MS_OP_NBK_R_CL_ACC)   AS MIN_MS_OP_NBK_R_CL_ACC,
MAX(MS_OP_NBK_R_CL_ACC) - MIN(MS_OP_NBK_R_CL_ACC) AS DIF_MS_OP_NBK_R_CL_ACC,
SUM(MS_OP_NBK_R_CL_ACC)/NULLIF(COUNT(MS_OP_NBK_R_CL_ACC),0) AS AVG_MS_OP_NBK_R_CL_ACC,

COUNT(MS_OP_NBK_R_OP_ACC) AS NUM_MS_OP_NBK_R_OP_ACC,
MAX(MS_OP_NBK_R_OP_ACC)   AS MAX_MS_OP_NBK_R_OP_ACC,
SUM(MS_OP_NBK_R_OP_ACC)   AS SUM_MS_OP_NBK_R_OP_ACC,
MIN(MS_OP_NBK_R_OP_ACC)   AS MIN_MS_OP_NBK_R_OP_ACC,
MAX(MS_OP_NBK_R_OP_ACC) - MIN(MS_OP_NBK_R_OP_ACC) AS DIF_MS_OP_NBK_R_OP_ACC,
SUM(MS_OP_NBK_R_OP_ACC)/NULLIF(COUNT(MS_OP_NBK_R_OP_ACC),0) AS AVG_MS_OP_NBK_R_OP_ACC,

COUNT(MS_OP_NBK_R) AS NUM_MS_OP_NBK_R,
MAX(MS_OP_NBK_R)   AS MAX_MS_OP_NBK_R,
SUM(MS_OP_NBK_R)   AS SUM_MS_OP_NBK_R,
MIN(MS_OP_NBK_R)   AS MIN_MS_OP_NBK_R,
MAX(MS_OP_NBK_R) - MIN(MS_OP_NBK_R) AS DIF_MS_OP_NBK_R,
SUM(MS_OP_NBK_R)/NULLIF(COUNT(MS_OP_NBK_R),0) AS AVG_MS_OP_NBK_R,

COUNT(MS_OP_NBK_CL_ACC) AS NUM_MS_OP_NBK_CL_ACC,
MAX(MS_OP_NBK_CL_ACC)   AS MAX_MS_OP_NBK_CL_ACC,
SUM(MS_OP_NBK_CL_ACC)   AS SUM_MS_OP_NBK_CL_ACC,
MIN(MS_OP_NBK_CL_ACC)   AS MIN_MS_OP_NBK_CL_ACC,
MAX(MS_OP_NBK_CL_ACC) - MIN(MS_OP_NBK_CL_ACC) AS DIF_MS_OP_NBK_CL_ACC,
SUM(MS_OP_NBK_CL_ACC)/NULLIF(COUNT(MS_OP_NBK_CL_ACC),0) AS AVG_MS_OP_NBK_CL_ACC,

COUNT(MS_OP_NBK_OP_ACC) AS NUM_MS_OP_NBK_OP_ACC,
MAX(MS_OP_NBK_OP_ACC)   AS MAX_MS_OP_NBK_OP_ACC,
SUM(MS_OP_NBK_OP_ACC)   AS SUM_MS_OP_NBK_OP_ACC,
MIN(MS_OP_NBK_OP_ACC)   AS MIN_MS_OP_NBK_OP_ACC,
MAX(MS_OP_NBK_OP_ACC) - MIN(MS_OP_NBK_OP_ACC) AS DIF_MS_OP_NBK_OP_ACC,
SUM(MS_OP_NBK_OP_ACC)/NULLIF(COUNT(MS_OP_NBK_OP_ACC),0) AS AVG_MS_OP_NBK_OP_ACC,

COUNT(MS_OP_NBK) AS NUM_MS_OP_NBK,
MAX(MS_OP_NBK)   AS MAX_MS_OP_NBK,
SUM(MS_OP_NBK)   AS SUM_MS_OP_NBK,
MIN(MS_OP_NBK)   AS MIN_MS_OP_NBK,
MAX(MS_OP_NBK) - MIN(MS_OP_NBK) AS DIF_MS_OP_NBK,
SUM(MS_OP_NBK)/NULLIF(COUNT(MS_OP_NBK),0) AS AVG_MS_OP_NBK,

COUNT(MS_OP_AMX_CL_ACC) AS NUM_MS_OP_AMX_CL_ACC,
MAX(MS_OP_AMX_CL_ACC)   AS MAX_MS_OP_AMX_CL_ACC,
SUM(MS_OP_AMX_CL_ACC)   AS SUM_MS_OP_AMX_CL_ACC,
MIN(MS_OP_AMX_CL_ACC)   AS MIN_MS_OP_AMX_CL_ACC,
MAX(MS_OP_AMX_CL_ACC) - MIN(MS_OP_AMX_CL_ACC) AS DIF_MS_OP_AMX_CL_ACC,
SUM(MS_OP_AMX_CL_ACC)/NULLIF(COUNT(MS_OP_AMX_CL_ACC),0) AS AVG_MS_OP_AMX_CL_ACC,

COUNT(MS_OP_AMX_OP_ACC) AS NUM_MS_OP_AMX_OP_ACC,
MAX(MS_OP_AMX_OP_ACC)   AS MAX_MS_OP_AMX_OP_ACC,
SUM(MS_OP_AMX_OP_ACC)   AS SUM_MS_OP_AMX_OP_ACC,
MIN(MS_OP_AMX_OP_ACC)   AS MIN_MS_OP_AMX_OP_ACC,
MAX(MS_OP_AMX_OP_ACC) - MIN(MS_OP_AMX_OP_ACC) AS DIF_MS_OP_AMX_OP_ACC,
SUM(MS_OP_AMX_OP_ACC)/NULLIF(COUNT(MS_OP_AMX_OP_ACC),0) AS AVG_MS_OP_AMX_OP_ACC,

COUNT(MS_OP_AMX) AS NUM_MS_OP_AMX,
MAX(MS_OP_AMX)   AS MAX_MS_OP_AMX,
SUM(MS_OP_AMX)   AS SUM_MS_OP_AMX,
MIN(MS_OP_AMX)   AS MIN_MS_OP_AMX,
MAX(MS_OP_AMX) - MIN(MS_OP_AMX) AS DIF_MS_OP_AMX,
SUM(MS_OP_AMX)/NULLIF(COUNT(MS_OP_AMX),0) AS AVG_MS_OP_AMX,

COUNT(MS_OP_AU_CL_ACC) AS NUM_MS_OP_AU_CL_ACC,
MAX(MS_OP_AU_CL_ACC)   AS MAX_MS_OP_AU_CL_ACC,
SUM(MS_OP_AU_CL_ACC)   AS SUM_MS_OP_AU_CL_ACC,
MIN(MS_OP_AU_CL_ACC)   AS MIN_MS_OP_AU_CL_ACC,
MAX(MS_OP_AU_CL_ACC) - MIN(MS_OP_AU_CL_ACC) AS DIF_MS_OP_AU_CL_ACC,
SUM(MS_OP_AU_CL_ACC)/NULLIF(COUNT(MS_OP_AU_CL_ACC),0) AS AVG_MS_OP_AU_CL_ACC,

COUNT(MS_OP_AU_OP_ACC) AS NUM_MS_OP_AU_OP_ACC,
MAX(MS_OP_AU_OP_ACC)   AS MAX_MS_OP_AU_OP_ACC,
SUM(MS_OP_AU_OP_ACC)   AS SUM_MS_OP_AU_OP_ACC,
MIN(MS_OP_AU_OP_ACC)   AS MIN_MS_OP_AU_OP_ACC,
MAX(MS_OP_AU_OP_ACC) - MIN(MS_OP_AU_OP_ACC) AS DIF_MS_OP_AU_OP_ACC,
SUM(MS_OP_AU_OP_ACC)/NULLIF(COUNT(MS_OP_AU_OP_ACC),0) AS AVG_MS_OP_AU_OP_ACC,

COUNT(MS_OP_AU) AS NUM_MS_OP_AU,
MAX(MS_OP_AU)   AS MAX_MS_OP_AU,
SUM(MS_OP_AU)   AS SUM_MS_OP_AU,
MIN(MS_OP_AU)   AS MIN_MS_OP_AU,
MAX(MS_OP_AU) - MIN(MS_OP_AU) AS DIF_MS_OP_AU,
SUM(MS_OP_AU)/NULLIF(COUNT(MS_OP_AU),0) AS AVG_MS_OP_AU,

COUNT(MS_OP_M_CL_ACC) AS NUM_MS_OP_M_CL_ACC,
MAX(MS_OP_M_CL_ACC)   AS MAX_MS_OP_M_CL_ACC,
SUM(MS_OP_M_CL_ACC)   AS SUM_MS_OP_M_CL_ACC,
MIN(MS_OP_M_CL_ACC)   AS MIN_MS_OP_M_CL_ACC,
MAX(MS_OP_M_CL_ACC) - MIN(MS_OP_M_CL_ACC) AS DIF_MS_OP_M_CL_ACC,
SUM(MS_OP_M_CL_ACC)/NULLIF(COUNT(MS_OP_M_CL_ACC),0) AS AVG_MS_OP_M_CL_ACC,

COUNT(MS_OP_M_OP_ACC) AS NUM_MS_OP_M_OP_ACC,
MAX(MS_OP_M_OP_ACC)   AS MAX_MS_OP_M_OP_ACC,
SUM(MS_OP_M_OP_ACC)   AS SUM_MS_OP_M_OP_ACC,
MIN(MS_OP_M_OP_ACC)   AS MIN_MS_OP_M_OP_ACC,
MAX(MS_OP_M_OP_ACC) - MIN(MS_OP_M_OP_ACC) AS DIF_MS_OP_M_OP_ACC,
SUM(MS_OP_M_OP_ACC)/NULLIF(COUNT(MS_OP_M_OP_ACC),0) AS AVG_MS_OP_M_OP_ACC,

COUNT(MS_OP_M) AS NUM_MS_OP_M,
MAX(MS_OP_M)   AS MAX_MS_OP_M,
SUM(MS_OP_M)   AS SUM_MS_OP_M,
MIN(MS_OP_M)   AS MIN_MS_OP_M,
MAX(MS_OP_M) - MIN(MS_OP_M) AS DIF_MS_OP_M,
SUM(MS_OP_M)/NULLIF(COUNT(MS_OP_M),0) AS AVG_MS_OP_M,

COUNT(MS_OP_PL_CL_ACC) AS NUM_MS_OP_PL_CL_ACC,
MAX(MS_OP_PL_CL_ACC)   AS MAX_MS_OP_PL_CL_ACC,
SUM(MS_OP_PL_CL_ACC)   AS SUM_MS_OP_PL_CL_ACC,
MIN(MS_OP_PL_CL_ACC)   AS MIN_MS_OP_PL_CL_ACC,
MAX(MS_OP_PL_CL_ACC) - MIN(MS_OP_PL_CL_ACC) AS DIF_MS_OP_PL_CL_ACC,
SUM(MS_OP_PL_CL_ACC)/NULLIF(COUNT(MS_OP_PL_CL_ACC),0) AS AVG_MS_OP_PL_CL_ACC,

COUNT(MS_OP_PL_OP_ACC) AS NUM_MS_OP_PL_OP_ACC,
MAX(MS_OP_PL_OP_ACC)   AS MAX_MS_OP_PL_OP_ACC,
SUM(MS_OP_PL_OP_ACC)   AS SUM_MS_OP_PL_OP_ACC,
MIN(MS_OP_PL_OP_ACC)   AS MIN_MS_OP_PL_OP_ACC,
MAX(MS_OP_PL_OP_ACC) - MIN(MS_OP_PL_OP_ACC) AS DIF_MS_OP_PL_OP_ACC,
SUM(MS_OP_PL_OP_ACC)/NULLIF(COUNT(MS_OP_PL_OP_ACC),0) AS AVG_MS_OP_PL_OP_ACC,

COUNT(MS_OP_PL) AS NUM_MS_OP_PL,
MAX(MS_OP_PL)   AS MAX_MS_OP_PL,
SUM(MS_OP_PL)   AS SUM_MS_OP_PL,
MIN(MS_OP_PL)   AS MIN_MS_OP_PL,
MAX(MS_OP_PL) - MIN(MS_OP_PL) AS DIF_MS_OP_PL,
SUM(MS_OP_PL)/NULLIF(COUNT(MS_OP_PL),0) AS AVG_MS_OP_PL,

COUNT(MS_OP_R_CL_ACC) AS NUM_MS_OP_R_CL_ACC,
MAX(MS_OP_R_CL_ACC)   AS MAX_MS_OP_R_CL_ACC,
SUM(MS_OP_R_CL_ACC)   AS SUM_MS_OP_R_CL_ACC,
MIN(MS_OP_R_CL_ACC)   AS MIN_MS_OP_R_CL_ACC,
MAX(MS_OP_R_CL_ACC) - MIN(MS_OP_R_CL_ACC) AS DIF_MS_OP_R_CL_ACC,
SUM(MS_OP_R_CL_ACC)/NULLIF(COUNT(MS_OP_R_CL_ACC),0) AS AVG_MS_OP_R_CL_ACC,

COUNT(MS_OP_R_OP_ACC) AS NUM_MS_OP_R_OP_ACC,
MAX(MS_OP_R_OP_ACC)   AS MAX_MS_OP_R_OP_ACC,
SUM(MS_OP_R_OP_ACC)   AS SUM_MS_OP_R_OP_ACC,
MIN(MS_OP_R_OP_ACC)   AS MIN_MS_OP_R_OP_ACC,
MAX(MS_OP_R_OP_ACC) - MIN(MS_OP_R_OP_ACC) AS DIF_MS_OP_R_OP_ACC,
SUM(MS_OP_R_OP_ACC)/NULLIF(COUNT(MS_OP_R_OP_ACC),0) AS AVG_MS_OP_R_OP_ACC,

COUNT(MS_OP_R) AS NUM_MS_OP_R,
MAX(MS_OP_R)   AS MAX_MS_OP_R,
SUM(MS_OP_R)   AS SUM_MS_OP_R,
MIN(MS_OP_R)   AS MIN_MS_OP_R,
MAX(MS_OP_R) - MIN(MS_OP_R) AS DIF_MS_OP_R,
SUM(MS_OP_R)/NULLIF(COUNT(MS_OP_R),0) AS AVG_MS_OP_R,

COUNT(MS_OP_CL_ACC) AS NUM_MS_OP_CL_ACC,
MAX(MS_OP_CL_ACC)   AS MAX_MS_OP_CL_ACC,
SUM(MS_OP_CL_ACC)   AS SUM_MS_OP_CL_ACC,
MIN(MS_OP_CL_ACC)   AS MIN_MS_OP_CL_ACC,
MAX(MS_OP_CL_ACC) - MIN(MS_OP_CL_ACC) AS DIF_MS_OP_CL_ACC,
SUM(MS_OP_CL_ACC)/NULLIF(COUNT(MS_OP_CL_ACC),0) AS AVG_MS_OP_CL_ACC,

COUNT(MS_OP_OP_ACC) AS NUM_MS_OP_OP_ACC,
MAX(MS_OP_OP_ACC)   AS MAX_MS_OP_OP_ACC,
SUM(MS_OP_OP_ACC)   AS SUM_MS_OP_OP_ACC,
MIN(MS_OP_OP_ACC)   AS MIN_MS_OP_OP_ACC,
MAX(MS_OP_OP_ACC) - MIN(MS_OP_OP_ACC) AS DIF_MS_OP_OP_ACC,
SUM(MS_OP_OP_ACC)/NULLIF(COUNT(MS_OP_OP_ACC),0) AS AVG_MS_OP_OP_ACC,

COUNT(MS_OP) AS NUM_MS_OP,
MAX(MS_OP)   AS MAX_MS_OP,
SUM(MS_OP)   AS SUM_MS_OP,
MIN(MS_OP)   AS MIN_MS_OP,
MAX(MS_OP) - MIN(MS_OP) AS DIF_MS_OP,
SUM(MS_OP)/NULLIF(COUNT(MS_OP),0) AS AVG_MS_OP,


COUNT(MS_OP_TU_ALL) AS NUM_MS_OP_TU_ALL,
MAX(MS_OP_TU_ALL)   AS MAX_MS_OP_TU_ALL,
SUM(MS_OP_TU_ALL)   AS SUM_MS_OP_TU_ALL,
MIN(MS_OP_TU_ALL)   AS MIN_MS_OP_TU_ALL,
MAX(MS_OP_TU_ALL) - MIN(MS_OP_TU_ALL) AS DIF_MS_OP_TU_ALL,
SUM(MS_OP_TU_ALL)/NULLIF(COUNT(MS_OP_TU_ALL),0) AS AVG_MS_OP_TU_ALL,

COUNT(MS_OP_TU) AS NUM_MS_OP_TU,
MAX(MS_OP_TU)   AS MAX_MS_OP_TU,
SUM(MS_OP_TU)   AS SUM_MS_OP_TU,
MIN(MS_OP_TU)   AS MIN_MS_OP_TU,
MAX(MS_OP_TU) - MIN(MS_OP_TU) AS DIF_MS_OP_TU,
SUM(MS_OP_TU)/NULLIF(COUNT(MS_OP_TU),0) AS AVG_MS_OP_TU,

COUNT(MS_OP_TU_ALL_OP_ACC) AS NUM_MS_OP_TU_ALL_OP_ACC,
MAX(MS_OP_TU_ALL_OP_ACC)   AS MAX_MS_OP_TU_ALL_OP_ACC,
SUM(MS_OP_TU_ALL_OP_ACC)   AS SUM_MS_OP_TU_ALL_OP_ACC,
MIN(MS_OP_TU_ALL_OP_ACC)   AS MIN_MS_OP_TU_ALL_OP_ACC,
MAX(MS_OP_TU_ALL_OP_ACC) - MIN(MS_OP_TU_ALL_OP_ACC) AS DIF_MS_OP_TU_ALL_OP_ACC,
SUM(MS_OP_TU_ALL_OP_ACC)/NULLIF(COUNT(MS_OP),0) AS AVG_MS_OP_TU_ALL_OP_ACC,

COUNT(MS_OP_TU_OP_ACC) AS NUM_MS_OP_TU_OP_ACC,
MAX(MS_OP_TU_OP_ACC)   AS MAX_MS_OP_TU_OP_ACC,
SUM(MS_OP_TU_OP_ACC)   AS SUM_MS_OP_TU_OP_ACC,
MIN(MS_OP_TU_OP_ACC)   AS MIN_MS_OP_TU_OP_ACC,
MAX(MS_OP_TU_OP_ACC) - MIN(MS_OP_TU_OP_ACC) AS DIF_MS_OP_TU_OP_ACC,
SUM(MS_OP_TU_OP_ACC)/NULLIF(COUNT(MS_OP_TU_OP_ACC),0) AS AVG_MS_OP_TU_OP_ACC,

COUNT(MS_OP_TU_ALL_CL_ACC) AS NUM_MS_OP_TU_ALL_CL_ACC,
MAX(MS_OP_TU_ALL_CL_ACC)   AS MAX_MS_OP_TU_ALL_CL_ACC,
SUM(MS_OP_TU_ALL_CL_ACC)   AS SUM_MS_OP_TU_ALL_CL_ACC,
MIN(MS_OP_TU_ALL_CL_ACC)   AS MIN_MS_OP_TU_ALL_CL_ACC,
MAX(MS_OP_TU_ALL_CL_ACC) - MIN(MS_OP_TU_ALL_CL_ACC) AS DIF_MS_OP_TU_ALL_CL_ACC,
SUM(MS_OP_TU_ALL_CL_ACC)/NULLIF(COUNT(MS_OP_TU_ALL_CL_ACC),0) AS AVG_MS_OP_TU_ALL_CL_ACC,

COUNT(MS_OP_TU_CL_ACC) AS NUM_MS_OP_TU_CL_ACC,
MAX(MS_OP_TU_CL_ACC)   AS MAX_MS_OP_TU_CL_ACC,
SUM(MS_OP_TU_CL_ACC)   AS SUM_MS_OP_TU_CL_ACC,
MIN(MS_OP_TU_CL_ACC)   AS MIN_MS_OP_TU_CL_ACC,
MAX(MS_OP_TU_CL_ACC) - MIN(MS_OP_TU_CL_ACC) AS DIF_MS_OP_TU_CL_ACC,
SUM(MS_OP_TU_CL_ACC)/NULLIF(COUNT(MS_OP_TU_CL_ACC),0) AS AVG_MS_OP_TU_CL_ACC,

COUNT(MS_OP_NBK_TU) AS NUM_MS_OP_NBK_TU,
MAX(MS_OP_NBK_TU)   AS MAX_MS_OP_NBK_TU,
SUM(MS_OP_NBK_TU)   AS SUM_MS_OP_NBK_TU,
MIN(MS_OP_NBK_TU)   AS MIN_MS_OP_NBK_TU,
MAX(MS_OP_NBK_TU) - MIN(MS_OP_NBK_TU) AS DIF_MS_OP_NBK_TU,
SUM(MS_OP_NBK_TU)/NULLIF(COUNT(MS_OP_NBK_TU),0) AS AVG_MS_OP_NBK_TU,

COUNT(MS_OP_NBK_TU_OP_ACC) AS NUM_MS_OP_NBK_TU_OP_ACC,
MAX(MS_OP_NBK_TU_OP_ACC)   AS MAX_MS_OP_NBK_TU_OP_ACC,
SUM(MS_OP_NBK_TU_OP_ACC)   AS SUM_MS_OP_NBK_TU_OP_ACC,
MIN(MS_OP_NBK_TU_OP_ACC)   AS MIN_MS_OP_NBK_TU_OP_ACC,
MAX(MS_OP_NBK_TU_OP_ACC) - MIN(MS_OP_NBK_TU_OP_ACC) AS DIF_MS_OP_NBK_TU_OP_ACC,
SUM(MS_OP_NBK_TU_OP_ACC)/NULLIF(COUNT(MS_OP_NBK_TU_OP_ACC),0) AS AVG_MS_OP_NBK_TU_OP_ACC,

COUNT(MS_OP_NBK_TU_CL_ACC) AS NUM_MS_OP_NBK_TU_CL_ACC,
MAX(MS_OP_NBK_TU_CL_ACC)   AS MAX_MS_OP_NBK_TU_CL_ACC,
SUM(MS_OP_NBK_TU_CL_ACC)   AS SUM_MS_OP_NBK_TU_CL_ACC,
MIN(MS_OP_NBK_TU_CL_ACC)   AS MIN_MS_OP_NBK_TU_CL_ACC,
MAX(MS_OP_NBK_TU_CL_ACC) - MIN(MS_OP_NBK_TU_CL_ACC) AS DIF_MS_OP_NBK_TU_CL_ACC,
SUM(MS_OP_NBK_TU_CL_ACC)/NULLIF(COUNT(MS_OP_NBK_TU_CL_ACC),0) AS AVG_MS_OP_NBK_TU_CL_ACC

FROM dbmymwork.BTDC_LGG_VAR_SEGMENTADAS_1
GROUP BY CUENTADEREFERENCIA,
FECHA_CARTERA
;

SELECT * FROM  dbmymwork.BTDC_LGG_VAR_MS_OP LIMIT 100;