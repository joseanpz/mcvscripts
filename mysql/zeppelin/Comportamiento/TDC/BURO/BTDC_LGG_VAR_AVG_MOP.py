%hive

DROP TABLE IF EXISTS dbmymwork.BTDC_LGG_VAR_AVG_MOP;
CREATE TABLE dbmymwork.BTDC_LGG_VAR_AVG_MOP
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/BTDC/VARIABLES/BTDC_LGG_VAR_AVG_MOP' AS

SELECT
CUENTADEREFERENCIA,
FECHA_CARTERA,

COUNT(AVG_MOP_BK_AU_CL_ACC ) AS NUM_AVG_MOP_BK_AU_CL_ACC    ,
COUNT(AVG_MOP_BK_AU_OP_ACC ) AS NUM_AVG_MOP_BK_AU_OP_ACC    ,
COUNT(AVG_MOP_BK_AU        ) AS NUM_AVG_MOP_BK_AU           ,
COUNT(AVG_MOP_BK_M_CL_ACC  ) AS NUM_AVG_MOP_BK_M_CL_ACC     ,
COUNT(AVG_MOP_BK_M_OP_ACC  ) AS NUM_AVG_MOP_BK_M_OP_ACC     ,
COUNT(AVG_MOP_BK_M         ) AS NUM_AVG_MOP_BK_M            ,
COUNT(AVG_MOP_BK_PL_CL_ACC ) AS NUM_AVG_MOP_BK_PL_CL_ACC    ,
COUNT(AVG_MOP_BK_PL_OP_ACC ) AS NUM_AVG_MOP_BK_PL_OP_ACC    ,
COUNT(AVG_MOP_BK_PL        ) AS NUM_AVG_MOP_BK_PL           ,
COUNT(AVG_MOP_BK_R_CL_ACC  ) AS NUM_AVG_MOP_BK_R_CL_ACC     ,
COUNT(AVG_MOP_BK_R_OP_ACC  ) AS NUM_AVG_MOP_BK_R_OP_ACC     ,
COUNT(AVG_MOP_BK_R         ) AS NUM_AVG_MOP_BK_R            ,
COUNT(AVG_MOP_BK_CL_ACC    ) AS NUM_AVG_MOP_BK_CL_ACC       ,
COUNT(AVG_MOP_BK_OP_ACC    ) AS NUM_AVG_MOP_BK_OP_ACC       ,
COUNT(AVG_MOP_BK           ) AS NUM_AVG_MOP_BK              ,
COUNT(AVG_MOP_NBK_AU_CL_ACC) AS NUM_AVG_MOP_NBK_AU_CL_ACC   ,
COUNT(AVG_MOP_NBK_AU_OP_ACC) AS NUM_AVG_MOP_NBK_AU_OP_ACC   ,
COUNT(AVG_MOP_NBK_AU       ) AS NUM_AVG_MOP_NBK_AU          ,
COUNT(AVG_MOP_NBK_M_CL_ACC ) AS NUM_AVG_MOP_NBK_M_CL_ACC    ,
COUNT(AVG_MOP_NBK_M_OP_ACC ) AS NUM_AVG_MOP_NBK_M_OP_ACC    ,
COUNT(AVG_MOP_NBK_M        ) AS NUM_AVG_MOP_NBK_M           ,
COUNT(AVG_MOP_NBK_PL_CL_ACC) AS NUM_AVG_MOP_NBK_PL_CL_ACC   ,
COUNT(AVG_MOP_NBK_PL_OP_ACC) AS NUM_AVG_MOP_NBK_PL_OP_ACC   ,
COUNT(AVG_MOP_NBK_PL       ) AS NUM_AVG_MOP_NBK_PL          ,
COUNT(AVG_MOP_NBK_R_CL_ACC ) AS NUM_AVG_MOP_NBK_R_CL_ACC    ,
COUNT(AVG_MOP_NBK_R_OP_ACC ) AS NUM_AVG_MOP_NBK_R_OP_ACC    ,
COUNT(AVG_MOP_NBK_R        ) AS NUM_AVG_MOP_NBK_R           ,
COUNT(AVG_MOP_NBK_CL_ACC   ) AS NUM_AVG_MOP_NBK_CL_ACC      ,
COUNT(AVG_MOP_NBK_OP_ACC   ) AS NUM_AVG_MOP_NBK_OP_ACC      ,
COUNT(AVG_MOP_NBK          ) AS NUM_AVG_MOP_NBK             ,
COUNT(AVG_MOP_AMX_CL_ACC   ) AS NUM_AVG_MOP_AMX_CL_ACC      ,
COUNT(AVG_MOP_AMX_OP_ACC   ) AS NUM_AVG_MOP_AMX_OP_ACC      ,
COUNT(AVG_MOP_AMX          ) AS NUM_AVG_MOP_AMX             ,
COUNT(AVG_MOP_AU_CL_ACC    ) AS NUM_AVG_MOP_AU_CL_ACC       ,
COUNT(AVG_MOP_AU_OP_ACC    ) AS NUM_AVG_MOP_AU_OP_ACC       ,
COUNT(AVG_MOP_AU           ) AS NUM_AVG_MOP_AU              ,
COUNT(AVG_MOP_M_CL_ACC     ) AS NUM_AVG_MOP_M_CL_ACC        ,
COUNT(AVG_MOP_M_OP_ACC     ) AS NUM_AVG_MOP_M_OP_ACC        ,
COUNT(AVG_MOP_M            ) AS NUM_AVG_MOP_M               ,
COUNT(AVG_MOP_PL_CL_ACC    ) AS NUM_AVG_MOP_PL_CL_ACC       ,
COUNT(AVG_MOP_PL_OP_ACC    ) AS NUM_AVG_MOP_PL_OP_ACC       ,
COUNT(AVG_MOP_PL           ) AS NUM_AVG_MOP_PL              ,
COUNT(AVG_MOP_R_CL_ACC     ) AS NUM_AVG_MOP_R_CL_ACC        ,
COUNT(AVG_MOP_R_OP_ACC     ) AS NUM_AVG_MOP_R_OP_ACC        ,
COUNT(AVG_MOP_R            ) AS NUM_AVG_MOP_R               ,
COUNT(AVG_MOP_CL_ACC       ) AS NUM_AVG_MOP_CL_ACC          ,
COUNT(AVG_MOP_OP_ACC       ) AS NUM_AVG_MOP_OP_ACC          ,
COUNT(AVG_MOP              ) AS NUM_AVG_MOP                 ,
COUNT(AVG_MOP_TU_ALL       ) AS NUM_AVG_MOP_TU_ALL          ,
COUNT(AVG_MOP_TU           ) AS NUM_AVG_MOP_TU              ,
COUNT(AVG_MOP_TU_ALL_OP_ACC) AS NUM_AVG_MOP_TU_ALL_OP_ACC   ,
COUNT(AVG_MOP_TU_OP_ACC    ) AS NUM_AVG_MOP_TU_OP_ACC       ,
COUNT(AVG_MOP_TU_ALL_CL_ACC) AS NUM_AVG_MOP_TU_ALL_CL_ACC   ,
COUNT(AVG_MOP_TU_CL_ACC    ) AS NUM_AVG_MOP_TU_CL_ACC       ,
COUNT(AVG_MOP_NBK_TU       ) AS NUM_AVG_MOP_NBK_TU          ,
COUNT(AVG_MOP_NBK_TU_OP_ACC) AS NUM_AVG_MOP_NBK_TU_OP_ACC   ,
COUNT(AVG_MOP_NBK_TU_CL_ACC) AS NUM_AVG_MOP_NBK_TU_CL_ACC   ,

SUM(AVG_MOP_BK_AU_CL_ACC ) AS SUM_AVG_MOP_BK_AU_CL_ACC    ,
SUM(AVG_MOP_BK_AU_OP_ACC ) AS SUM_AVG_MOP_BK_AU_OP_ACC    ,
SUM(AVG_MOP_BK_AU        ) AS SUM_AVG_MOP_BK_AU           ,
SUM(AVG_MOP_BK_M_CL_ACC  ) AS SUM_AVG_MOP_BK_M_CL_ACC     ,
SUM(AVG_MOP_BK_M_OP_ACC  ) AS SUM_AVG_MOP_BK_M_OP_ACC     ,
SUM(AVG_MOP_BK_M         ) AS SUM_AVG_MOP_BK_M            ,
SUM(AVG_MOP_BK_PL_CL_ACC ) AS SUM_AVG_MOP_BK_PL_CL_ACC    ,
SUM(AVG_MOP_BK_PL_OP_ACC ) AS SUM_AVG_MOP_BK_PL_OP_ACC    ,
SUM(AVG_MOP_BK_PL        ) AS SUM_AVG_MOP_BK_PL           ,
SUM(AVG_MOP_BK_R_CL_ACC  ) AS SUM_AVG_MOP_BK_R_CL_ACC     ,
SUM(AVG_MOP_BK_R_OP_ACC  ) AS SUM_AVG_MOP_BK_R_OP_ACC     ,
SUM(AVG_MOP_BK_R         ) AS SUM_AVG_MOP_BK_R            ,
SUM(AVG_MOP_BK_CL_ACC    ) AS SUM_AVG_MOP_BK_CL_ACC       ,
SUM(AVG_MOP_BK_OP_ACC    ) AS SUM_AVG_MOP_BK_OP_ACC       ,
SUM(AVG_MOP_BK           ) AS SUM_AVG_MOP_BK              ,
SUM(AVG_MOP_NBK_AU_CL_ACC) AS SUM_AVG_MOP_NBK_AU_CL_ACC   ,
SUM(AVG_MOP_NBK_AU_OP_ACC) AS SUM_AVG_MOP_NBK_AU_OP_ACC   ,
SUM(AVG_MOP_NBK_AU       ) AS SUM_AVG_MOP_NBK_AU          ,
SUM(AVG_MOP_NBK_M_CL_ACC ) AS SUM_AVG_MOP_NBK_M_CL_ACC    ,
SUM(AVG_MOP_NBK_M_OP_ACC ) AS SUM_AVG_MOP_NBK_M_OP_ACC    ,
SUM(AVG_MOP_NBK_M        ) AS SUM_AVG_MOP_NBK_M           ,
SUM(AVG_MOP_NBK_PL_CL_ACC) AS SUM_AVG_MOP_NBK_PL_CL_ACC   ,
SUM(AVG_MOP_NBK_PL_OP_ACC) AS SUM_AVG_MOP_NBK_PL_OP_ACC   ,
SUM(AVG_MOP_NBK_PL       ) AS SUM_AVG_MOP_NBK_PL          ,
SUM(AVG_MOP_NBK_R_CL_ACC ) AS SUM_AVG_MOP_NBK_R_CL_ACC    ,
SUM(AVG_MOP_NBK_R_OP_ACC ) AS SUM_AVG_MOP_NBK_R_OP_ACC    ,
SUM(AVG_MOP_NBK_R        ) AS SUM_AVG_MOP_NBK_R           ,
SUM(AVG_MOP_NBK_CL_ACC   ) AS SUM_AVG_MOP_NBK_CL_ACC      ,
SUM(AVG_MOP_NBK_OP_ACC   ) AS SUM_AVG_MOP_NBK_OP_ACC      ,
SUM(AVG_MOP_NBK          ) AS SUM_AVG_MOP_NBK             ,
SUM(AVG_MOP_AMX_CL_ACC   ) AS SUM_AVG_MOP_AMX_CL_ACC      ,
SUM(AVG_MOP_AMX_OP_ACC   ) AS SUM_AVG_MOP_AMX_OP_ACC      ,
SUM(AVG_MOP_AMX          ) AS SUM_AVG_MOP_AMX             ,
SUM(AVG_MOP_AU_CL_ACC    ) AS SUM_AVG_MOP_AU_CL_ACC       ,
SUM(AVG_MOP_AU_OP_ACC    ) AS SUM_AVG_MOP_AU_OP_ACC       ,
SUM(AVG_MOP_AU           ) AS SUM_AVG_MOP_AU              ,
SUM(AVG_MOP_M_CL_ACC     ) AS SUM_AVG_MOP_M_CL_ACC        ,
SUM(AVG_MOP_M_OP_ACC     ) AS SUM_AVG_MOP_M_OP_ACC        ,
SUM(AVG_MOP_M            ) AS SUM_AVG_MOP_M               ,
SUM(AVG_MOP_PL_CL_ACC    ) AS SUM_AVG_MOP_PL_CL_ACC       ,
SUM(AVG_MOP_PL_OP_ACC    ) AS SUM_AVG_MOP_PL_OP_ACC       ,
SUM(AVG_MOP_PL           ) AS SUM_AVG_MOP_PL              ,
SUM(AVG_MOP_R_CL_ACC     ) AS SUM_AVG_MOP_R_CL_ACC        ,
SUM(AVG_MOP_R_OP_ACC     ) AS SUM_AVG_MOP_R_OP_ACC        ,
SUM(AVG_MOP_R            ) AS SUM_AVG_MOP_R               ,
SUM(AVG_MOP_CL_ACC       ) AS SUM_AVG_MOP_CL_ACC          ,
SUM(AVG_MOP_OP_ACC       ) AS SUM_AVG_MOP_OP_ACC          ,
SUM(AVG_MOP              ) AS SUM_AVG_MOP                 ,
SUM(AVG_MOP_TU_ALL       ) AS SUM_AVG_MOP_TU_ALL          ,
SUM(AVG_MOP_TU           ) AS SUM_AVG_MOP_TU              ,
SUM(AVG_MOP_TU_ALL_OP_ACC) AS SUM_AVG_MOP_TU_ALL_OP_ACC   ,
SUM(AVG_MOP_TU_OP_ACC    ) AS SUM_AVG_MOP_TU_OP_ACC       ,
SUM(AVG_MOP_TU_ALL_CL_ACC) AS SUM_AVG_MOP_TU_ALL_CL_ACC   ,
SUM(AVG_MOP_TU_CL_ACC    ) AS SUM_AVG_MOP_TU_CL_ACC       ,
SUM(AVG_MOP_NBK_TU       ) AS SUM_AVG_MOP_NBK_TU          ,
SUM(AVG_MOP_NBK_TU_OP_ACC) AS SUM_AVG_MOP_NBK_TU_OP_ACC   ,
SUM(AVG_MOP_NBK_TU_CL_ACC) AS SUM_AVG_MOP_NBK_TU_CL_ACC   ,

MAX(AVG_MOP_BK_AU_CL_ACC ) AS MAX_AVG_MOP_BK_AU_CL_ACC    ,
MAX(AVG_MOP_BK_AU_OP_ACC ) AS MAX_AVG_MOP_BK_AU_OP_ACC    ,
MAX(AVG_MOP_BK_AU        ) AS MAX_AVG_MOP_BK_AU           ,
MAX(AVG_MOP_BK_M_CL_ACC  ) AS MAX_AVG_MOP_BK_M_CL_ACC     ,
MAX(AVG_MOP_BK_M_OP_ACC  ) AS MAX_AVG_MOP_BK_M_OP_ACC     ,
MAX(AVG_MOP_BK_M         ) AS MAX_AVG_MOP_BK_M            ,
MAX(AVG_MOP_BK_PL_CL_ACC ) AS MAX_AVG_MOP_BK_PL_CL_ACC    ,
MAX(AVG_MOP_BK_PL_OP_ACC ) AS MAX_AVG_MOP_BK_PL_OP_ACC    ,
MAX(AVG_MOP_BK_PL        ) AS MAX_AVG_MOP_BK_PL           ,
MAX(AVG_MOP_BK_R_CL_ACC  ) AS MAX_AVG_MOP_BK_R_CL_ACC     ,
MAX(AVG_MOP_BK_R_OP_ACC  ) AS MAX_AVG_MOP_BK_R_OP_ACC     ,
MAX(AVG_MOP_BK_R         ) AS MAX_AVG_MOP_BK_R            ,
MAX(AVG_MOP_BK_CL_ACC    ) AS MAX_AVG_MOP_BK_CL_ACC       ,
MAX(AVG_MOP_BK_OP_ACC    ) AS MAX_AVG_MOP_BK_OP_ACC       ,
MAX(AVG_MOP_BK           ) AS MAX_AVG_MOP_BK              ,
MAX(AVG_MOP_NBK_AU_CL_ACC) AS MAX_AVG_MOP_NBK_AU_CL_ACC   ,
MAX(AVG_MOP_NBK_AU_OP_ACC) AS MAX_AVG_MOP_NBK_AU_OP_ACC   ,
MAX(AVG_MOP_NBK_AU       ) AS MAX_AVG_MOP_NBK_AU          ,
MAX(AVG_MOP_NBK_M_CL_ACC ) AS MAX_AVG_MOP_NBK_M_CL_ACC    ,
MAX(AVG_MOP_NBK_M_OP_ACC ) AS MAX_AVG_MOP_NBK_M_OP_ACC    ,
MAX(AVG_MOP_NBK_M        ) AS MAX_AVG_MOP_NBK_M           ,
MAX(AVG_MOP_NBK_PL_CL_ACC) AS MAX_AVG_MOP_NBK_PL_CL_ACC   ,
MAX(AVG_MOP_NBK_PL_OP_ACC) AS MAX_AVG_MOP_NBK_PL_OP_ACC   ,
MAX(AVG_MOP_NBK_PL       ) AS MAX_AVG_MOP_NBK_PL          ,
MAX(AVG_MOP_NBK_R_CL_ACC ) AS MAX_AVG_MOP_NBK_R_CL_ACC    ,
MAX(AVG_MOP_NBK_R_OP_ACC ) AS MAX_AVG_MOP_NBK_R_OP_ACC    ,
MAX(AVG_MOP_NBK_R        ) AS MAX_AVG_MOP_NBK_R           ,
MAX(AVG_MOP_NBK_CL_ACC   ) AS MAX_AVG_MOP_NBK_CL_ACC      ,
MAX(AVG_MOP_NBK_OP_ACC   ) AS MAX_AVG_MOP_NBK_OP_ACC      ,
MAX(AVG_MOP_NBK          ) AS MAX_AVG_MOP_NBK             ,
MAX(AVG_MOP_AMX_CL_ACC   ) AS MAX_AVG_MOP_AMX_CL_ACC      ,
MAX(AVG_MOP_AMX_OP_ACC   ) AS MAX_AVG_MOP_AMX_OP_ACC      ,
MAX(AVG_MOP_AMX          ) AS MAX_AVG_MOP_AMX             ,
MAX(AVG_MOP_AU_CL_ACC    ) AS MAX_AVG_MOP_AU_CL_ACC       ,
MAX(AVG_MOP_AU_OP_ACC    ) AS MAX_AVG_MOP_AU_OP_ACC       ,
MAX(AVG_MOP_AU           ) AS MAX_AVG_MOP_AU              ,
MAX(AVG_MOP_M_CL_ACC     ) AS MAX_AVG_MOP_M_CL_ACC        ,
MAX(AVG_MOP_M_OP_ACC     ) AS MAX_AVG_MOP_M_OP_ACC        ,
MAX(AVG_MOP_M            ) AS MAX_AVG_MOP_M               ,
MAX(AVG_MOP_PL_CL_ACC    ) AS MAX_AVG_MOP_PL_CL_ACC       ,
MAX(AVG_MOP_PL_OP_ACC    ) AS MAX_AVG_MOP_PL_OP_ACC       ,
MAX(AVG_MOP_PL           ) AS MAX_AVG_MOP_PL              ,
MAX(AVG_MOP_R_CL_ACC     ) AS MAX_AVG_MOP_R_CL_ACC        ,
MAX(AVG_MOP_R_OP_ACC     ) AS MAX_AVG_MOP_R_OP_ACC        ,
MAX(AVG_MOP_R            ) AS MAX_AVG_MOP_R               ,
MAX(AVG_MOP_CL_ACC       ) AS MAX_AVG_MOP_CL_ACC          ,
MAX(AVG_MOP_OP_ACC       ) AS MAX_AVG_MOP_OP_ACC          ,
MAX(AVG_MOP              ) AS MAX_AVG_MOP                 ,
MAX(AVG_MOP_TU_ALL       ) AS MAX_AVG_MOP_TU_ALL          ,
MAX(AVG_MOP_TU           ) AS MAX_AVG_MOP_TU              ,
MAX(AVG_MOP_TU_ALL_OP_ACC) AS MAX_AVG_MOP_TU_ALL_OP_ACC   ,
MAX(AVG_MOP_TU_OP_ACC    ) AS MAX_AVG_MOP_TU_OP_ACC       ,
MAX(AVG_MOP_TU_ALL_CL_ACC) AS MAX_AVG_MOP_TU_ALL_CL_ACC   ,
MAX(AVG_MOP_TU_CL_ACC    ) AS MAX_AVG_MOP_TU_CL_ACC       ,
MAX(AVG_MOP_NBK_TU       ) AS MAX_AVG_MOP_NBK_TU          ,
MAX(AVG_MOP_NBK_TU_OP_ACC) AS MAX_AVG_MOP_NBK_TU_OP_ACC   ,
MAX(AVG_MOP_NBK_TU_CL_ACC) AS MAX_AVG_MOP_NBK_TU_CL_ACC   ,

MIN(AVG_MOP_BK_AU_CL_ACC ) AS MIN_AVG_MOP_BK_AU_CL_ACC    ,
MIN(AVG_MOP_BK_AU_OP_ACC ) AS MIN_AVG_MOP_BK_AU_OP_ACC    ,
MIN(AVG_MOP_BK_AU        ) AS MIN_AVG_MOP_BK_AU           ,
MIN(AVG_MOP_BK_M_CL_ACC  ) AS MIN_AVG_MOP_BK_M_CL_ACC     ,
MIN(AVG_MOP_BK_M_OP_ACC  ) AS MIN_AVG_MOP_BK_M_OP_ACC     ,
MIN(AVG_MOP_BK_M         ) AS MIN_AVG_MOP_BK_M            ,
MIN(AVG_MOP_BK_PL_CL_ACC ) AS MIN_AVG_MOP_BK_PL_CL_ACC    ,
MIN(AVG_MOP_BK_PL_OP_ACC ) AS MIN_AVG_MOP_BK_PL_OP_ACC    ,
MIN(AVG_MOP_BK_PL        ) AS MIN_AVG_MOP_BK_PL           ,
MIN(AVG_MOP_BK_R_CL_ACC  ) AS MIN_AVG_MOP_BK_R_CL_ACC     ,
MIN(AVG_MOP_BK_R_OP_ACC  ) AS MIN_AVG_MOP_BK_R_OP_ACC     ,
MIN(AVG_MOP_BK_R         ) AS MIN_AVG_MOP_BK_R            ,
MIN(AVG_MOP_BK_CL_ACC    ) AS MIN_AVG_MOP_BK_CL_ACC       ,
MIN(AVG_MOP_BK_OP_ACC    ) AS MIN_AVG_MOP_BK_OP_ACC       ,
MIN(AVG_MOP_BK           ) AS MIN_AVG_MOP_BK              ,
MIN(AVG_MOP_NBK_AU_CL_ACC) AS MIN_AVG_MOP_NBK_AU_CL_ACC   ,
MIN(AVG_MOP_NBK_AU_OP_ACC) AS MIN_AVG_MOP_NBK_AU_OP_ACC   ,
MIN(AVG_MOP_NBK_AU       ) AS MIN_AVG_MOP_NBK_AU          ,
MIN(AVG_MOP_NBK_M_CL_ACC ) AS MIN_AVG_MOP_NBK_M_CL_ACC    ,
MIN(AVG_MOP_NBK_M_OP_ACC ) AS MIN_AVG_MOP_NBK_M_OP_ACC    ,
MIN(AVG_MOP_NBK_M        ) AS MIN_AVG_MOP_NBK_M           ,
MIN(AVG_MOP_NBK_PL_CL_ACC) AS MIN_AVG_MOP_NBK_PL_CL_ACC   ,
MIN(AVG_MOP_NBK_PL_OP_ACC) AS MIN_AVG_MOP_NBK_PL_OP_ACC   ,
MIN(AVG_MOP_NBK_PL       ) AS MIN_AVG_MOP_NBK_PL          ,
MIN(AVG_MOP_NBK_R_CL_ACC ) AS MIN_AVG_MOP_NBK_R_CL_ACC    ,
MIN(AVG_MOP_NBK_R_OP_ACC ) AS MIN_AVG_MOP_NBK_R_OP_ACC    ,
MIN(AVG_MOP_NBK_R        ) AS MIN_AVG_MOP_NBK_R           ,
MIN(AVG_MOP_NBK_CL_ACC   ) AS MIN_AVG_MOP_NBK_CL_ACC      ,
MIN(AVG_MOP_NBK_OP_ACC   ) AS MIN_AVG_MOP_NBK_OP_ACC      ,
MIN(AVG_MOP_NBK          ) AS MIN_AVG_MOP_NBK             ,
MIN(AVG_MOP_AMX_CL_ACC   ) AS MIN_AVG_MOP_AMX_CL_ACC      ,
MIN(AVG_MOP_AMX_OP_ACC   ) AS MIN_AVG_MOP_AMX_OP_ACC      ,
MIN(AVG_MOP_AMX          ) AS MIN_AVG_MOP_AMX             ,
MIN(AVG_MOP_AU_CL_ACC    ) AS MIN_AVG_MOP_AU_CL_ACC       ,
MIN(AVG_MOP_AU_OP_ACC    ) AS MIN_AVG_MOP_AU_OP_ACC       ,
MIN(AVG_MOP_AU           ) AS MIN_AVG_MOP_AU              ,
MIN(AVG_MOP_M_CL_ACC     ) AS MIN_AVG_MOP_M_CL_ACC        ,
MIN(AVG_MOP_M_OP_ACC     ) AS MIN_AVG_MOP_M_OP_ACC        ,
MIN(AVG_MOP_M            ) AS MIN_AVG_MOP_M               ,
MIN(AVG_MOP_PL_CL_ACC    ) AS MIN_AVG_MOP_PL_CL_ACC       ,
MIN(AVG_MOP_PL_OP_ACC    ) AS MIN_AVG_MOP_PL_OP_ACC       ,
MIN(AVG_MOP_PL           ) AS MIN_AVG_MOP_PL              ,
MIN(AVG_MOP_R_CL_ACC     ) AS MIN_AVG_MOP_R_CL_ACC        ,
MIN(AVG_MOP_R_OP_ACC     ) AS MIN_AVG_MOP_R_OP_ACC        ,
MIN(AVG_MOP_R            ) AS MIN_AVG_MOP_R               ,
MIN(AVG_MOP_CL_ACC       ) AS MIN_AVG_MOP_CL_ACC          ,
MIN(AVG_MOP_OP_ACC       ) AS MIN_AVG_MOP_OP_ACC          ,
MIN(AVG_MOP              ) AS MIN_AVG_MOP                 ,
MIN(AVG_MOP_TU_ALL       ) AS MIN_AVG_MOP_TU_ALL          ,
MIN(AVG_MOP_TU           ) AS MIN_AVG_MOP_TU              ,
MIN(AVG_MOP_TU_ALL_OP_ACC) AS MIN_AVG_MOP_TU_ALL_OP_ACC   ,
MIN(AVG_MOP_TU_OP_ACC    ) AS MIN_AVG_MOP_TU_OP_ACC       ,
MIN(AVG_MOP_TU_ALL_CL_ACC) AS MIN_AVG_MOP_TU_ALL_CL_ACC   ,
MIN(AVG_MOP_TU_CL_ACC    ) AS MIN_AVG_MOP_TU_CL_ACC       ,
MIN(AVG_MOP_NBK_TU       ) AS MIN_AVG_MOP_NBK_TU          ,
MIN(AVG_MOP_NBK_TU_OP_ACC) AS MIN_AVG_MOP_NBK_TU_OP_ACC   ,
MIN(AVG_MOP_NBK_TU_CL_ACC) AS MIN_AVG_MOP_NBK_TU_CL_ACC   ,

ROUND(SUM(AVG_MOP_BK_AU_CL_ACC ) / COUNT(AVG_MOP_BK_AU_CL_ACC ) ,2) AS AVG_AVG_MOP_BK_AU_CL_ACC    ,
ROUND(SUM(AVG_MOP_BK_AU_OP_ACC ) / COUNT(AVG_MOP_BK_AU_OP_ACC ) ,2) AS AVG_AVG_MOP_BK_AU_OP_ACC    ,
ROUND(SUM(AVG_MOP_BK_AU        ) / COUNT(AVG_MOP_BK_AU        ) ,2) AS AVG_AVG_MOP_BK_AU           ,
ROUND(SUM(AVG_MOP_BK_M_CL_ACC  ) / COUNT(AVG_MOP_BK_M_CL_ACC  ) ,2) AS AVG_AVG_MOP_BK_M_CL_ACC     ,
ROUND(SUM(AVG_MOP_BK_M_OP_ACC  ) / COUNT(AVG_MOP_BK_M_OP_ACC  ) ,2) AS AVG_AVG_MOP_BK_M_OP_ACC     ,
ROUND(SUM(AVG_MOP_BK_M         ) / COUNT(AVG_MOP_BK_M         ) ,2) AS AVG_AVG_MOP_BK_M            ,
ROUND(SUM(AVG_MOP_BK_PL_CL_ACC ) / COUNT(AVG_MOP_BK_PL_CL_ACC ) ,2) AS AVG_AVG_MOP_BK_PL_CL_ACC    ,
ROUND(SUM(AVG_MOP_BK_PL_OP_ACC ) / COUNT(AVG_MOP_BK_PL_OP_ACC ) ,2) AS AVG_AVG_MOP_BK_PL_OP_ACC    ,
ROUND(SUM(AVG_MOP_BK_PL        ) / COUNT(AVG_MOP_BK_PL        ) ,2) AS AVG_AVG_MOP_BK_PL           ,
ROUND(SUM(AVG_MOP_BK_R_CL_ACC  ) / COUNT(AVG_MOP_BK_R_CL_ACC  ) ,2) AS AVG_AVG_MOP_BK_R_CL_ACC     ,
ROUND(SUM(AVG_MOP_BK_R_OP_ACC  ) / COUNT(AVG_MOP_BK_R_OP_ACC  ) ,2) AS AVG_AVG_MOP_BK_R_OP_ACC     ,
ROUND(SUM(AVG_MOP_BK_R         ) / COUNT(AVG_MOP_BK_R         ) ,2) AS AVG_AVG_MOP_BK_R            ,
ROUND(SUM(AVG_MOP_BK_CL_ACC    ) / COUNT(AVG_MOP_BK_CL_ACC    ) ,2) AS AVG_AVG_MOP_BK_CL_ACC       ,
ROUND(SUM(AVG_MOP_BK_OP_ACC    ) / COUNT(AVG_MOP_BK_OP_ACC    ) ,2) AS AVG_AVG_MOP_BK_OP_ACC       ,
ROUND(SUM(AVG_MOP_BK           ) / COUNT(AVG_MOP_BK           ) ,2) AS AVG_AVG_MOP_BK              ,
ROUND(SUM(AVG_MOP_NBK_AU_CL_ACC) / COUNT(AVG_MOP_NBK_AU_CL_ACC) ,2) AS AVG_AVG_MOP_NBK_AU_CL_ACC   ,
ROUND(SUM(AVG_MOP_NBK_AU_OP_ACC) / COUNT(AVG_MOP_NBK_AU_OP_ACC) ,2) AS AVG_AVG_MOP_NBK_AU_OP_ACC   ,
ROUND(SUM(AVG_MOP_NBK_AU       ) / COUNT(AVG_MOP_NBK_AU       ) ,2) AS AVG_AVG_MOP_NBK_AU          ,
ROUND(SUM(AVG_MOP_NBK_M_CL_ACC ) / COUNT(AVG_MOP_NBK_M_CL_ACC ) ,2) AS AVG_AVG_MOP_NBK_M_CL_ACC    ,
ROUND(SUM(AVG_MOP_NBK_M_OP_ACC ) / COUNT(AVG_MOP_NBK_M_OP_ACC ) ,2) AS AVG_AVG_MOP_NBK_M_OP_ACC    ,
ROUND(SUM(AVG_MOP_NBK_M        ) / COUNT(AVG_MOP_NBK_M        ) ,2) AS AVG_AVG_MOP_NBK_M           ,
ROUND(SUM(AVG_MOP_NBK_PL_CL_ACC) / COUNT(AVG_MOP_NBK_PL_CL_ACC) ,2) AS AVG_AVG_MOP_NBK_PL_CL_ACC   ,
ROUND(SUM(AVG_MOP_NBK_PL_OP_ACC) / COUNT(AVG_MOP_NBK_PL_OP_ACC) ,2) AS AVG_AVG_MOP_NBK_PL_OP_ACC   ,
ROUND(SUM(AVG_MOP_NBK_PL       ) / COUNT(AVG_MOP_NBK_PL       ) ,2) AS AVG_AVG_MOP_NBK_PL          ,
ROUND(SUM(AVG_MOP_NBK_R_CL_ACC ) / COUNT(AVG_MOP_NBK_R_CL_ACC ) ,2) AS AVG_AVG_MOP_NBK_R_CL_ACC    ,
ROUND(SUM(AVG_MOP_NBK_R_OP_ACC ) / COUNT(AVG_MOP_NBK_R_OP_ACC ) ,2) AS AVG_AVG_MOP_NBK_R_OP_ACC    ,
ROUND(SUM(AVG_MOP_NBK_R        ) / COUNT(AVG_MOP_NBK_R        ) ,2) AS AVG_AVG_MOP_NBK_R           ,
ROUND(SUM(AVG_MOP_NBK_CL_ACC   ) / COUNT(AVG_MOP_NBK_CL_ACC   ) ,2) AS AVG_AVG_MOP_NBK_CL_ACC      ,
ROUND(SUM(AVG_MOP_NBK_OP_ACC   ) / COUNT(AVG_MOP_NBK_OP_ACC   ) ,2) AS AVG_AVG_MOP_NBK_OP_ACC      ,
ROUND(SUM(AVG_MOP_NBK          ) / COUNT(AVG_MOP_NBK          ) ,2) AS AVG_AVG_MOP_NBK             ,
ROUND(SUM(AVG_MOP_AMX_CL_ACC   ) / COUNT(AVG_MOP_AMX_CL_ACC   ) ,2) AS AVG_AVG_MOP_AMX_CL_ACC      ,
ROUND(SUM(AVG_MOP_AMX_OP_ACC   ) / COUNT(AVG_MOP_AMX_OP_ACC   ) ,2) AS AVG_AVG_MOP_AMX_OP_ACC      ,
ROUND(SUM(AVG_MOP_AMX          ) / COUNT(AVG_MOP_AMX          ) ,2) AS AVG_AVG_MOP_AMX             ,
ROUND(SUM(AVG_MOP_AU_CL_ACC    ) / COUNT(AVG_MOP_AU_CL_ACC    ) ,2) AS AVG_AVG_MOP_AU_CL_ACC       ,
ROUND(SUM(AVG_MOP_AU_OP_ACC    ) / COUNT(AVG_MOP_AU_OP_ACC    ) ,2) AS AVG_AVG_MOP_AU_OP_ACC       ,
ROUND(SUM(AVG_MOP_AU           ) / COUNT(AVG_MOP_AU           ) ,2) AS AVG_AVG_MOP_AU              ,
ROUND(SUM(AVG_MOP_M_CL_ACC     ) / COUNT(AVG_MOP_M_CL_ACC     ) ,2) AS AVG_AVG_MOP_M_CL_ACC        ,
ROUND(SUM(AVG_MOP_M_OP_ACC     ) / COUNT(AVG_MOP_M_OP_ACC     ) ,2) AS AVG_AVG_MOP_M_OP_ACC        ,
ROUND(SUM(AVG_MOP_M            ) / COUNT(AVG_MOP_M            ) ,2) AS AVG_AVG_MOP_M               ,
ROUND(SUM(AVG_MOP_PL_CL_ACC    ) / COUNT(AVG_MOP_PL_CL_ACC    ) ,2) AS AVG_AVG_MOP_PL_CL_ACC       ,
ROUND(SUM(AVG_MOP_PL_OP_ACC    ) / COUNT(AVG_MOP_PL_OP_ACC    ) ,2) AS AVG_AVG_MOP_PL_OP_ACC       ,
ROUND(SUM(AVG_MOP_PL           ) / COUNT(AVG_MOP_PL           ) ,2) AS AVG_AVG_MOP_PL              ,
ROUND(SUM(AVG_MOP_R_CL_ACC     ) / COUNT(AVG_MOP_R_CL_ACC     ) ,2) AS AVG_AVG_MOP_R_CL_ACC        ,
ROUND(SUM(AVG_MOP_R_OP_ACC     ) / COUNT(AVG_MOP_R_OP_ACC     ) ,2) AS AVG_AVG_MOP_R_OP_ACC        ,
ROUND(SUM(AVG_MOP_R            ) / COUNT(AVG_MOP_R            ) ,2) AS AVG_AVG_MOP_R               ,
ROUND(SUM(AVG_MOP_CL_ACC       ) / COUNT(AVG_MOP_CL_ACC       ) ,2) AS AVG_AVG_MOP_CL_ACC          ,
ROUND(SUM(AVG_MOP_OP_ACC       ) / COUNT(AVG_MOP_OP_ACC       ) ,2) AS AVG_AVG_MOP_OP_ACC          ,
ROUND(SUM(AVG_MOP              ) / COUNT(AVG_MOP              ) ,2) AS AVG_AVG_MOP                 ,
ROUND(SUM(AVG_MOP_TU_ALL       ) / COUNT(AVG_MOP_TU_ALL       ) ,2) AS AVG_AVG_MOP_TU_ALL          ,
ROUND(SUM(AVG_MOP_TU           ) / COUNT(AVG_MOP_TU           ) ,2) AS AVG_AVG_MOP_TU              ,
ROUND(SUM(AVG_MOP_TU_ALL_OP_ACC) / COUNT(AVG_MOP_TU_ALL_OP_ACC) ,2) AS AVG_AVG_MOP_TU_ALL_OP_ACC   ,
ROUND(SUM(AVG_MOP_TU_OP_ACC    ) / COUNT(AVG_MOP_TU_OP_ACC    ) ,2) AS AVG_AVG_MOP_TU_OP_ACC       ,
ROUND(SUM(AVG_MOP_TU_ALL_CL_ACC) / COUNT(AVG_MOP_TU_ALL_CL_ACC) ,2) AS AVG_AVG_MOP_TU_ALL_CL_ACC   ,
ROUND(SUM(AVG_MOP_TU_CL_ACC    ) / COUNT(AVG_MOP_TU_CL_ACC    ) ,2) AS AVG_AVG_MOP_TU_CL_ACC       ,
ROUND(SUM(AVG_MOP_NBK_TU       ) / COUNT(AVG_MOP_NBK_TU       ) ,2) AS AVG_AVG_MOP_NBK_TU          ,
ROUND(SUM(AVG_MOP_NBK_TU_OP_ACC) / COUNT(AVG_MOP_NBK_TU_OP_ACC) ,2) AS AVG_AVG_MOP_NBK_TU_OP_ACC   ,
ROUND(SUM(AVG_MOP_NBK_TU_CL_ACC) / COUNT(AVG_MOP_NBK_TU_CL_ACC) ,2) AS AVG_AVG_MOP_NBK_TU_CL_ACC   

FROM dbmymwork.BTDC_LGG_VAR_SEGMENTADAS_2
GROUP BY CUENTADEREFERENCIA,
FECHA_CARTERA
;

SELECT * FROM dbmymwork.BTDC_LGG_VAR_AVG_MOP LIMIT 100;