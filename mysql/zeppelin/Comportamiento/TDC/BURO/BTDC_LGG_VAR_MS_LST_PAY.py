%hive

DROP TABLE IF EXISTS dbmymwork.BTDC_LGG_VAR_MS_LST_PAY;
CREATE TABLE dbmymwork.BTDC_LGG_VAR_MS_LST_PAY
ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'

LOCATION 's3://boi-banregio/datalake/data/InteligenciaRiesgos/M&M/BTDC/VARIABLES/BTDC_LGG_VAR_MS_LST_PAY' AS

SELECT
CUENTADEREFERENCIA,
FECHA_CARTERA,

COUNT(MS_LST_PAY_BK_AU_CL_ACC) AS NUM_MS_LST_PAY_BK_AU_CL_ACC,
MAX(MS_LST_PAY_BK_AU_CL_ACC)   AS MAX_MS_LST_PAY_BK_AU_CL_ACC,
SUM(MS_LST_PAY_BK_AU_CL_ACC)   AS SUM_MS_LST_PAY_BK_AU_CL_ACC,
MIN(MS_LST_PAY_BK_AU_CL_ACC)   AS MIN_MS_LST_PAY_BK_AU_CL_ACC,
MAX(MS_LST_PAY_BK_AU_CL_ACC) - MIN(MS_LST_PAY_BK_AU_CL_ACC) AS DIF_MS_LST_PAY_BK_AU_CL_ACC,
SUM(MS_LST_PAY_BK_AU_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_AU_CL_ACC),0) AS AVG_MS_LST_PAY_BK_AU_CL_ACC,

COUNT(MS_LST_PAY_BK_AU_OP_ACC) AS NUM_MS_LST_PAY_BK_AU_OP_ACC,
MAX(MS_LST_PAY_BK_AU_OP_ACC)   AS MAX_MS_LST_PAY_BK_AU_OP_ACC,
SUM(MS_LST_PAY_BK_AU_OP_ACC)   AS SUM_MS_LST_PAY_BK_AU_OP_ACC,
MIN(MS_LST_PAY_BK_AU_OP_ACC)   AS MIN_MS_LST_PAY_BK_AU_OP_ACC,
MAX(MS_LST_PAY_BK_AU_OP_ACC) - MIN(MS_LST_PAY_BK_AU_OP_ACC) AS DIF_MS_LST_PAY_BK_AU_OP_ACC,
SUM(MS_LST_PAY_BK_AU_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_AU_OP_ACC),0) AS AVG_MS_LST_PAY_BK_AU_OP_ACC,

COUNT(MS_LST_PAY_BK_AU) AS NUM_MS_LST_PAY_BK_AU,
MAX(MS_LST_PAY_BK_AU)   AS MAX_MS_LST_PAY_BK_AU,
SUM(MS_LST_PAY_BK_AU)   AS SUM_MS_LST_PAY_BK_AU,
MIN(MS_LST_PAY_BK_AU)   AS MIN_MS_LST_PAY_BK_AU,
MAX(MS_LST_PAY_BK_AU) - MIN(MS_LST_PAY_BK_AU) AS DIF_MS_LST_PAY_BK_AU,
SUM(MS_LST_PAY_BK_AU)/NULLIF(COUNT(MS_LST_PAY_BK_AU),0) AS AVG_MS_LST_PAY_BK_AU,

COUNT(MS_LST_PAY_BK_M_CL_ACC) AS NUM_MS_LST_PAY_BK_M_CL_ACC,
MAX(MS_LST_PAY_BK_M_CL_ACC)   AS MAX_MS_LST_PAY_BK_M_CL_ACC,
SUM(MS_LST_PAY_BK_M_CL_ACC)   AS SUM_MS_LST_PAY_BK_M_CL_ACC,
MIN(MS_LST_PAY_BK_M_CL_ACC)   AS MIN_MS_LST_PAY_BK_M_CL_ACC,
MAX(MS_LST_PAY_BK_M_CL_ACC) - MIN(MS_LST_PAY_BK_M_CL_ACC) AS DIF_MS_LST_PAY_BK_M_CL_ACC,
SUM(MS_LST_PAY_BK_M_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_M_CL_ACC),0) AS AVG_MS_LST_PAY_BK_M_CL_ACC,

COUNT(MS_LST_PAY_BK_M_OP_ACC) AS NUM_MS_LST_PAY_BK_M_OP_ACC,
MAX(MS_LST_PAY_BK_M_OP_ACC)   AS MAX_MS_LST_PAY_BK_M_OP_ACC,
SUM(MS_LST_PAY_BK_M_OP_ACC)   AS SUM_MS_LST_PAY_BK_M_OP_ACC,
MIN(MS_LST_PAY_BK_M_OP_ACC)   AS MIN_MS_LST_PAY_BK_M_OP_ACC,
MAX(MS_LST_PAY_BK_M_OP_ACC) - MIN(MS_LST_PAY_BK_M_OP_ACC) AS DIF_MS_LST_PAY_BK_M_OP_ACC,
SUM(MS_LST_PAY_BK_M_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_M_OP_ACC),0) AS AVG_MS_LST_PAY_BK_M_OP_ACC,

COUNT(MS_LST_PAY_BK_M) AS NUM_MS_LST_PAY_BK_M,
MAX(MS_LST_PAY_BK_M)   AS MAX_MS_LST_PAY_BK_M,
SUM(MS_LST_PAY_BK_M)   AS SUM_MS_LST_PAY_BK_M,
MIN(MS_LST_PAY_BK_M)   AS MIN_MS_LST_PAY_BK_M,
MAX(MS_LST_PAY_BK_M) - MIN(MS_LST_PAY_BK_M) AS DIF_MS_LST_PAY_BK_M,
SUM(MS_LST_PAY_BK_M)/NULLIF(COUNT(MS_LST_PAY_BK_M),0) AS AVG_MS_LST_PAY_BK_M,

COUNT(MS_LST_PAY_BK_PL_CL_ACC) AS NUM_MS_LST_PAY_BK_PL_CL_ACC,
MAX(MS_LST_PAY_BK_PL_CL_ACC)   AS MAX_MS_LST_PAY_BK_PL_CL_ACC,
SUM(MS_LST_PAY_BK_PL_CL_ACC)   AS SUM_MS_LST_PAY_BK_PL_CL_ACC,
MIN(MS_LST_PAY_BK_PL_CL_ACC)   AS MIN_MS_LST_PAY_BK_PL_CL_ACC,
MAX(MS_LST_PAY_BK_PL_CL_ACC) - MIN(MS_LST_PAY_BK_PL_CL_ACC) AS DIF_MS_LST_PAY_BK_PL_CL_ACC,
SUM(MS_LST_PAY_BK_PL_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_PL_CL_ACC),0) AS AVG_MS_LST_PAY_BK_PL_CL_ACC,

COUNT(MS_LST_PAY_BK_PL_OP_ACC) AS NUM_MS_LST_PAY_BK_PL_OP_ACC,
MAX(MS_LST_PAY_BK_PL_OP_ACC)   AS MAX_MS_LST_PAY_BK_PL_OP_ACC,
SUM(MS_LST_PAY_BK_PL_OP_ACC)   AS SUM_MS_LST_PAY_BK_PL_OP_ACC,
MIN(MS_LST_PAY_BK_PL_OP_ACC)   AS MIN_MS_LST_PAY_BK_PL_OP_ACC,
MAX(MS_LST_PAY_BK_PL_OP_ACC) - MIN(MS_LST_PAY_BK_PL_OP_ACC) AS DIF_MS_LST_PAY_BK_PL_OP_ACC,
SUM(MS_LST_PAY_BK_PL_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_PL_OP_ACC),0) AS AVG_MS_LST_PAY_BK_PL_OP_ACC,

COUNT(MS_LST_PAY_BK_PL) AS NUM_MS_LST_PAY_BK_PL,
MAX(MS_LST_PAY_BK_PL)   AS MAX_MS_LST_PAY_BK_PL,
SUM(MS_LST_PAY_BK_PL)   AS SUM_MS_LST_PAY_BK_PL,
MIN(MS_LST_PAY_BK_PL)   AS MIN_MS_LST_PAY_BK_PL,
MAX(MS_LST_PAY_BK_PL) - MIN(MS_LST_PAY_BK_PL) AS DIF_MS_LST_PAY_BK_PL,
SUM(MS_LST_PAY_BK_PL)/NULLIF(COUNT(MS_LST_PAY_BK_PL),0) AS AVG_MS_LST_PAY_BK_PL,

COUNT(MS_LST_PAY_BK_R_CL_ACC) AS NUM_MS_LST_PAY_BK_R_CL_ACC,
MAX(MS_LST_PAY_BK_R_CL_ACC)   AS MAX_MS_LST_PAY_BK_R_CL_ACC,
SUM(MS_LST_PAY_BK_R_CL_ACC)   AS SUM_MS_LST_PAY_BK_R_CL_ACC,
MIN(MS_LST_PAY_BK_R_CL_ACC)   AS MIN_MS_LST_PAY_BK_R_CL_ACC,
MAX(MS_LST_PAY_BK_R_CL_ACC) - MIN(MS_LST_PAY_BK_R_CL_ACC) AS DIF_MS_LST_PAY_BK_R_CL_ACC,
SUM(MS_LST_PAY_BK_R_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_R_CL_ACC),0) AS AVG_MS_LST_PAY_BK_R_CL_ACC,

COUNT(MS_LST_PAY_BK_R_OP_ACC) AS NUM_MS_LST_PAY_BK_R_OP_ACC,
MAX(MS_LST_PAY_BK_R_OP_ACC)   AS MAX_MS_LST_PAY_BK_R_OP_ACC,
SUM(MS_LST_PAY_BK_R_OP_ACC)   AS SUM_MS_LST_PAY_BK_R_OP_ACC,
MIN(MS_LST_PAY_BK_R_OP_ACC)   AS MIN_MS_LST_PAY_BK_R_OP_ACC,
MAX(MS_LST_PAY_BK_R_OP_ACC) - MIN(MS_LST_PAY_BK_R_OP_ACC) AS DIF_MS_LST_PAY_BK_R_OP_ACC,
SUM(MS_LST_PAY_BK_R_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_R_OP_ACC),0) AS AVG_MS_LST_PAY_BK_R_OP_ACC,

COUNT(MS_LST_PAY_BK_R) AS NUM_MS_LST_PAY_BK_R,
MAX(MS_LST_PAY_BK_R)   AS MAX_MS_LST_PAY_BK_R,
SUM(MS_LST_PAY_BK_R)   AS SUM_MS_LST_PAY_BK_R,
MIN(MS_LST_PAY_BK_R)   AS MIN_MS_LST_PAY_BK_R,
MAX(MS_LST_PAY_BK_R) - MIN(MS_LST_PAY_BK_R) AS DIF_MS_LST_PAY_BK_R,
SUM(MS_LST_PAY_BK_R)/NULLIF(COUNT(MS_LST_PAY_BK_R),0) AS AVG_MS_LST_PAY_BK_R,

COUNT(MS_LST_PAY_BK_CL_ACC) AS NUM_MS_LST_PAY_BK_CL_ACC,
MAX(MS_LST_PAY_BK_CL_ACC)   AS MAX_MS_LST_PAY_BK_CL_ACC,
SUM(MS_LST_PAY_BK_CL_ACC)   AS SUM_MS_LST_PAY_BK_CL_ACC,
MIN(MS_LST_PAY_BK_CL_ACC)   AS MIN_MS_LST_PAY_BK_CL_ACC,
MAX(MS_LST_PAY_BK_CL_ACC) - MIN(MS_LST_PAY_BK_CL_ACC) AS DIF_MS_LST_PAY_BK_CL_ACC,
SUM(MS_LST_PAY_BK_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_CL_ACC),0) AS AVG_MS_LST_PAY_BK_CL_ACC,

COUNT(MS_LST_PAY_BK_OP_ACC) AS NUM_MS_LST_PAY_BK_OP_ACC,
MAX(MS_LST_PAY_BK_OP_ACC)   AS MAX_MS_LST_PAY_BK_OP_ACC,
SUM(MS_LST_PAY_BK_OP_ACC)   AS SUM_MS_LST_PAY_BK_OP_ACC,
MIN(MS_LST_PAY_BK_OP_ACC)   AS MIN_MS_LST_PAY_BK_OP_ACC,
MAX(MS_LST_PAY_BK_OP_ACC) - MIN(MS_LST_PAY_BK_OP_ACC) AS DIF_MS_LST_PAY_BK_OP_ACC,
SUM(MS_LST_PAY_BK_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_BK_OP_ACC),0) AS AVG_MS_LST_PAY_BK_OP_ACC,

COUNT(MS_LST_PAY_BK) AS NUM_MS_LST_PAY_BK,
MAX(MS_LST_PAY_BK)   AS MAX_MS_LST_PAY_BK,
SUM(MS_LST_PAY_BK)   AS SUM_MS_LST_PAY_BK,
MIN(MS_LST_PAY_BK)   AS MIN_MS_LST_PAY_BK,
MAX(MS_LST_PAY_BK) - MIN(MS_LST_PAY_BK) AS DIF_MS_LST_PAY_BK,
SUM(MS_LST_PAY_BK)/NULLIF(COUNT(MS_LST_PAY_BK),0) AS AVG_MS_LST_PAY_BK,

COUNT(MS_LST_PAY_NBK_AU_CL_ACC) AS NUM_MS_LST_PAY_NBK_AU_CL_ACC,
MAX(MS_LST_PAY_NBK_AU_CL_ACC)   AS MAX_MS_LST_PAY_NBK_AU_CL_ACC,
SUM(MS_LST_PAY_NBK_AU_CL_ACC)   AS SUM_MS_LST_PAY_NBK_AU_CL_ACC,
MIN(MS_LST_PAY_NBK_AU_CL_ACC)   AS MIN_MS_LST_PAY_NBK_AU_CL_ACC,
MAX(MS_LST_PAY_NBK_AU_CL_ACC) - MIN(MS_LST_PAY_NBK_AU_CL_ACC) AS DIF_MS_LST_PAY_NBK_AU_CL_ACC,
SUM(MS_LST_PAY_NBK_AU_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_AU_CL_ACC),0) AS AVG_MS_LST_PAY_NBK_AU_CL_ACC,

COUNT(MS_LST_PAY_NBK_AU_OP_ACC) AS NUM_MS_LST_PAY_NBK_AU_OP_ACC,
MAX(MS_LST_PAY_NBK_AU_OP_ACC)   AS MAX_MS_LST_PAY_NBK_AU_OP_ACC,
SUM(MS_LST_PAY_NBK_AU_OP_ACC)   AS SUM_MS_LST_PAY_NBK_AU_OP_ACC,
MIN(MS_LST_PAY_NBK_AU_OP_ACC)   AS MIN_MS_LST_PAY_NBK_AU_OP_ACC,
MAX(MS_LST_PAY_NBK_AU_OP_ACC) - MIN(MS_LST_PAY_NBK_AU_OP_ACC) AS DIF_MS_LST_PAY_NBK_AU_OP_ACC,
SUM(MS_LST_PAY_NBK_AU_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_AU_OP_ACC),0) AS AVG_MS_LST_PAY_NBK_AU_OP_ACC,

COUNT(MS_LST_PAY_NBK_AU) AS NUM_MS_LST_PAY_NBK_AU,
MAX(MS_LST_PAY_NBK_AU)   AS MAX_MS_LST_PAY_NBK_AU,
SUM(MS_LST_PAY_NBK_AU)   AS SUM_MS_LST_PAY_NBK_AU,
MIN(MS_LST_PAY_NBK_AU)   AS MIN_MS_LST_PAY_NBK_AU,
MAX(MS_LST_PAY_NBK_AU) - MIN(MS_LST_PAY_NBK_AU) AS DIF_MS_LST_PAY_NBK_AU,
SUM(MS_LST_PAY_NBK_AU)/NULLIF(COUNT(MS_LST_PAY_NBK_AU),0) AS AVG_MS_LST_PAY_NBK_AU,

COUNT(MS_LST_PAY_NBK_M_CL_ACC) AS NUM_MS_LST_PAY_NBK_M_CL_ACC,
MAX(MS_LST_PAY_NBK_M_CL_ACC)   AS MAX_MS_LST_PAY_NBK_M_CL_ACC,
SUM(MS_LST_PAY_NBK_M_CL_ACC)   AS SUM_MS_LST_PAY_NBK_M_CL_ACC,
MIN(MS_LST_PAY_NBK_M_CL_ACC)   AS MIN_MS_LST_PAY_NBK_M_CL_ACC,
MAX(MS_LST_PAY_NBK_M_CL_ACC) - MIN(MS_LST_PAY_NBK_M_CL_ACC) AS DIF_MS_LST_PAY_NBK_M_CL_ACC,
SUM(MS_LST_PAY_NBK_M_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_M_CL_ACC),0) AS AVG_MS_LST_PAY_NBK_M_CL_ACC,

COUNT(MS_LST_PAY_NBK_M_OP_ACC) AS NUM_MS_LST_PAY_NBK_M_OP_ACC,
MAX(MS_LST_PAY_NBK_M_OP_ACC)   AS MAX_MS_LST_PAY_NBK_M_OP_ACC,
SUM(MS_LST_PAY_NBK_M_OP_ACC)   AS SUM_MS_LST_PAY_NBK_M_OP_ACC,
MIN(MS_LST_PAY_NBK_M_OP_ACC)   AS MIN_MS_LST_PAY_NBK_M_OP_ACC,
MAX(MS_LST_PAY_NBK_M_OP_ACC) - MIN(MS_LST_PAY_NBK_M_OP_ACC) AS DIF_MS_LST_PAY_NBK_M_OP_ACC,
SUM(MS_LST_PAY_NBK_M_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_M_OP_ACC),0) AS AVG_MS_LST_PAY_NBK_M_OP_ACC,

COUNT(MS_LST_PAY_NBK_M) AS NUM_MS_LST_PAY_NBK_M,
MAX(MS_LST_PAY_NBK_M)   AS MAX_MS_LST_PAY_NBK_M,
SUM(MS_LST_PAY_NBK_M)   AS SUM_MS_LST_PAY_NBK_M,
MIN(MS_LST_PAY_NBK_M)   AS MIN_MS_LST_PAY_NBK_M,
MAX(MS_LST_PAY_NBK_M) - MIN(MS_LST_PAY_NBK_M) AS DIF_MS_LST_PAY_NBK_M,
SUM(MS_LST_PAY_NBK_M)/NULLIF(COUNT(MS_LST_PAY_NBK_M),0) AS AVG_MS_LST_PAY_NBK_M,

COUNT(MS_LST_PAY_NBK_PL_CL_ACC) AS NUM_MS_LST_PAY_NBK_PL_CL_ACC,
MAX(MS_LST_PAY_NBK_PL_CL_ACC)   AS MAX_MS_LST_PAY_NBK_PL_CL_ACC,
SUM(MS_LST_PAY_NBK_PL_CL_ACC)   AS SUM_MS_LST_PAY_NBK_PL_CL_ACC,
MIN(MS_LST_PAY_NBK_PL_CL_ACC)   AS MIN_MS_LST_PAY_NBK_PL_CL_ACC,
MAX(MS_LST_PAY_NBK_PL_CL_ACC) - MIN(MS_LST_PAY_NBK_PL_CL_ACC) AS DIF_MS_LST_PAY_NBK_PL_CL_ACC,
SUM(MS_LST_PAY_NBK_PL_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_PL_CL_ACC),0) AS AVG_MS_LST_PAY_NBK_PL_CL_ACC,

COUNT(MS_LST_PAY_NBK_PL_OP_ACC) AS NUM_MS_LST_PAY_NBK_PL_OP_ACC,
MAX(MS_LST_PAY_NBK_PL_OP_ACC)   AS MAX_MS_LST_PAY_NBK_PL_OP_ACC,
SUM(MS_LST_PAY_NBK_PL_OP_ACC)   AS SUM_MS_LST_PAY_NBK_PL_OP_ACC,
MIN(MS_LST_PAY_NBK_PL_OP_ACC)   AS MIN_MS_LST_PAY_NBK_PL_OP_ACC,
MAX(MS_LST_PAY_NBK_PL_OP_ACC) - MIN(MS_LST_PAY_NBK_PL_OP_ACC) AS DIF_MS_LST_PAY_NBK_PL_OP_ACC,
SUM(MS_LST_PAY_NBK_PL_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_PL_OP_ACC),0) AS AVG_MS_LST_PAY_NBK_PL_OP_ACC,

COUNT(MS_LST_PAY_NBK_PL) AS NUM_MS_LST_PAY_NBK_PL,
MAX(MS_LST_PAY_NBK_PL)   AS MAX_MS_LST_PAY_NBK_PL,
SUM(MS_LST_PAY_NBK_PL)   AS SUM_MS_LST_PAY_NBK_PL,
MIN(MS_LST_PAY_NBK_PL)   AS MIN_MS_LST_PAY_NBK_PL,
MAX(MS_LST_PAY_NBK_PL) - MIN(MS_LST_PAY_NBK_PL) AS DIF_MS_LST_PAY_NBK_PL,
SUM(MS_LST_PAY_NBK_PL)/NULLIF(COUNT(MS_LST_PAY_NBK_PL),0) AS AVG_MS_LST_PAY_NBK_PL,

COUNT(MS_LST_PAY_NBK_R_CL_ACC) AS NUM_MS_LST_PAY_NBK_R_CL_ACC,
MAX(MS_LST_PAY_NBK_R_CL_ACC)   AS MAX_MS_LST_PAY_NBK_R_CL_ACC,
SUM(MS_LST_PAY_NBK_R_CL_ACC)   AS SUM_MS_LST_PAY_NBK_R_CL_ACC,
MIN(MS_LST_PAY_NBK_R_CL_ACC)   AS MIN_MS_LST_PAY_NBK_R_CL_ACC,
MAX(MS_LST_PAY_NBK_R_CL_ACC) - MIN(MS_LST_PAY_NBK_R_CL_ACC) AS DIF_MS_LST_PAY_NBK_R_CL_ACC,
SUM(MS_LST_PAY_NBK_R_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_R_CL_ACC),0) AS AVG_MS_LST_PAY_NBK_R_CL_ACC,

COUNT(MS_LST_PAY_NBK_R_OP_ACC) AS NUM_MS_LST_PAY_NBK_R_OP_ACC,
MAX(MS_LST_PAY_NBK_R_OP_ACC)   AS MAX_MS_LST_PAY_NBK_R_OP_ACC,
SUM(MS_LST_PAY_NBK_R_OP_ACC)   AS SUM_MS_LST_PAY_NBK_R_OP_ACC,
MIN(MS_LST_PAY_NBK_R_OP_ACC)   AS MIN_MS_LST_PAY_NBK_R_OP_ACC,
MAX(MS_LST_PAY_NBK_R_OP_ACC) - MIN(MS_LST_PAY_NBK_R_OP_ACC) AS DIF_MS_LST_PAY_NBK_R_OP_ACC,
SUM(MS_LST_PAY_NBK_R_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_R_OP_ACC),0) AS AVG_MS_LST_PAY_NBK_R_OP_ACC,

COUNT(MS_LST_PAY_NBK_R) AS NUM_MS_LST_PAY_NBK_R,
MAX(MS_LST_PAY_NBK_R)   AS MAX_MS_LST_PAY_NBK_R,
SUM(MS_LST_PAY_NBK_R)   AS SUM_MS_LST_PAY_NBK_R,
MIN(MS_LST_PAY_NBK_R)   AS MIN_MS_LST_PAY_NBK_R,
MAX(MS_LST_PAY_NBK_R) - MIN(MS_LST_PAY_NBK_R) AS DIF_MS_LST_PAY_NBK_R,
SUM(MS_LST_PAY_NBK_R)/NULLIF(COUNT(MS_LST_PAY_NBK_R),0) AS AVG_MS_LST_PAY_NBK_R,

COUNT(MS_LST_PAY_NBK_CL_ACC) AS NUM_MS_LST_PAY_NBK_CL_ACC,
MAX(MS_LST_PAY_NBK_CL_ACC)   AS MAX_MS_LST_PAY_NBK_CL_ACC,
SUM(MS_LST_PAY_NBK_CL_ACC)   AS SUM_MS_LST_PAY_NBK_CL_ACC,
MIN(MS_LST_PAY_NBK_CL_ACC)   AS MIN_MS_LST_PAY_NBK_CL_ACC,
MAX(MS_LST_PAY_NBK_CL_ACC) - MIN(MS_LST_PAY_NBK_CL_ACC) AS DIF_MS_LST_PAY_NBK_CL_ACC,
SUM(MS_LST_PAY_NBK_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_CL_ACC),0) AS AVG_MS_LST_PAY_NBK_CL_ACC,

COUNT(MS_LST_PAY_NBK_OP_ACC) AS NUM_MS_LST_PAY_NBK_OP_ACC,
MAX(MS_LST_PAY_NBK_OP_ACC)   AS MAX_MS_LST_PAY_NBK_OP_ACC,
SUM(MS_LST_PAY_NBK_OP_ACC)   AS SUM_MS_LST_PAY_NBK_OP_ACC,
MIN(MS_LST_PAY_NBK_OP_ACC)   AS MIN_MS_LST_PAY_NBK_OP_ACC,
MAX(MS_LST_PAY_NBK_OP_ACC) - MIN(MS_LST_PAY_NBK_OP_ACC) AS DIF_MS_LST_PAY_NBK_OP_ACC,
SUM(MS_LST_PAY_NBK_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_OP_ACC),0) AS AVG_MS_LST_PAY_NBK_OP_ACC,

COUNT(MS_LST_PAY_NBK) AS NUM_MS_LST_PAY_NBK,
MAX(MS_LST_PAY_NBK)   AS MAX_MS_LST_PAY_NBK,
SUM(MS_LST_PAY_NBK)   AS SUM_MS_LST_PAY_NBK,
MIN(MS_LST_PAY_NBK)   AS MIN_MS_LST_PAY_NBK,
MAX(MS_LST_PAY_NBK) - MIN(MS_LST_PAY_NBK) AS DIF_MS_LST_PAY_NBK,
SUM(MS_LST_PAY_NBK)/NULLIF(COUNT(MS_LST_PAY_NBK),0) AS AVG_MS_LST_PAY_NBK,

COUNT(MS_LST_PAY_AMX_CL_ACC) AS NUM_MS_LST_PAY_AMX_CL_ACC,
MAX(MS_LST_PAY_AMX_CL_ACC)   AS MAX_MS_LST_PAY_AMX_CL_ACC,
SUM(MS_LST_PAY_AMX_CL_ACC)   AS SUM_MS_LST_PAY_AMX_CL_ACC,
MIN(MS_LST_PAY_AMX_CL_ACC)   AS MIN_MS_LST_PAY_AMX_CL_ACC,
MAX(MS_LST_PAY_AMX_CL_ACC) - MIN(MS_LST_PAY_AMX_CL_ACC) AS DIF_MS_LST_PAY_AMX_CL_ACC,
SUM(MS_LST_PAY_AMX_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_AMX_CL_ACC),0) AS AVG_MS_LST_PAY_AMX_CL_ACC,

COUNT(MS_LST_PAY_AMX_OP_ACC) AS NUM_MS_LST_PAY_AMX_OP_ACC,
MAX(MS_LST_PAY_AMX_OP_ACC)   AS MAX_MS_LST_PAY_AMX_OP_ACC,
SUM(MS_LST_PAY_AMX_OP_ACC)   AS SUM_MS_LST_PAY_AMX_OP_ACC,
MIN(MS_LST_PAY_AMX_OP_ACC)   AS MIN_MS_LST_PAY_AMX_OP_ACC,
MAX(MS_LST_PAY_AMX_OP_ACC) - MIN(MS_LST_PAY_AMX_OP_ACC) AS DIF_MS_LST_PAY_AMX_OP_ACC,
SUM(MS_LST_PAY_AMX_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_AMX_OP_ACC),0) AS AVG_MS_LST_PAY_AMX_OP_ACC,

COUNT(MS_LST_PAY_AMX) AS NUM_MS_LST_PAY_AMX,
MAX(MS_LST_PAY_AMX)   AS MAX_MS_LST_PAY_AMX,
SUM(MS_LST_PAY_AMX)   AS SUM_MS_LST_PAY_AMX,
MIN(MS_LST_PAY_AMX)   AS MIN_MS_LST_PAY_AMX,
MAX(MS_LST_PAY_AMX) - MIN(MS_LST_PAY_AMX) AS DIF_MS_LST_PAY_AMX,
SUM(MS_LST_PAY_AMX)/NULLIF(COUNT(MS_LST_PAY_AMX),0) AS AVG_MS_LST_PAY_AMX,

COUNT(MS_LST_PAY_AU_CL_ACC) AS NUM_MS_LST_PAY_AU_CL_ACC,
MAX(MS_LST_PAY_AU_CL_ACC) AS MAX_MS_LST_PAY_AU_CL_ACC,
SUM(MS_LST_PAY_AU_CL_ACC) AS SUM_MS_LST_PAY_AU_CL_ACC,
MIN(MS_LST_PAY_AU_CL_ACC) AS MIN_MS_LST_PAY_AU_CL_ACC,
MAX(MS_LST_PAY_AU_CL_ACC) - MIN(MS_LST_PAY_AU_CL_ACC) AS DIF_MS_LST_PAY_AU_CL_ACC,
SUM(MS_LST_PAY_AU_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_AU_CL_ACC),0) AS AVG_MS_LST_PAY_AU_CL_ACC,

COUNT(MS_LST_PAY_AU_OP_ACC) AS NUM_MS_LST_PAY_AU_OP_ACC,
MAX(MS_LST_PAY_AU_OP_ACC)   AS MAX_MS_LST_PAY_AU_OP_ACC,
SUM(MS_LST_PAY_AU_OP_ACC)   AS SUM_MS_LST_PAY_AU_OP_ACC,
MIN(MS_LST_PAY_AU_OP_ACC)   AS MIN_MS_LST_PAY_AU_OP_ACC,
MAX(MS_LST_PAY_AU_OP_ACC) - MIN(MS_LST_PAY_AU_OP_ACC) AS DIF_MS_LST_PAY_AU_OP_ACC,
SUM(MS_LST_PAY_AU_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_AU_OP_ACC),0) AS AVG_MS_LST_PAY_AU_OP_ACC,

COUNT(MS_LST_PAY_AU) AS NUM_MS_LST_PAY_AU,
MAX(MS_LST_PAY_AU)   AS MAX_MS_LST_PAY_AU,
SUM(MS_LST_PAY_AU)   AS SUM_MS_LST_PAY_AU,
MIN(MS_LST_PAY_AU)   AS MIN_MS_LST_PAY_AU,
MAX(MS_LST_PAY_AU) - MIN(MS_LST_PAY_AU) AS DIF_MS_LST_PAY_AU,
SUM(MS_LST_PAY_AU)/NULLIF(COUNT(MS_LST_PAY_AU),0) AS AVG_MS_LST_PAY_AU,

COUNT(MS_LST_PAY_M_CL_ACC) AS NUM_MS_LST_PAY_M_CL_ACC,
MAX(MS_LST_PAY_M_CL_ACC)   AS MAX_MS_LST_PAY_M_CL_ACC,
SUM(MS_LST_PAY_M_CL_ACC)   AS SUM_MS_LST_PAY_M_CL_ACC,
MIN(MS_LST_PAY_M_CL_ACC)   AS MIN_MS_LST_PAY_M_CL_ACC,
MAX(MS_LST_PAY_M_CL_ACC) - MIN(MS_LST_PAY_M_CL_ACC) AS DIF_MS_LST_PAY_M_CL_ACC,
SUM(MS_LST_PAY_M_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_M_CL_ACC),0) AS AVG_MS_LST_PAY_M_CL_ACC,

COUNT(MS_LST_PAY_M_OP_ACC) AS NUM_MS_LST_PAY_M_OP_ACC,
MAX(MS_LST_PAY_M_OP_ACC)   AS MAX_MS_LST_PAY_M_OP_ACC,
SUM(MS_LST_PAY_M_OP_ACC)   AS SUM_MS_LST_PAY_M_OP_ACC,
MIN(MS_LST_PAY_M_OP_ACC)   AS MIN_MS_LST_PAY_M_OP_ACC,
MAX(MS_LST_PAY_M_OP_ACC) - MIN(MS_LST_PAY_M_OP_ACC) AS DIF_MS_LST_PAY_M_OP_ACC,
SUM(MS_LST_PAY_M_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_M_OP_ACC),0) AS AVG_MS_LST_PAY_M_OP_ACC,

COUNT(MS_LST_PAY_M) AS NUM_MS_LST_PAY_M,
MAX(MS_LST_PAY_M)   AS MAX_MS_LST_PAY_M,
SUM(MS_LST_PAY_M)   AS SUM_MS_LST_PAY_M,
MIN(MS_LST_PAY_M)   AS MIN_MS_LST_PAY_M,
MAX(MS_LST_PAY_M) - MIN(MS_LST_PAY_M) AS DIF_MS_LST_PAY_M,
SUM(MS_LST_PAY_M)/NULLIF(COUNT(MS_LST_PAY_M),0) AS AVG_MS_LST_PAY_M,

COUNT(MS_LST_PAY_PL_CL_ACC) AS NUM_MS_LST_PAY_PL_CL_ACC,
MAX(MS_LST_PAY_PL_CL_ACC)   AS MAX_MS_LST_PAY_PL_CL_ACC,
SUM(MS_LST_PAY_PL_CL_ACC)   AS SUM_MS_LST_PAY_PL_CL_ACC,
MIN(MS_LST_PAY_PL_CL_ACC)   AS MIN_MS_LST_PAY_PL_CL_ACC,
MAX(MS_LST_PAY_PL_CL_ACC) - MIN(MS_LST_PAY_PL_CL_ACC) AS DIF_MS_LST_PAY_PL_CL_ACC,
SUM(MS_LST_PAY_PL_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_PL_CL_ACC),0) AS AVG_MS_LST_PAY_PL_CL_ACC,

COUNT(MS_LST_PAY_PL_OP_ACC) AS NUM_MS_LST_PAY_PL_OP_ACC,
MAX(MS_LST_PAY_PL_OP_ACC)   AS MAX_MS_LST_PAY_PL_OP_ACC,
SUM(MS_LST_PAY_PL_OP_ACC)   AS SUM_MS_LST_PAY_PL_OP_ACC,
MIN(MS_LST_PAY_PL_OP_ACC)   AS MIN_MS_LST_PAY_PL_OP_ACC,
MAX(MS_LST_PAY_PL_OP_ACC) - MIN(MS_LST_PAY_PL_OP_ACC) AS DIF_MS_LST_PAY_PL_OP_ACC,
SUM(MS_LST_PAY_PL_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_PL_OP_ACC),0) AS AVG_MS_LST_PAY_PL_OP_ACC,

COUNT(MS_LST_PAY_PL) AS NUM_MS_LST_PAY_PL,
MAX(MS_LST_PAY_PL)   AS MAX_MS_LST_PAY_PL,
SUM(MS_LST_PAY_PL)   AS SUM_MS_LST_PAY_PL,
MIN(MS_LST_PAY_PL)   AS MIN_MS_LST_PAY_PL,
MAX(MS_LST_PAY_PL) - MIN(MS_LST_PAY_PL) AS DIF_MS_LST_PAY_PL,
SUM(MS_LST_PAY_PL)/NULLIF(COUNT(MS_LST_PAY_PL),0) AS AVG_MS_LST_PAY_PL,

COUNT(MS_LST_PAY_R_CL_ACC) AS NUM_MS_LST_PAY_R_CL_ACC,
MAX(MS_LST_PAY_R_CL_ACC)   AS MAX_MS_LST_PAY_R_CL_ACC,
SUM(MS_LST_PAY_R_CL_ACC)   AS SUM_MS_LST_PAY_R_CL_ACC,
MIN(MS_LST_PAY_R_CL_ACC)   AS MIN_MS_LST_PAY_R_CL_ACC,
MAX(MS_LST_PAY_R_CL_ACC) - MIN(MS_LST_PAY_R_CL_ACC) AS DIF_MS_LST_PAY_R_CL_ACC,
SUM(MS_LST_PAY_R_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_R_CL_ACC),0) AS AVG_MS_LST_PAY_R_CL_ACC,

COUNT(MS_LST_PAY_R_OP_ACC) AS NUM_MS_LST_PAY_R_OP_ACC,
MAX(MS_LST_PAY_R_OP_ACC)   AS MAX_MS_LST_PAY_R_OP_ACC,
SUM(MS_LST_PAY_R_OP_ACC)   AS SUM_MS_LST_PAY_R_OP_ACC,
MIN(MS_LST_PAY_R_OP_ACC)   AS MIN_MS_LST_PAY_R_OP_ACC,
MAX(MS_LST_PAY_R_OP_ACC) - MIN(MS_LST_PAY_R_OP_ACC) AS DIF_MS_LST_PAY_R_OP_ACC,
SUM(MS_LST_PAY_R_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_R_OP_ACC),0) AS AVG_MS_LST_PAY_R_OP_ACC,

COUNT(MS_LST_PAY_R) AS NUM_MS_LST_PAY_R,
MAX(MS_LST_PAY_R)   AS MAX_MS_LST_PAY_R,
SUM(MS_LST_PAY_R)   AS SUM_MS_LST_PAY_R,
MIN(MS_LST_PAY_R)   AS MIN_MS_LST_PAY_R,
MAX(MS_LST_PAY_R) - MIN(MS_LST_PAY_R) AS DIF_MS_LST_PAY_R,
SUM(MS_LST_PAY_R)/NULLIF(COUNT(MS_LST_PAY_R),0) AS AVG_MS_LST_PAY_R,

COUNT(MS_LST_PAY_CL_ACC) AS NUM_MS_LST_PAY_CL_ACC,
MAX(MS_LST_PAY_CL_ACC)   AS MAX_MS_LST_PAY_CL_ACC,
SUM(MS_LST_PAY_CL_ACC)   AS SUM_MS_LST_PAY_CL_ACC,
MIN(MS_LST_PAY_CL_ACC)   AS MIN_MS_LST_PAY_CL_ACC,
MAX(MS_LST_PAY_CL_ACC) - MIN(MS_LST_PAY_CL_ACC) AS DIF_MS_LST_PAY_CL_ACC,
SUM(MS_LST_PAY_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_CL_ACC),0) AS AVG_MS_LST_PAY_CL_ACC,

COUNT(MS_LST_PAY_OP_ACC) AS NUM_MS_LST_PAY_OP_ACC,
MAX(MS_LST_PAY_OP_ACC)   AS MAX_MS_LST_PAY_OP_ACC,
SUM(MS_LST_PAY_OP_ACC)   AS SUM_MS_LST_PAY_OP_ACC,
MIN(MS_LST_PAY_OP_ACC)   AS MIN_MS_LST_PAY_OP_ACC,
MAX(MS_LST_PAY_OP_ACC) - MIN(MS_LST_PAY_OP_ACC) AS DIF_MS_LST_PAY_OP_ACC,
SUM(MS_LST_PAY_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_OP_ACC),0) AS AVG_MS_LST_PAY_OP_ACC,

COUNT(MS_LST_PAY) AS NUM_MS_LST_PAY,
MAX(MS_LST_PAY)   AS MAX_MS_LST_PAY,
SUM(MS_LST_PAY)   AS SUM_MS_LST_PAY,
MIN(MS_LST_PAY)   AS MIN_MS_LST_PAY,
MAX(MS_LST_PAY) - MIN(MS_LST_PAY) AS DIF_MS_LST_PAY,
SUM(MS_LST_PAY)/NULLIF(COUNT(MS_LST_PAY),0) AS AVG_MS_LST_PAY,

COUNT(MS_LST_PAY_TU_ALL) AS NUM_MS_LST_PAY_TU_ALL,
MAX(MS_LST_PAY_TU_ALL)   AS MAX_MS_LST_PAY_TU_ALL,
SUM(MS_LST_PAY_TU_ALL)   AS SUM_MS_LST_PAY_TU_ALL,
MIN(MS_LST_PAY_TU_ALL)   AS MIN_MS_LST_PAY_TU_ALL,
MAX(MS_LST_PAY_TU_ALL) - MIN(MS_LST_PAY_TU_ALL) AS DIF_MS_LST_PAY_TU_ALL,
SUM(MS_LST_PAY_TU_ALL)/NULLIF(COUNT(MS_LST_PAY_TU_ALL),0) AS AVG_MS_LST_PAY_TU_ALL,

COUNT(MS_LST_PAY_TU) AS NUM_MS_LST_PAY_TU,
MAX(MS_LST_PAY_TU)   AS MAX_MS_LST_PAY_TU,
SUM(MS_LST_PAY_TU)   AS SUM_MS_LST_PAY_TU,
MIN(MS_LST_PAY_TU)   AS MIN_MS_LST_PAY_TU,
MAX(MS_LST_PAY_TU) - MIN(MS_LST_PAY_TU) AS DIF_MS_LST_PAY_TU,
SUM(MS_LST_PAY_TU)/NULLIF(COUNT(MS_LST_PAY_TU),0) AS AVG_MS_LST_PAY_TU,

COUNT(MS_LST_PAY_TU_ALL_OP_ACC) AS NUM_MS_LST_PAY_TU_ALL_OP_ACC,
MAX(MS_LST_PAY_TU_ALL_OP_ACC)   AS MAX_MS_LST_PAY_TU_ALL_OP_ACC,
SUM(MS_LST_PAY_TU_ALL_OP_ACC)   AS SUM_MS_LST_PAY_TU_ALL_OP_ACC,
MIN(MS_LST_PAY_TU_ALL_OP_ACC)   AS MIN_MS_LST_PAY_TU_ALL_OP_ACC,
MAX(MS_LST_PAY_TU_ALL_OP_ACC) - MIN(MS_LST_PAY_TU_ALL_OP_ACC) AS DIF_MS_LST_PAY_TU_ALL_OP_ACC,
SUM(MS_LST_PAY_TU_ALL_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_TU_ALL_OP_ACC),0) AS AVG_MS_LST_PAY_TU_ALL_OP_ACC,

COUNT(MS_LST_PAY_TU_OP_ACC) AS NUM_MS_LST_PAY_TU_OP_ACC,
MAX(MS_LST_PAY_TU_OP_ACC)   AS MAX_MS_LST_PAY_TU_OP_ACC,
SUM(MS_LST_PAY_TU_OP_ACC)   AS SUM_MS_LST_PAY_TU_OP_ACC,
MIN(MS_LST_PAY_TU_OP_ACC)   AS MIN_MS_LST_PAY_TU_OP_ACC,
MAX(MS_LST_PAY_TU_OP_ACC) - MIN(MS_LST_PAY_TU_OP_ACC) AS DIF_MS_LST_PAY_TU_OP_ACC,
SUM(MS_LST_PAY_TU_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_TU_OP_ACC),0) AS AVG_MS_LST_PAY_TU_OP_ACC,

COUNT(MS_LST_PAY_TU_ALL_CL_ACC) AS NUM_MS_LST_PAY_TU_ALL_CL_ACC,
MAX(MS_LST_PAY_TU_ALL_CL_ACC)   AS MAX_MS_LST_PAY_TU_ALL_CL_ACC,
SUM(MS_LST_PAY_TU_ALL_CL_ACC)   AS SUM_MS_LST_PAY_TU_ALL_CL_ACC,
MIN(MS_LST_PAY_TU_ALL_CL_ACC)   AS MIN_MS_LST_PAY_TU_ALL_CL_ACC,
MAX(MS_LST_PAY_TU_ALL_CL_ACC) - MIN(MS_LST_PAY_TU_ALL_CL_ACC) AS DIF_MS_LST_PAY_TU_ALL_CL_ACC,
SUM(MS_LST_PAY_TU_ALL_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_TU_ALL_CL_ACC),0) AS AVG_MS_LST_PAY_TU_ALL_CL_ACC,

COUNT(MS_LST_PAY_TU_CL_ACC) AS NUM_MS_LST_PAY_TU_CL_ACC,
MAX(MS_LST_PAY_TU_CL_ACC)   AS MAX_MS_LST_PAY_TU_CL_ACC,
SUM(MS_LST_PAY_TU_CL_ACC)   AS SUM_MS_LST_PAY_TU_CL_ACC,
MIN(MS_LST_PAY_TU_CL_ACC)   AS MIN_MS_LST_PAY_TU_CL_ACC,
MAX(MS_LST_PAY_TU_CL_ACC) - MIN(MS_LST_PAY_TU_CL_ACC) AS DIF_MS_LST_PAY_TU_CL_ACC,
SUM(MS_LST_PAY_TU_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_TU_CL_ACC),0) AS AVG_MS_LST_PAY_TU_CL_ACC,

COUNT(MS_LST_PAY_NBK_TU) AS NUM_MS_LST_PAY_NBK_TU,
MAX(MS_LST_PAY_NBK_TU)   AS MAX_MS_LST_PAY_NBK_TU,
SUM(MS_LST_PAY_NBK_TU)   AS SUM_MS_LST_PAY_NBK_TU,
MIN(MS_LST_PAY_NBK_TU)   AS MIN_MS_LST_PAY_NBK_TU,
MAX(MS_LST_PAY_NBK_TU) - MIN(MS_LST_PAY_NBK_TU) AS DIF_MS_LST_PAY_NBK_TU,
SUM(MS_LST_PAY_NBK_TU)/NULLIF(COUNT(MS_LST_PAY_NBK_TU),0) AS AVG_MS_LST_PAY_NBK_TU,

COUNT(MS_LST_PAY_NBK_TU_OP_ACC) AS NUM_MS_LST_PAY_NBK_TU_OP_ACC,
MAX(MS_LST_PAY_NBK_TU_OP_ACC)   AS MAX_MS_LST_PAY_NBK_TU_OP_ACC,
SUM(MS_LST_PAY_NBK_TU_OP_ACC)   AS SUM_MS_LST_PAY_NBK_TU_OP_ACC,
MIN(MS_LST_PAY_NBK_TU_OP_ACC)   AS MIN_MS_LST_PAY_NBK_TU_OP_ACC,
MAX(MS_LST_PAY_NBK_TU_OP_ACC) - MIN(MS_LST_PAY_NBK_TU_OP_ACC) AS DIF_MS_LST_PAY_NBK_TU_OP_ACC,
SUM(MS_LST_PAY_NBK_TU_OP_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_TU_OP_ACC),0) AS AVG_MS_LST_PAY_NBK_TU_OP_ACC,

COUNT(MS_LST_PAY_NBK_TU_CL_ACC) AS NUM_MS_LST_PAY_NBK_TU_CL_ACC,
MAX(MS_LST_PAY_NBK_TU_CL_ACC)   AS MAX_MS_LST_PAY_NBK_TU_CL_ACC,
SUM(MS_LST_PAY_NBK_TU_CL_ACC)   AS SUM_MS_LST_PAY_NBK_TU_CL_ACC,
MIN(MS_LST_PAY_NBK_TU_CL_ACC)   AS MIN_MS_LST_PAY_NBK_TU_CL_ACC,
MAX(MS_LST_PAY_NBK_TU_CL_ACC) - MIN(MS_LST_PAY_NBK_TU_CL_ACC) AS DIF_MS_LST_PAY_NBK_TU_CL_ACC,
SUM(MS_LST_PAY_NBK_TU_CL_ACC)/NULLIF(COUNT(MS_LST_PAY_NBK_TU_CL_ACC),0) AS AVG_MS_LST_PAY_NBK_TU_CL_ACC

FROM dbmymwork.BTDC_LGG_VAR_SEGMENTADAS_1
GROUP BY CUENTADEREFERENCIA,
FECHA_CARTERA
;

SELECT * FROM dbmymwork.BTDC_LGG_VAR_MS_LST_PAY LIMIT 100;