DROP TABLE IF EXISTS 
    DBMYMWORK.JEA_MCV_VARIABLES_201806_201810;

CREATE TABLE IF NOT EXISTS
    DBMYMWORK.JEA_MCV_VARIABLES_201806_201810 AS
SELECT	
	A.RFC,
	B.LLAVE_UNIVERSAL_20,
	A.FECHACARTERA AS FECHA,
	A.MONTHS_ON_FILE_BANKING,
	A.DS_OL_CL,
	A.MIN_R_BAL_BY_CRED_LIM_12M,
	A.SUM_AMORTIZACIONEXIGIBLE,
	A.AVG_MS_CL_CL_ACC,
	A.MIN_R_BAL_BY_MAX_BAL_12M,
	A.MIN_R_BAL_BY_MAX_BAL_06M,
	A.DS_CL,
	A.AVG_MS_OP_OP_ACC,
	A.SUM_PAGOREALIZADO_MES,
	A.MAX_MS_OP_OP_ACC,
	A.AVG1_VP_MES,
	A.AVG_SALINI_CL_ACC,
	A.MAX_R_BAL_BY_CRED_LIM_12M,
	A.R_BAL_BY_CRED_LIM,
	A.MIN_MS_OP_BRG_OP_ACC,
	A.MIN_SALINI_CL_ACC,
	A.MAX_SALINI_CL_ACC,
	A.BK_DEUDA_CP,
	A.MS_OP,
	A.MIN_MS_OP_OP_ACC,
	A.MIN_R_BAL_BY_CRED_LIM_06M,
	A.MAX_AVG1_VP_MES_U06M,
	A.AVG_PND_MENOS_R_BAL_BY_CRED_LIM_12M,
	A.DIAS_ATRASO,
	A.PCT_CL_ACC,
	A.AVG_AVG1_VP_MES_U03M,
	A.MIN_R_BAL_BY_MAX_BAL_03M,
	A.AVG_AVG1_VP_PER_U12M,
	A.MAX_AVG1_VP_MES_U03M,
	A.MAX_R_BAL_BY_CRED_LIM_06M,
	A.SUM_PAGOREALIZADO_PERIODO,
	A.MIN_MS_CL_CL_ACC,
	A.DEUDA_TOT_CP,
	A.D_CRED_LIM_TO_BAL,
	A.MAX_MS_CL_CL_ACC,
	A.PCT_BRG_R_OP_ACC,
	A.AVG_PND_MENOS_D_CRED_LIM_TO_BAL_12M,
	A.AVG_AVG1_VP_MES_U06M,
	A.PCT_BK_R_OP_ACC,
	A.BK12_NUM_EXP_PAIDONTIME,
	A.MIN_SALINI_OP_ACC,
	A.PCT_BRG_OP_ACC,
	A.MIN_D_CRED_LIM_TO_BAL_12M,
	A.DPCV_CAP,
	A.MAX_AVG1_VP_MES_U12M,
	A.MIN_BAL_12M,
	A.AVG_MAX_DIAS_PARA_PAGO_U03M,
	A.AVG_AVG1_VP_MES_U12M,
	A.AVG_MAX_DIAS_PARA_PAGO_U12M,
	A.AVG_MS_OP_BRG_OP_ACC,
	A.MIN_MS_OP_BRG_R_OP_ACC,
	A.AVG_D_CRED_LIM_TO_BAL_12M,
	A.MIN_SALINI_OP_ACC_03M,
	A.AVG_R_BAL_BY_CRED_LIM_12M,
	A.MIN_VIGENTEH_12M,
	A.MAX_R_BAL_BY_CRED_LIM_03M,
	A.MIN_R_BAL_BY_CRED_LIM_03M,
	A.AVG_MAX_DIAS_PARA_PAGO_U06M,
	A.AVG_VIGENTEC_OP_ACC,
	A.DPCV_INT,
	A.AVG_PND_MENOS_R_BAL_BY_CRED_LIM_06M,
	A.PCT_BK_OP_ACC,
	A.MIN_D_CRED_LIM_TO_BAL_03M,
	A.MAX_AVG1_VP_PER_U06M,
	A.MAX_D_CRED_LIM_TO_BAL_03M,
	A.MIN_AVG1_VP_MES_U03M,
	A.PCT_BK_CL_ACC,
	A.PCT_BK_R_CL_ACC,
	A.MAX_AVG1_VP_PER_U12M,
	A.SUM_AMORTIZACIONNOEXIGIBLE,
	A.CUR_BAL,
	A.PCT_BK_CS_OP_ACC,
	A.AVG_AVG1_VP_PER_U03M,
	A.MAX_DIAS_PARA_PAGO,
	A.MAX_AVG1_VP_PER_U03M,
	A.MIN_D_CRED_LIM_TO_BAL_06M,
	A.AVG_AVG1_VP_PER_U06M,
	A.MIN_VIGENTEH_03M,
	A.MAX_MS_OP_BRG_R_OP_ACC,
	A.SUM_VIGENTEH_12M,
	A.AVG_PND_MENOS_PCT_VENC29_12M,
	A.DEUDA_TOT,
	A.AVG_PND_MAS_R_BAL_BY_CRED_LIM_12M,
	A.AVG_SALINI_OP_ACC_03M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_L_12M,
	A.MAX_MS_OP_BRG_OP_ACC,
	A.AVG_MS_OP_BRG_R_OP_ACC,
	A.BK_DEUDA_TOT,
	A.AVG_PND_MENOS_D_CRED_LIM_TO_BAL_06M,
	A.PCT_BK_CS_CL_ACC,
	A.AVG1_VP_PER,
	A.AVG_VIGENTEC_OP_ACC_12M,
	A.BK12_MAX_CREDIT_AMT,
	A.PCT_OTHER_FIN_OP_ACC,
	A.AVG_SALINI_OP_ACC,
	A.AVG_PND_MENOS_R_BAL_BY_CRED_LIM_03M,
	A.PCT_BRG_CL_ACC,
	A.AVG_PND_MENOS_BAL_12M,
	A.MIN_VIGENTEH_06M,
	A.AVG_PND_MAS_R_BAL_BY_CRED_LIM_03M,
	A.MAX_BAL_12M,
	A.PCT_BRG_R_CL_ACC,
	A.AVG_PND_MAS_D_CRED_LIM_TO_BAL_12M,
	A.PCT_OTHER_FIN_CL_ACC,
	A.AVG_VIGENTEC_OP_ACC_03M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_L_12M,
	A.NBK_DEUDA_TOT,
	A.AVG_PND_MENOS_PCT_VENC29_03M,
	A.BK12_DPD_PROM,
	A.BK_IND_PMOR,
	A.AVG_PND_MAS_AVG_HI_CALCAR_L_03M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_CEIL_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_FLOOR_12M,
	A.MIN_SALINI_BRG_OP_ACC_03M,
	A.MAX_BAL_06M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_CEIL_12M,
	A.MIN_CRED_LIM_12M,
	A.AVG_R_BAL_BY_CRED_LIM_06M,
	A.SUM_VIGENTEH_03M,
	A.MIN_AVG1_VP_MES_U12M,
	A.MAX_VIGENTEC_OP_ACC,
	A.MAX_VIGENTEC_BRG_OP_ACC,
	A.SUM_VIGENTEH_06M,
	A.MIN_SALINI_BRG_R_OP_ACC_03M,
	A.AVG_PND_MENOS_PCT_VENC29_06M,
	A.12_INST,
	A.PCT_OTHER_FIN_LSG_OP_ACC,
	A.AVG_R_BAL_BY_CRED_LIM_03M,
	A.AVG_VIGENTEC_BRG_OP_ACC,
	A.MAX_AVG1_VP_PER_U12M_2,
	A.AVG_AVG1_VP_MES_U06M_2,
	A.AVG_SALINI_BRG_R_OP_ACC_03M,
	A.MIN_BAL_06M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_L_06M,
	A.MIN_SALINI_BRG_OP_ACC,
	A.MAX_AVG1_VP_MES_U03M_2,
	A.AVG_PND_MENOS_PCT_VENC59_12M,
	A.MAX_AVG1_VP_MES_U06M_2,
	A.AVG_PND_MAS_MAX_HI_CALCAR_L_03M,
	A.AVG_AVG1_VP_MES_U12M_2,
	A.MIN_AVG1_VP_PER_U03M,
	A.AVG_VIGENTEC_BRG_R_OP_ACC,
	A.AVG_PND_MAS_D_CRED_LIM_TO_BAL_06M,
	A.AVG_PND_MAS_D_CRED_LIM_TO_BAL_03M,
	A.AVG_SALINI_BRG_R_OP_ACC,
	A.PCT_BRG_CS_OP_ACC,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_FLOOR_12M,
	A.MIN_BAL_03M,
	A.AVG_PND_MAS_R_BAL_BY_MAX_BAL_12M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_L_03M,
	A.NUM_VIGENTEH_12M,
	A.MIN_SALINI_BRG_R_OP_ACC,
	A.AVG_PND_MENOS_VENC29_12M,
	A.AVG_PCT_VENC29_06M,
	A.AVG_PND_MAS_PCT_VENC29_03M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_CEIL_06M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_L_06M,
	A.MAX_AVG1_VP_MES_U12M_2,
	A.AVG_PND_MENOS_D_CRED_LIM_TO_BAL_03M,
	A.AVG_FD_CALCAR_CEIL,
	A.AVG_PND_MAS_R_BAL_BY_CRED_LIM_06M,
	A.AVG_AVG1_VP_MES_U03M_2,
	A.AVG_VIGENTEC_OP_ACC_06M,
	A.AVG_PND_MAS_MAX_HI_CALCAR_FLOOR_06M,
	A.MAX_SALINI_OP_ACC,
	A.AVG_AVG1_VP_PER_U12M_2,
	A.AVG_PCT_VIGENTEC_OP_ACC,
	A.PCT_LSE_OP_ACC,
	A.NUM_MAX_HI_CALCAR_FLOOR_12M,
	A.PCT_BRG_CS_CL_ACC,
	A.MAX_VIGENTEC_BRG_R_OP_ACC,
	A.AVG_VENC29_BRG_OP_ACC_03M,
	A.AVG_PND_MAS_AVG_HI_CALCAR_L_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_FLOOR_03M,
	A.MAX_VENC29_03M,
	A.PCT_GBN_CF_CL_ACC,
	A.AVG_PND_MAS_MAX_HI_CALCAR_L_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_CEIL_06M,
	A.MAX_MAX_DIAS_PARA_PAGO_U03M,
	A.AVG_PND_MAS_MAX_HI_CALCAR_FLOOR_03M,
	A.AVG_PND_MAS_MAX_HI_CALCAR_FLOOR_12M,
	A.MAX_CRED_LIM_12M,
	A.AVG_PND_MAS_AVG_HI_CALCAR_CEIL_03M,
	A.AVG_PCT_VENC29_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_CEIL_03M,
	A.AVG_MIN_VP_MES_U12M,
	A.AVG_VIGENTEC_BRG_R_OP_ACC_03M,
	A.AVG_PND_MENOS_R_BAL_BY_MAX_BAL_12M,
	A.AVG_PND_MENOS_PCT_VENC1M_12M,
	A.AVG_PCT_VENC1M_BRG_OP_ACC,
	A.PCT_LSE_LSG_OP_ACC,
	A.AVG_PND_MAS_AVG_HI_CALCAR_CEIL_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_FLOOR_06M,
	A.MIN_SALINI_OP_ACC_06M,
	A.AVG_VENC1M_OP_ACC,
	A.MAX_BAL_03M,
	A.MAX_VIGENTEC_BRG_OP_ACC_03M,
	A.AVG_PND_MAS_AVG_HI_CALCAR_L_06M,
	A.MIN_AVG1_VP_MES_U06M
FROM LGG_MCV_VARIABLES_201806_201810 A
LEFT JOIN JEA_MCV_PREUNIVERSO B
ON A.LINEA = B.LINEA AND A.FECHACARTERA = B.FECHA;


-- Add Indexes
CREATE INDEX UNIVERSO_WDW_RFC_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201806_201810 (RFC);

CREATE INDEX UNIVERSO_WDW_FECHA_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201806_201810 (FECHA);

CREATE INDEX UNIVERSO_WDW_LLAVE_UNIVERSAL_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201806_201810 (LLAVE_UNIVERSAL_20);

CREATE UNIQUE INDEX UNIVERSO_WDW_LLAVE_UNIVERSAL_FECHA_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201806_201810 (LLAVE_UNIVERSAL_20, FECHA);


ALTER TABLE DBMYMWORK.JEA_MCV_VARIABLES_201806_201810
ADD LABEL INTEGER AFTER FECHA;

ALTER TABLE DBMYMWORK.JEA_MCV_VARIABLES_201806_201810
ADD BMI INTEGER AFTER LABEL;

UPDATE DBMYMWORK.JEA_MCV_VARIABLES_201806_201810 A
LEFT JOIN  DBMYMWORK.JEA_MCV_UNIVERSO_TMP B  
  ON A.LLAVE_UNIVERSAL_20 = B.LLAVE_UNIVERSAL_20 AND A.FECHA = B.FECHA
SET 
	A.LABEL = B.LABEL, 
	A.BMI = CASE WHEN A.LABEL=7 THEN 0 ELSE 1 END;  


----

DROP TABLE IF EXISTS 
    DBMYMWORK.JEA_MCV_VARIABLES_201811_201812;

CREATE TABLE IF NOT EXISTS
    DBMYMWORK.JEA_MCV_VARIABLES_201811_201812 AS
SELECT 
	A.*,
	B.FECHA,
	B.LABEL,
	CASE WHEN B.LABEL = 7 THEN 0 ELSE 1 END AS BMI
FROM LGG_MCV_PQ_VARIABLES_201811_201812 A
LEFT JOIN JEA_MCV_UNIVERSO_TMP B
ON A.FECHACARTERA = B.FECHA AND A.LLAVE_UNIVERSAL_20 = B.LLAVE_UNIVERSAL_20;

CREATE INDEX UNIVERSO_WDW_RFC_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201811_201812 (RFC);

CREATE INDEX UNIVERSO_WDW_FECHA_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201811_201812 (FECHA);

CREATE INDEX UNIVERSO_WDW_LLAVE_UNIVERSAL_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201811_201812 (LLAVE_UNIVERSAL_20);

CREATE UNIQUE INDEX UNIVERSO_WDW_LLAVE_UNIVERSAL_FECHA_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201811_201812 (LLAVE_UNIVERSAL_20, FECHA);

---------------------
DROP TABLE IF EXISTS 
    DBMYMWORK.JEA_MCV_VARIABLES_201902;

CREATE TABLE IF NOT EXISTS
    DBMYMWORK.JEA_MCV_VARIABLES_201902 AS
SELECT DISTINCT
	B.RFC,
	B.LLAVE_UNIVERSAL_20,
	B.FECHA,
	B.LABEL,
	CASE WHEN B.LABEL = 7 THEN 0 ELSE 1 END AS BMI,	
	A.MONTHS_ON_FILE_BANKING,
	A.DS_OL_CL,
	A.MIN_R_BAL_BY_CRED_LIM_12M,
	A.SUM_AMORTIZACIONEXIGIBLE,
	A.AVG_MS_CL_CL_ACC,
	A.MIN_R_BAL_BY_MAX_BAL_12M,
	A.MIN_R_BAL_BY_MAX_BAL_06M,
	A.DS_CL,
	A.AVG_MS_OP_OP_ACC,
	A.SUM_PAGOREALIZADO_MES,
	A.MAX_MS_OP_OP_ACC,
	A.AVG1_VP_MES,
	A.AVG_SALINI_CL_ACC,
	A.MAX_R_BAL_BY_CRED_LIM_12M,
	A.R_BAL_BY_CRED_LIM,
	A.MIN_MS_OP_BRG_OP_ACC,
	A.MIN_SALINI_CL_ACC,
	A.MAX_SALINI_CL_ACC,
	A.BK_DEUDA_CP,
	A.MS_OP,
	A.MIN_MS_OP_OP_ACC,
	A.MIN_R_BAL_BY_CRED_LIM_06M,
	A.MAX_AVG1_VP_MES_U06M,
	A.AVG_PND_MENOS_R_BAL_BY_CRED_LIM_12M,
	A.DIAS_ATRASO,
	A.PCT_CL_ACC,
	A.AVG_AVG1_VP_MES_U03M,
	A.MIN_R_BAL_BY_MAX_BAL_03M,
	A.AVG_AVG1_VP_PER_U12M,
	A.MAX_AVG1_VP_MES_U03M,
	A.MAX_R_BAL_BY_CRED_LIM_06M,
	A.SUM_PAGOREALIZADO_PERIODO,
	A.MIN_MS_CL_CL_ACC,
	A.DEUDA_TOT_CP,
	A.D_CRED_LIM_TO_BAL,
	A.MAX_MS_CL_CL_ACC,
	A.PCT_BRG_R_OP_ACC,
	A.AVG_PND_MENOS_D_CRED_LIM_TO_BAL_12M,
	A.AVG_AVG1_VP_MES_U06M,
	A.PCT_BK_R_OP_ACC,
	A.BK12_NUM_EXP_PAIDONTIME,
	A.MIN_SALINI_OP_ACC,
	A.PCT_BRG_OP_ACC,
	A.MIN_D_CRED_LIM_TO_BAL_12M,
	A.DPCV_CAP,
	A.MAX_AVG1_VP_MES_U12M,
	A.MIN_BAL_12M,
	A.AVG_MAX_DIAS_PARA_PAGO_U03M,
	A.AVG_AVG1_VP_MES_U12M,
	A.AVG_MAX_DIAS_PARA_PAGO_U12M,
	A.AVG_MS_OP_BRG_OP_ACC,
	A.MIN_MS_OP_BRG_R_OP_ACC,
	A.AVG_D_CRED_LIM_TO_BAL_12M,
	A.MIN_SALINI_OP_ACC_03M,
	A.AVG_R_BAL_BY_CRED_LIM_12M,
	A.MIN_VIGENTEH_12M,
	A.MAX_R_BAL_BY_CRED_LIM_03M,
	A.MIN_R_BAL_BY_CRED_LIM_03M,
	A.AVG_MAX_DIAS_PARA_PAGO_U06M,
	A.AVG_VIGENTEC_OP_ACC,
	A.DPCV_INT,
	A.AVG_PND_MENOS_R_BAL_BY_CRED_LIM_06M,
	A.PCT_BK_OP_ACC,
	A.MIN_D_CRED_LIM_TO_BAL_03M,
	A.MAX_AVG1_VP_PER_U06M,
	A.MAX_D_CRED_LIM_TO_BAL_03M,
	A.MIN_AVG1_VP_MES_U03M,
	A.PCT_BK_CL_ACC,
	A.PCT_BK_R_CL_ACC,
	A.MAX_AVG1_VP_PER_U12M,
	A.SUM_AMORTIZACIONNOEXIGIBLE,
	A.CUR_BAL,
	A.PCT_BK_CS_OP_ACC,
	A.AVG_AVG1_VP_PER_U03M,
	A.MAX_DIAS_PARA_PAGO,
	A.MAX_AVG1_VP_PER_U03M,
	A.MIN_D_CRED_LIM_TO_BAL_06M,
	A.AVG_AVG1_VP_PER_U06M,
	A.MIN_VIGENTEH_03M,
	A.MAX_MS_OP_BRG_R_OP_ACC,
	A.SUM_VIGENTEH_12M,
	A.AVG_PND_MENOS_PCT_VENC29_12M,
	A.DEUDA_TOT,
	A.AVG_PND_MAS_R_BAL_BY_CRED_LIM_12M,
	A.AVG_SALINI_OP_ACC_03M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_L_12M,
	A.MAX_MS_OP_BRG_OP_ACC,
	A.AVG_MS_OP_BRG_R_OP_ACC,
	A.BK_DEUDA_TOT,
	A.AVG_PND_MENOS_D_CRED_LIM_TO_BAL_06M,
	A.PCT_BK_CS_CL_ACC,
	A.AVG1_VP_PER,
	A.AVG_VIGENTEC_OP_ACC_12M,
	A.BK12_MAX_CREDIT_AMT,
	A.PCT_OTHER_FIN_OP_ACC,
	A.AVG_SALINI_OP_ACC,
	A.AVG_PND_MENOS_R_BAL_BY_CRED_LIM_03M,
	A.PCT_BRG_CL_ACC,
	A.AVG_PND_MENOS_BAL_12M,
	A.MIN_VIGENTEH_06M,
	A.AVG_PND_MAS_R_BAL_BY_CRED_LIM_03M,
	A.MAX_BAL_12M,
	A.PCT_BRG_R_CL_ACC,
	A.AVG_PND_MAS_D_CRED_LIM_TO_BAL_12M,
	A.PCT_OTHER_FIN_CL_ACC,
	A.AVG_VIGENTEC_OP_ACC_03M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_L_12M,
	A.NBK_DEUDA_TOT,
	A.AVG_PND_MENOS_PCT_VENC29_03M,
	A.BK12_DPD_PROM,
	A.BK_IND_PMOR,
	A.AVG_PND_MAS_AVG_HI_CALCAR_L_03M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_CEIL_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_FLOOR_12M,
	A.MIN_SALINI_BRG_OP_ACC_03M,
	A.MAX_BAL_06M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_CEIL_12M,
	A.MIN_CRED_LIM_12M,
	A.AVG_R_BAL_BY_CRED_LIM_06M,
	A.SUM_VIGENTEH_03M,
	A.MIN_AVG1_VP_MES_U12M,
	A.MAX_VIGENTEC_OP_ACC,
	A.MAX_VIGENTEC_BRG_OP_ACC,
	A.SUM_VIGENTEH_06M,
	A.MIN_SALINI_BRG_R_OP_ACC_03M,
	A.AVG_PND_MENOS_PCT_VENC29_06M,
	A.12_INST,
	A.PCT_OTHER_FIN_LSG_OP_ACC,
	A.AVG_R_BAL_BY_CRED_LIM_03M,
	A.AVG_VIGENTEC_BRG_OP_ACC,
	A.MAX_AVG1_VP_PER_U12M_2,
	A.AVG_AVG1_VP_MES_U06M_2,
	A.AVG_SALINI_BRG_R_OP_ACC_03M,
	A.MIN_BAL_06M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_L_06M,
	A.MIN_SALINI_BRG_OP_ACC,
	A.MAX_AVG1_VP_MES_U03M_2,
	A.AVG_PND_MENOS_PCT_VENC59_12M,
	A.MAX_AVG1_VP_MES_U06M_2,
	A.AVG_PND_MAS_MAX_HI_CALCAR_L_03M,
	A.AVG_AVG1_VP_MES_U12M_2,
	A.MIN_AVG1_VP_PER_U03M,
	A.AVG_VIGENTEC_BRG_R_OP_ACC,
	A.AVG_PND_MAS_D_CRED_LIM_TO_BAL_06M,
	A.AVG_PND_MAS_D_CRED_LIM_TO_BAL_03M,
	A.AVG_SALINI_BRG_R_OP_ACC,
	A.PCT_BRG_CS_OP_ACC,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_FLOOR_12M,
	A.MIN_BAL_03M,
	A.AVG_PND_MAS_R_BAL_BY_MAX_BAL_12M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_L_03M,
	A.NUM_VIGENTEH_12M,
	A.MIN_SALINI_BRG_R_OP_ACC,
	A.AVG_PND_MENOS_VENC29_12M,
	A.AVG_PCT_VENC29_06M,
	A.AVG_PND_MAS_PCT_VENC29_03M,
	A.AVG_PND_MENOS_AVG_HI_CALCAR_CEIL_06M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_L_06M,
	A.MAX_AVG1_VP_MES_U12M_2,
	A.AVG_PND_MENOS_D_CRED_LIM_TO_BAL_03M,
	A.AVG_FD_CALCAR_CEIL,
	A.AVG_PND_MAS_R_BAL_BY_CRED_LIM_06M,
	A.AVG_AVG1_VP_MES_U03M_2,
	A.AVG_VIGENTEC_OP_ACC_06M,
	A.AVG_PND_MAS_MAX_HI_CALCAR_FLOOR_06M,
	A.MAX_SALINI_OP_ACC,
	A.AVG_AVG1_VP_PER_U12M_2,
	A.AVG_PCT_VIGENTEC_OP_ACC,
	A.PCT_LSE_OP_ACC,
	A.NUM_MAX_HI_CALCAR_FLOOR_12M,
	A.PCT_BRG_CS_CL_ACC,
	A.MAX_VIGENTEC_BRG_R_OP_ACC,
	A.AVG_VENC29_BRG_OP_ACC_03M,
	A.AVG_PND_MAS_AVG_HI_CALCAR_L_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_FLOOR_03M,
	A.MAX_VENC29_03M,
	A.PCT_GBN_CF_CL_ACC,
	A.AVG_PND_MAS_MAX_HI_CALCAR_L_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_CEIL_06M,
	A.MAX_MAX_DIAS_PARA_PAGO_U03M,
	A.AVG_PND_MAS_MAX_HI_CALCAR_FLOOR_03M,
	A.AVG_PND_MAS_MAX_HI_CALCAR_FLOOR_12M,
	A.MAX_CRED_LIM_12M,
	A.AVG_PND_MAS_AVG_HI_CALCAR_CEIL_03M,
	A.AVG_PCT_VENC29_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_CEIL_03M,
	A.AVG_MIN_VP_MES_U12M,
	A.AVG_VIGENTEC_BRG_R_OP_ACC_03M,
	A.AVG_PND_MENOS_R_BAL_BY_MAX_BAL_12M,
	A.AVG_PND_MENOS_PCT_VENC1M_12M,
	A.AVG_PCT_VENC1M_BRG_OP_ACC,
	A.PCT_LSE_LSG_OP_ACC,
	A.AVG_PND_MAS_AVG_HI_CALCAR_CEIL_12M,
	A.AVG_PND_MENOS_MAX_HI_CALCAR_FLOOR_06M,
	A.MIN_SALINI_OP_ACC_06M,
	A.AVG_VENC1M_OP_ACC,
	A.MAX_BAL_03M,
	A.MAX_VIGENTEC_BRG_OP_ACC_03M,
	A.AVG_PND_MAS_AVG_HI_CALCAR_L_06M,
	A.MIN_AVG1_VP_MES_U06M	
FROM JEA_MCV_UNIVERSO B
LEFT JOIN  LGG_MCV_VAR_MODELO_201902 A
ON B.FECHA = A.FECHACARTERA  AND B.RFC = A.RFC
WHERE B.FECHA = '201902'
AND B.CCI + B.SOBREGIRO + B.INTERCOMPANIA + B.CARTERA_ADQUIRIDA + B.REESTRUCTURA = 0 
AND B.LABEL <> 0 
AND (SUBSTR(B.FECHA,1,4)-YEAR(B.FECHA_BC))*12 + SUBSTR(B.FECHA,5,2) - MONTH(B.FECHA_BC) BETWEEN 0 AND 4;

CREATE INDEX UNIVERSO_WDW_RFC_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201902 (RFC);

CREATE INDEX UNIVERSO_WDW_FECHA_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201902 (FECHA);

CREATE INDEX UNIVERSO_WDW_LLAVE_UNIVERSAL_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201902 (LLAVE_UNIVERSAL_20);

CREATE UNIQUE INDEX UNIVERSO_WDW_LLAVE_UNIVERSAL_FECHA_IDX
ON DBMYMWORK.JEA_MCV_VARIABLES_201902 (LLAVE_UNIVERSAL_20, FECHA);